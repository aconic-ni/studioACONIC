"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2754],{11186:(e,t,a)=>{a.d(t,{bq:()=>u,eb:()=>h,gC:()=>x,l6:()=>c,yv:()=>m});var r=a(95155),s=a(12115),n=a(47887),d=a(59007),l=a(42614),o=a(72251),i=a(64269);let c=n.bL;n.YJ;let m=n.WT,u=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(n.l9,{ref:t,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[s,(0,r.jsx)(n.In,{asChild:!0,children:(0,r.jsx)(d.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=n.l9.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.PP,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})});f.displayName=n.PP.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.wn,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(d.A,{className:"h-4 w-4"})})});p.displayName=n.wn.displayName;let x=s.forwardRef((e,t)=>{let{className:a,children:s,position:d="popper",...l}=e;return(0,r.jsx)(n.ZL,{children:(0,r.jsxs)(n.UC,{ref:t,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===d&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:d,...l,children:[(0,r.jsx)(f,{}),(0,r.jsx)(n.LM,{className:(0,i.cn)("p-1","popper"===d&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(p,{})]})})});x.displayName=n.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.JU,{ref:t,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=n.JU.displayName;let h=s.forwardRef((e,t)=>{let{className:a,children:s,...d}=e;return(0,r.jsxs)(n.q7,{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...d,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.VF,{children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})}),(0,r.jsx)(n.p4,{children:s})]})});h.displayName=n.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.wv,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=n.wv.displayName},27339:(e,t,a)=>{a.d(t,{l:()=>u});var r=a(95155),s=a(12115),n=a(5282),d=a(80160),l=a(28127),o=a(64269),i=a(3998),c=a(50276),m=a(26333);function u(e){let{className:t,date:a,onDateChange:u,disabled:f=!1}=e,[p,x]=s.useState(!1),[h,y]=s.useState(a);return s.useEffect(()=>{y(a)},[a]),(0,r.jsx)("div",{className:(0,o.cn)("grid gap-2",t),children:(0,r.jsxs)(m.AM,{open:p,onOpenChange:x,children:[(0,r.jsx)(m.Wv,{asChild:!0,children:(0,r.jsxs)(i.$,{variant:"outline",disabled:f,className:(0,o.cn)("w-[180px] justify-start text-left font-normal",!h&&"text-muted-foreground"),children:[(0,r.jsx)(l.A,{className:"mr-2 h-4 w-4"}),h?(0,n.GP)(h,"dd/MM/yy",{locale:d.es}):(0,r.jsx)("span",{children:"Seleccione fecha"})]})}),(0,r.jsx)(m.hl,{className:"w-auto p-0",children:(0,r.jsx)(c.V,{mode:"single",selected:null!=h?h:void 0,onSelect:e=>{y(e),u(e),x(!1)},initialFocus:!0,locale:d.es,disabled:f})})]})})}},31120:(e,t,a)=>{a.d(t,{T:()=>d});var r=a(95155),s=a(12115),n=a(64269);let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...s})});d.displayName="Textarea"},41052:(e,t,a)=>{a.d(t,{C5:()=>y,MJ:()=>h,eI:()=>p,lR:()=>x,lV:()=>i,zB:()=>m});var r=a(95155),s=a(12115),n=a(32467),d=a(22544),l=a(64269),o=a(76444);let i=d.Op,c=s.createContext({}),m=e=>{let{...t}=e;return(0,r.jsx)(c.Provider,{value:{name:t.name},children:(0,r.jsx)(d.xI,{...t})})},u=()=>{let e=s.useContext(c),t=s.useContext(f),{getFieldState:a,formState:r}=(0,d.xW)(),n=a(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=t;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...n}},f=s.createContext({}),p=s.forwardRef((e,t)=>{let{className:a,...n}=e,d=s.useId();return(0,r.jsx)(f.Provider,{value:{id:d},children:(0,r.jsx)("div",{ref:t,className:(0,l.cn)("space-y-2",a),...n})})});p.displayName="FormItem";let x=s.forwardRef((e,t)=>{let{className:a,...s}=e,{error:n,formItemId:d}=u();return(0,r.jsx)(o.J,{ref:t,className:(0,l.cn)(n&&"text-destructive",a),htmlFor:d,...s})});x.displayName="FormLabel";let h=s.forwardRef((e,t)=>{let{...a}=e,{error:s,formItemId:d,formDescriptionId:l,formMessageId:o}=u();return(0,r.jsx)(n.DX,{ref:t,id:d,"aria-describedby":s?"".concat(l," ").concat(o):"".concat(l),"aria-invalid":!!s,...a})});h.displayName="FormControl",s.forwardRef((e,t)=>{let{className:a,...s}=e,{formDescriptionId:n}=u();return(0,r.jsx)("p",{ref:t,id:n,className:(0,l.cn)("text-sm text-muted-foreground",a),...s})}).displayName="FormDescription";let y=s.forwardRef((e,t)=>{var a;let{className:s,children:n,...d}=e,{error:o,formMessageId:i}=u(),c=o?String(null!=(a=null==o?void 0:o.message)?a:""):n;return c?(0,r.jsx)("p",{ref:t,id:i,className:(0,l.cn)("text-sm font-medium text-destructive",s),...d,children:c}):null});y.displayName="FormMessage"},50276:(e,t,a)=>{a.d(t,{V:()=>i});var r=a(95155);a(12115);var s=a(51190),n=a(63263),d=a(75196),l=a(64269),o=a(3998);function i(e){let{className:t,classNames:a,showOutsideDays:i=!0,...c}=e;return(0,r.jsx)(d.hv,{showOutsideDays:i,className:(0,l.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,l.cn)((0,o.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,l.cn)((0,o.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:t,...a}=e;return(0,r.jsx)(s.A,{className:(0,l.cn)("h-4 w-4",t),...a})},IconRight:e=>{let{className:t,...a}=e;return(0,r.jsx)(n.A,{className:(0,l.cn)("h-4 w-4",t),...a})}},...c})}i.displayName="Calendar"},52587:(e,t,a)=>{a.d(t,{o:()=>w});var r=a(95155),s=a(12115),n=a(22544),d=a(66942),l=a(15653),o=a(3998),i=a(51834),c=a(41052),m=a(31120),u=a(15894),f=a(54901),p=a(14585),x=a(19708),h=a(92033),y=a(94979),g=a(11929),b=a(17037),j=a(5282),N=a(80160);let v=l.z.object({text:l.z.string().min(1,"El comentario no puede estar vac\xedo.")});function w(e){let{isOpen:t,onClose:a,permit:l,worksheetId:w,onCommentsUpdate:C}=e,{user:_}=(0,f.A)(),{toast:A}=(0,u.dj)(),[R,F]=(0,s.useState)(!1),[P,E]=(0,s.useState)([]);(0,s.useEffect)(()=>{t&&l.comments?E([...l.comments].reverse()):E([])},[t,l.comments]);let I=(0,n.mN)({resolver:(0,d.u)(v),defaultValues:{text:""}}),k=(null==_?void 0:_.role)==="ejecutivo"||(null==_?void 0:_.role)==="coordinadora"||(null==_?void 0:_.role)==="admin",M=async e=>{if(!_||!_.displayName||!k)return void A({title:"Acci\xf3n no permitida",description:"No tiene permisos para a\xf1adir comentarios.",variant:"destructive"});F(!0);let t={id:(0,g.A)(),author:_.displayName,text:e.text,createdAt:x.Dc.now()},a=[...l.comments||[],t],r=(0,x.H9)(p.db,"worksheets",w);try{let s=await (0,x.x7)(r);if(!s.exists())throw Error("Worksheet not found");let n=(s.data().requiredPermits||[]).map(e=>e.id===l.id?{...e,comments:a}:e),d=(0,x.wP)(p.db);d.update(r,{requiredPermits:n});let o=(0,x.H9)(p.db,"no existes",w),i=(0,x.rJ)(o,"actualizaciones"),c={updatedAt:x.Dc.now(),updatedBy:_.displayName,field:"document_update",oldValue:"Permiso '".concat(l.name,"'"),newValue:'Comentario a\xf1adido: "'.concat(e.text,'"'),comment:"Comentario en permiso '".concat(l.name,"'")};d.set((0,x.H9)(i),c),await d.commit(),C(a),E(e=>[t,...e]),I.reset(),A({title:"Comentario a\xf1adido"})}catch(e){console.error("Error adding permit comment:",e),A({title:"Error",description:"No se pudo guardar el comentario.",variant:"destructive"})}finally{F(!1)}};return t?(0,r.jsx)(i.lG,{open:t,onOpenChange:a,children:(0,r.jsxs)(i.Cf,{className:"max-w-lg",children:[(0,r.jsxs)(i.c7,{children:[(0,r.jsx)(i.L3,{children:"Comentarios para Permiso"}),(0,r.jsxs)(i.rr,{children:["A\xf1ada y vea notas para el permiso: ",(0,r.jsx)("span",{className:"font-bold text-foreground",children:l.name}),"."]})]}),(0,r.jsx)(b.F,{className:"max-h-[40vh] my-4",children:(0,r.jsx)("div",{className:"space-y-4 pr-6",children:P.length>0?P.map(e=>{let t;return(0,r.jsxs)("div",{className:"p-3 border rounded-lg bg-secondary/50",children:[(0,r.jsx)("p",{className:"text-sm text-foreground",children:e.text}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mt-2 text-right",children:[(0,r.jsxs)("span",{children:["- ",e.author]}),(0,r.jsxs)("span",{className:"ml-2",children:["(",(t=e.createdAt,(0,j.GP)(t.toDate(),"dd/MM/yy hh:mm a",{locale:N.es})),")"]})]})]},e.id)}):(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No hay comentarios para este permiso."})})}),k&&(0,r.jsx)(c.lV,{...I,children:(0,r.jsxs)("form",{onSubmit:I.handleSubmit(M),className:"space-y-4 pt-4 border-t",children:[(0,r.jsx)(c.zB,{control:I.control,name:"text",render:e=>{let{field:t}=e;return(0,r.jsxs)(c.eI,{children:[(0,r.jsx)(c.lR,{children:"Nuevo Comentario"}),(0,r.jsx)(c.MJ,{children:(0,r.jsx)(m.T,{...t,rows:3,disabled:R,placeholder:"Escriba su comentario aqu\xed..."})}),(0,r.jsx)(c.C5,{})]})}}),(0,r.jsxs)(i.Es,{className:"pt-4",children:[(0,r.jsx)(o.$,{type:"button",variant:"outline",onClick:a,children:"Cerrar"}),(0,r.jsxs)(o.$,{type:"submit",disabled:R,children:[R&&(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4 animate-spin"}),(0,r.jsx)(y.A,{className:"mr-2 h-4 w-4"})," Enviar"]})]})]})})]})}):null}},76444:(e,t,a)=>{a.d(t,{J:()=>i});var r=a(95155),s=a(12115),n=a(10489),d=a(83101),l=a(64269);let o=(0,d.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.b,{ref:t,className:(0,l.cn)(o(),a),...s})});i.displayName=n.b.displayName}}]);