(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5416],{11186:(e,a,t)=>{"use strict";t.d(a,{bq:()=>u,eb:()=>f,gC:()=>h,l6:()=>c,yv:()=>m});var s=t(95155),r=t(12115),o=t(47887),n=t(59007),i=t(42614),l=t(72251),d=t(64269);let c=o.bL;o.YJ;let m=o.WT,u=r.forwardRef((e,a)=>{let{className:t,children:r,...i}=e;return(0,s.jsxs)(o.l9,{ref:a,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...i,children:[r,(0,s.jsx)(o.In,{asChild:!0,children:(0,s.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=o.l9.displayName;let p=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(o.PP,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})});p.displayName=o.PP.displayName;let x=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(o.wn,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});x.displayName=o.wn.displayName;let h=r.forwardRef((e,a)=>{let{className:t,children:r,position:n="popper",...i}=e;return(0,s.jsx)(o.ZL,{children:(0,s.jsxs)(o.UC,{ref:a,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...i,children:[(0,s.jsx)(p,{}),(0,s.jsx)(o.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(x,{})]})})});h.displayName=o.UC.displayName,r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(o.JU,{ref:a,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=o.JU.displayName;let f=r.forwardRef((e,a)=>{let{className:t,children:r,...n}=e;return(0,s.jsxs)(o.q7,{ref:a,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(o.VF,{children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})}),(0,s.jsx)(o.p4,{children:r})]})});f.displayName=o.q7.displayName,r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(o.wv,{ref:a,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=o.wv.displayName},29129:(e,a,t)=>{Promise.resolve().then(t.bind(t,71313))},31120:(e,a,t)=>{"use strict";t.d(a,{T:()=>n});var s=t(95155),r=t(12115),o=t(64269);let n=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...r})});n.displayName="Textarea"},71313:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>eu});var s=t(95155),r=t(12115),o=t(20063),n=t(54901),i=t(35434),l=t(3998),d=t(65142),c=t(31120),m=t(86948),u=t(7639),p=t(13630),x=t(36654),h=t(75496),f=t(27314),v=t(66065),g=t(28127),N=t(92033),j=t(90109),b=t(53489),y=t(14585),C=t(19708),w=t(27384),A=t(5282),S=t(47691),P=t(33086),D=t(90231),E=t(79894),M=t(80160),R=t(87270),O=t(11186),I=t(26333),k=t(50276),T=t(73457),B=t(51834),F=t(46767),U=t(11647),_=t(15894),G=t(64269),L=t(76444),q=t(24820),H=t(92678),$=t(26615),z=t(2165),Z=t(94979),J=t(50817),V=t(5225),W=t(44381),Q=t(98039),X=t(6943),Y=t(59729),K=t(25128),ee=t(50705),ea=t(56639),et=t(47974),es=t(27500),er=t(76251),eo=t(15239),en=t(95704);let ei=e=>{let a,{label:t,value:r,icon:o,className:n}=e;return a="boolean"==typeof r?r?"S\xed":"No":r instanceof Date?(0,A.GP)(r,"PPP",{locale:M.es}):String(null!=r?r:"N/A"),(0,s.jsxs)("div",{className:(0,G.cn)("py-1 flex items-baseline print:py-0",n),children:[(0,s.jsxs)("p",{className:"text-xs font-medium text-muted-foreground flex items-center shrink-0 print:text-xs",children:[o&&(0,s.jsx)(o,{className:"h-3.5 w-3.5 mr-1.5 text-primary/70 print:h-3 print:w-3"}),t,":\xa0"]}),(0,s.jsx)("p",{className:"text-sm text-foreground break-words print:text-xs print:font-semibold",children:a})]})},el=e=>{let{label:a,checked:t,subLabel:r}=e;return(0,s.jsxs)("div",{className:"flex items-center py-1 print:py-0.5",children:[t?(0,s.jsx)(q.A,{className:"h-4 w-4 text-green-600 mr-2 print:h-3 print:w-3"}):(0,s.jsx)(H.A,{className:"h-4 w-4 text-muted-foreground mr-2 print:h-3 print:w-3"}),(0,s.jsx)("span",{className:"text-sm text-foreground print:text-xs",children:a}),r&&(0,s.jsx)("span",{className:"text-xs text-muted-foreground ml-1 print:text-xs",children:r})]})};function ed(e){let{solicitud:a,onBackToList:t}=e,[o,n]=(0,r.useState)(!1),[i,d]=(0,r.useState)(null),c={ne:a.examNe,reference:a.examReference||void 0,manager:a.examManager,date:a.examDate||new Date,recipient:a.examRecipient,isMemorandum:a.isMemorandum},u=()=>{window.print()};return(0,s.jsx)(m.Zp,{className:"w-full shadow-lg",children:(()=>o?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)(N.A,{className:"h-8 w-8 animate-spin text-primary"})}):i?(0,s.jsx)("div",{className:"text-center p-10 text-destructive",children:i}):a&&c?(0,s.jsxs)("div",{id:"printable-area",children:[(0,s.jsx)("div",{className:"hidden print:block",children:(0,s.jsx)(eo.default,{src:"/AconicExaminer/imagenes/HEADERSEXA.svg",alt:"Header Solicitud Detail",width:800,height:100,className:"w-full h-auto object-contain","data-ai-hint":"company logo banner",priority:!0})}),(0,s.jsxs)(m.aR,{className:"p-0 mb-4 no-print",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(m.ZB,{className:"text-xl md:text-2xl font-semibold text-foreground",children:"Detalle de Memorando"}),t&&(0,s.jsx)(l.$,{variant:"ghost",size:"icon",onClick:t,children:(0,s.jsx)($.A,{className:"h-5 w-5"})})]}),(0,s.jsx)(m.BT,{className:"text-muted-foreground",children:"Mostrando informaci\xf3n del memorando seleccionado."})]}),(0,s.jsxs)(m.Wu,{className:"pt-4 print:p-0",children:[(0,s.jsx)("div",{className:"mb-3 p-4 border rounded-md bg-secondary/5 print:border print:mb-2",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(ei,{label:"ID de Solicitud",value:a.solicitudId,icon:v.A}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(U.E,{variant:"destructive",className:"text-sm font-semibold px-3 py-1 print:text-xs",children:[(0,s.jsx)(z.A,{className:"h-4 w-4 mr-1.5"})," Memor\xe1ndum"]})})]})}),(0,s.jsxs)("div",{className:"mb-3 p-4 border rounded-md bg-secondary/30 print:border print:mb-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2 text-primary print:text-base print:mb-1",children:"Informaci\xf3n General"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-0 print:grid-cols-2 print:gap-x-8",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(ei,{label:"A",value:c.recipient,icon:Z.A}),(0,s.jsx)(ei,{label:"Fecha de Solicitud",value:c.date,icon:J.A}),(0,s.jsx)(ei,{label:"Referencia",value:c.reference||"N/A",icon:V.A})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(ei,{label:"De (Usuario)",value:c.manager,icon:f.A}),(0,s.jsx)(ei,{label:"NE (Tracking NX1)",value:c.ne,icon:v.A})]})]})]}),a.isMemorandum&&a.memorandumCollaborators&&a.memorandumCollaborators.length>0&&(0,s.jsxs)("div",{className:"mb-3 p-4 border border-destructive/50 rounded-md bg-destructive/5 print:border print:mb-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2 text-destructive print:text-base print:mb-1",children:"Colaboradores del Memor\xe1ndum"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-1 print:grid-cols-2 print:gap-x-8",children:a.memorandumCollaborators.map(e=>(0,s.jsxs)("div",{className:"p-2 border-b border-destructive/20 print:p-1 print:border-0",children:[(0,s.jsx)(ei,{label:"Nombre",value:e.name,icon:f.A}),(0,s.jsx)(ei,{label:"N\xfamero Colaborador",value:e.number,icon:W.A})]},e.id))})]}),(0,s.jsxs)("div",{className:"mb-3 p-4 border border-border rounded-md bg-secondary/30 print:border print:mb-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-2 print:text-xs",children:"Por este medio me dirijo a usted para solicitarle que elabore cheque por la cantidad de:"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 items-start mb-3 print:grid-cols-2 print:gap-x-8 print:mb-2",children:[(0,s.jsxs)("div",{className:"flex items-baseline py-1",children:[(0,s.jsx)(Q.A,{className:"h-4 w-4 mr-1.5 text-primary shrink-0 print:h-3 print:w-3"}),(0,s.jsx)("p",{className:"text-sm text-foreground break-words print:text-xs print:font-bold",children:((e,a)=>{if(null==e||""===e)return"N/A";let t=Number(e);if(isNaN(t))return String(e);let s="";return"cordoba"===a?s="C$":"dolar"===a?s="US$":"euro"===a&&(s="€"),"".concat(s).concat(t.toLocaleString("es-NI",{minimumFractionDigits:2,maximumFractionDigits:2}))})(a.monto,a.montoMoneda||void 0)})]}),(0,s.jsxs)("div",{className:"flex items-baseline py-1",children:[(0,s.jsx)(V.A,{className:"h-4 w-4 mr-1.5 text-primary shrink-0 print:h-3 print:w-3"}),(0,s.jsx)("p",{className:"text-sm text-foreground break-words print:text-xs print:font-bold",children:a.cantidadEnLetras||"N/A"})]})]}),(0,s.jsxs)("div",{className:"space-y-3 divide-y divide-border print:space-y-1",children:[(0,s.jsx)("div",{className:"pt-3 print:pt-1",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-x-4 print:grid-cols-3 print:gap-x-8",children:[(0,s.jsx)(ei,{label:"Consignatario",value:a.consignatario,icon:X.A}),(0,s.jsx)(ei,{label:"Declaraci\xf3n N\xfamero",value:a.declaracionNumero,icon:W.A}),(0,s.jsx)(ei,{label:"Unidad Recaudadora",value:a.unidadRecaudadora,icon:Y.A}),(0,s.jsx)(ei,{label:"C\xf3digo 1",value:a.codigo1,icon:K.A}),(0,s.jsx)(ei,{label:"Codigo MUR",value:a.codigo2,icon:K.A})]})}),(0,s.jsx)("div",{className:"pt-3 print:pt-1",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-x-4 items-start print:grid-cols-3 print:gap-x-8",children:[(0,s.jsx)(ei,{label:"Banco",value:"ACCION POR CHEQUE/NO APLICA BANCO"===a.banco?"Acci\xf3n por Cheque / No Aplica Banco":"Otros"===a.banco?a.bancoOtros||"Otros (No especificado)":a.banco,icon:ee.A}),"ACCION POR CHEQUE/NO APLICA BANCO"!==a.banco&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ei,{label:"N\xfamero de Cuenta",value:a.numeroCuenta,icon:W.A}),(0,s.jsx)(ei,{label:"Moneda de la Cuenta",value:"Otros"===a.monedaCuenta?a.monedaCuentaOtros||"Otros (No especificado)":a.monedaCuenta,icon:Q.A})]})]})}),(0,s.jsx)("div",{className:"pt-3 print:pt-1",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 print:grid-cols-2 print:gap-x-8",children:[(0,s.jsx)(ei,{label:"Elaborar Cheque A",value:a.elaborarChequeA,icon:f.A}),(0,s.jsx)(ei,{label:"Elaborar Transferencia A",value:a.elaborarTransferenciaA,icon:f.A})]})}),(0,s.jsx)("div",{className:"pt-3 print:pt-1",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 print:grid-cols-2 print:gap-x-8",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(el,{label:"Impuestos pendientes de pago por el cliente",checked:a.impuestosPendientesCliente}),(0,s.jsx)(el,{label:"Soporte",checked:a.soporte}),(0,s.jsx)(el,{label:"Impuestos pagados por el cliente mediante:",checked:a.impuestosPagadosCliente}),a.impuestosPagadosCliente&&(0,s.jsxs)("div",{className:"ml-6 pl-2 border-l border-dashed",children:[(0,s.jsx)(ei,{label:"R/C No.",value:a.impuestosPagadosRC}),(0,s.jsx)(ei,{label:"T/B No.",value:a.impuestosPagadosTB}),(0,s.jsx)(ei,{label:"Cheque No.",value:a.impuestosPagadosCheque})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(el,{label:"Se a\xf1aden documentos adjuntos",checked:a.documentosAdjuntos}),(0,s.jsx)(el,{label:"Constancias de no retenci\xf3n",checked:a.constanciasNoRetencion}),a.constanciasNoRetencion&&(0,s.jsxs)("div",{className:"ml-6 pl-2 border-l border-dashed",children:[(0,s.jsx)(el,{label:"1%",checked:a.constanciasNoRetencion1}),(0,s.jsx)(el,{label:"2%",checked:a.constanciasNoRetencion2})]})]})]})}),a.pagoServicios&&(0,s.jsxs)("div",{className:"pt-3 print:pt-1",children:[(0,s.jsx)("h4",{className:"text-md font-medium text-primary mb-1 print:text-sm",children:"Pago de Servicios"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 print:grid-cols-2 print:gap-x-8",children:[(0,s.jsx)(ei,{label:"Tipo de Servicio",value:"OTROS"===a.tipoServicio?a.otrosTipoServicio:a.tipoServicio,icon:ea.A}),(0,s.jsx)(ei,{label:"Factura Servicio",value:a.facturaServicio,icon:V.A}),(0,s.jsx)(ei,{label:"Instituci\xf3n Servicio",value:a.institucionServicio,icon:Y.A})]})]}),(0,s.jsxs)("div",{className:"pt-3 print:pt-1",children:[(0,s.jsx)(ei,{label:"Correos de Notificaci\xf3n",value:a.correo,icon:et.A}),(0,s.jsx)(ei,{label:"Observaci\xf3n",value:a.observation,icon:es.A})]})]})]}),(0,s.jsx)("div",{className:"hidden print:block",children:(0,s.jsx)(eo.default,{src:"/AconicExaminer/imagenes/FOOTERSOLICITUDETAIL.svg",alt:"Footer Solicitud Detail",width:800,height:100,className:"w-full h-auto object-contain mt-6","data-ai-hint":"company seal official",priority:!0})}),(0,s.jsx)("div",{className:"no-print mt-4 flex justify-end",children:(0,s.jsxs)(l.$,{onClick:u,children:[(0,s.jsx)(er.A,{className:"mr-2 h-4 w-4"})," Imprimir"]})})]})]}):(0,s.jsx)("div",{className:"text-center p-10 text-muted-foreground",children:"Datos de la solicitud no encontrados."}))()})}en.env.NEXT_PUBLIC_BASE_PATH;let ec=(e,a)=>{if(null==e||""===e)return"N/A";let t=Number(e);if(isNaN(t)&&"string"==typeof e&&""===e.trim())return"N/A";if(isNaN(t))return String(e);let s="";return"cordoba"===a?s="C$":"dolar"===a?s="US$":"euro"===a&&(s="€"),"".concat(s).concat(t.toLocaleString("es-NI",{minimumFractionDigits:2,maximumFractionDigits:2}))},em=e=>{let{solicitudes:a,searchType:t,searchTerm:o,currentUserRole:i,onUpdateRHStatus:c,onViewDetails:g,onOpenCommentsDialog:N,onDeleteSolicitud:j,onRefreshSearch:b,filterSolicitudIdInput:y,setFilterSolicitudIdInput:C,filterNEInput:w,setFilterNEInput:S,filterFechaSolicitudInput:P,setFilterFechaSolicitudInput:D,filterMontoInput:E,setFilterMontoInput:O,filterConsignatarioInput:I,setFilterConsignatarioInput:k,filterGuardadoPorInput:T,setFilterGuardadoPorInput:B}=e,{user:_}=(0,n.A)(),[L,q]=(0,r.useState)({});if(!a||0===a.length){let e="No se encontraron memorandos para los criterios ingresados.";return"dateToday"===t?e="No se encontraron memorandos para hoy.":"dateCurrentMonth"===t&&(e="No se encontraron memorandos para el mes actual."),(0,s.jsx)("p",{className:"text-muted-foreground text-center py-4",children:e})}let H="autorevisor"===i||"autorevisor_plus"===i;return(0,s.jsxs)(m.Zp,{className:"mt-6 w-full custom-shadow",children:[(0,s.jsxs)(m.aR,{children:[(0,s.jsx)(m.ZB,{className:"text-xl md:text-2xl font-semibold text-foreground",children:"dateToday"===t?"Memorandos de Hoy (".concat((0,A.GP)(new Date,"PPP",{locale:M.es}),")"):"dateCurrentMonth"===t?"Memorandos del Mes Actual (".concat((0,A.GP)(new Date,"MMMM yyyy",{locale:M.es}),")"):"dateSpecific"===t&&o?"Memorandos del ".concat(o):"dateRange"===t&&o?"Memorandos para ".concat(o):"Memorandos Encontrados"}),(0,s.jsxs)(m.BT,{className:"text-muted-foreground",children:["Se encontraron ",a.length," memorando(s) asociados."]})]}),(0,s.jsx)(m.Wu,{children:(0,s.jsx)("div",{className:"overflow-x-auto table-container rounded-lg border",children:(0,s.jsxs)(R.XI,{children:[(0,s.jsx)(R.A0,{className:"bg-secondary/50",children:(0,s.jsxs)(R.Hj,{children:[(0,s.jsxs)(R.nd,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider whitespace-nowrap",children:[(0,s.jsx)(l.$,{variant:"ghost",size:"icon",onClick:b,className:"h-6 w-6 p-0 mr-1",children:(0,s.jsx)(u.A,{className:"h-4 w-4 text-primary"})}),"Acciones"]}),(0,s.jsx)(R.nd,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider whitespace-nowrap",children:"Colaborador(es)"}),(0,s.jsxs)(R.nd,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider whitespace-nowrap",children:["Fecha",(0,s.jsx)(d.p,{type:"text",placeholder:"Filtrar Fecha (dd/MM/yy)...",value:P,onChange:e=>D(e.target.value),className:"mt-1 h-8 text-xs"})]}),(0,s.jsxs)(R.nd,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider whitespace-nowrap",children:["Monto",(0,s.jsx)(d.p,{type:"text",placeholder:"Filtrar Monto...",value:E,onChange:e=>O(e.target.value),className:"mt-1 h-8 text-xs"})]}),(0,s.jsxs)(R.nd,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider whitespace-nowrap",children:["Consignatario",(0,s.jsx)(d.p,{type:"text",placeholder:"Filtrar Consignatario...",value:I,onChange:e=>k(e.target.value),className:"mt-1 h-8 text-xs"})]}),(0,s.jsxs)(R.nd,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider whitespace-nowrap",children:["Guardado Por",(0,s.jsx)(d.p,{type:"text",placeholder:H?"Filtrado por rol":"Filtrar Guardado Por...",value:T,onChange:e=>B(e.target.value),className:"mt-1 h-8 text-xs",disabled:H,readOnly:H})]}),(0,s.jsxs)(R.nd,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider whitespace-nowrap",children:["NE",(0,s.jsx)(d.p,{type:"text",placeholder:"Filtrar NE...",value:w,onChange:e=>S(e.target.value),className:"mt-1 h-8 text-xs"})]}),(0,s.jsxs)(R.nd,{className:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider whitespace-nowrap",children:["ID Solicitud",(0,s.jsx)(d.p,{type:"text",placeholder:"Filtrar ID...",value:y,onChange:e=>C(e.target.value),className:"mt-1 h-8 text-xs"})]})]})}),(0,s.jsx)(R.BF,{className:"bg-card divide-y divide-border",children:a.map(e=>{var a,t;let r=e.hasOpenUrgentComment,o="hover:bg-muted/50 dark:hover:bg-muted/80";return r&&(o="bg-red-200 hover:bg-red-300 dark:bg-red-600/40 dark:hover:bg-red-600/50"),(0,s.jsxs)(R.Hj,{className:(0,G.cn)(o),children:[(0,s.jsx)(R.nA,{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:["admin"===i&&(0,s.jsx)(F.Bc,{children:(0,s.jsxs)(F.m_,{children:[(0,s.jsx)(F.k$,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>j(e.solicitudId),className:"px-2 py-1 h-auto text-destructive hover:bg-destructive/10","aria-label":"Eliminar Solicitud",children:(0,s.jsx)(p.A,{className:"h-3.5 w-3.5"})})}),(0,s.jsx)(F.ZI,{children:(0,s.jsx)("p",{children:"Eliminar Memorando"})})]})}),(0,s.jsx)(F.Bc,{children:(0,s.jsxs)(F.m_,{children:[(0,s.jsx)(F.k$,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>g(e),className:"px-2 py-1 h-auto","aria-label":"Ver Detalles",children:(0,s.jsx)(x.A,{className:"h-3.5 w-3.5"})})}),(0,s.jsx)(F.ZI,{children:(0,s.jsx)("p",{children:"Ver Detalles"})})]})}),(0,s.jsx)(F.Bc,{children:(0,s.jsxs)(F.m_,{children:[(0,s.jsx)(F.k$,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>N(e.solicitudId),className:"px-2 py-1 h-auto","aria-label":"Comentarios",children:(0,s.jsx)(h.A,{className:"h-3.5 w-3.5"})})}),(0,s.jsx)(F.ZI,{children:(0,s.jsx)("p",{children:"Comentarios"})})]})}),(0,s.jsx)(U.E,{variant:"secondary",className:"h-6 min-w-[1.5rem] flex items-center justify-center px-1.5 py-0.5 text-xs",children:null!=(a=e.commentsCount)?a:0})]})}),(0,s.jsx)(R.nA,{className:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground",children:e.memorandumCollaborators&&e.memorandumCollaborators.length>0?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(f.A,{className:"h-4 w-4 mr-2"}),e.memorandumCollaborators[0].name,e.memorandumCollaborators.length>1&&(0,s.jsxs)(U.E,{variant:"secondary",className:"ml-2",children:["+",e.memorandumCollaborators.length-1]})]}):"N/A"}),(0,s.jsx)(R.nA,{className:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground",children:e.examDate instanceof Date?(0,A.GP)(e.examDate,"dd/MM/yy",{locale:M.es}):"N/A"}),(0,s.jsx)(R.nA,{className:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground",children:ec(null!=(t=e.monto)?t:void 0,e.montoMoneda||void 0)}),(0,s.jsx)(R.nA,{className:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground",children:e.consignatario&&e.consignatario.length>21?(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("span",{children:"".concat(e.consignatario.substring(0,21),"...")}),(0,s.jsx)(F.Bc,{children:(0,s.jsxs)(F.m_,{children:[(0,s.jsx)(F.k$,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"h-5 w-5 p-0",children:(0,s.jsx)(v.A,{className:"h-3.5 w-3.5 text-muted-foreground"})})}),(0,s.jsx)(F.ZI,{className:"text-xs max-w-xs break-words",children:(0,s.jsx)("p",{children:e.consignatario})})]})})]}):e.consignatario||"N/A"}),(0,s.jsx)(R.nA,{className:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground",children:(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("span",{children:e.savedBy||"N/A"}),e.savedAt&&e.savedAt instanceof Date&&(0,s.jsx)(F.Bc,{children:(0,s.jsxs)(F.m_,{children:[(0,s.jsx)(F.k$,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"ghost",size:"icon",className:"h-6 w-6 p-0",children:(0,s.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"})})}),(0,s.jsxs)(F.ZI,{className:"text-xs",children:[(0,s.jsx)("p",{children:"Guardado el:"}),(0,s.jsx)("p",{children:(0,A.GP)(e.savedAt,"Pp",{locale:M.es})})]})]})})]})}),(0,s.jsx)(R.nA,{className:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground",children:e.examNe}),(0,s.jsx)(R.nA,{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-foreground",children:e.solicitudId})]},e.solicitudId)})})]})})})]})};function eu(){let{user:e,loading:a}=(0,n.A)(),t=(0,o.useRouter)(),{toast:d}=(0,_.dj)(),[u,p]=(0,r.useState)("dateToday"),[x,h]=(0,r.useState)(""),[f,v]=(0,r.useState)(void 0),[R,F]=(0,r.useState)(void 0),[U,q]=(0,r.useState)(void 0),[H,$]=(0,r.useState)(!1),[z,Z]=(0,r.useState)(!1),[J,V]=(0,r.useState)(!1),[W,Q]=(0,r.useState)(!1),[X,Y]=(0,r.useState)(null),[K,ee]=(0,r.useState)(null),[ea,et]=(0,r.useState)(!1),[es,er]=(0,r.useState)(""),[eo,en]=(0,r.useState)(!1),[ei,el]=(0,r.useState)(null),[eu,ep]=(0,r.useState)([]),[ex,eh]=(0,r.useState)(""),[ef,ev]=(0,r.useState)(!1),[eg,eN]=(0,r.useState)(!1),[ej,eb]=(0,r.useState)(!1),[ey,eC]=(0,r.useState)(!1),[ew,eA]=(0,r.useState)(null),[eS,eP]=(0,r.useState)(""),[eD,eE]=(0,r.useState)(""),[eM,eR]=(0,r.useState)(""),[eO,eI]=(0,r.useState)(""),[ek,eT]=(0,r.useState)(""),[eB,eF]=(0,r.useState)(""),[eU,e_]=(0,r.useState)(null),[eG,eL]=(0,r.useState)(!1),[eq,eH]=(0,r.useState)(!1);(0,r.useEffect)(()=>{et(!0),!a&&e&&(e.hasPaymentAccess||"admin"===e.role||"calificador"===e.role||(d({title:"Acceso Denegado",description:"No tiene permisos para acceder a esta plataforma.",variant:"destructive",duration:5e3}),t.push("/")))},[a,e,t,d]);let e$=(0,r.useMemo)(()=>{if(!K)return null;let a=[...K],t=(e,a,t)=>{if(!a.trim())return e;let s=a.toLowerCase().trim();return e.filter(e=>t(e,s))};return a=t(a,eS,(e,a)=>e.solicitudId.toLowerCase().includes(a)),a=t(a,eM,(e,a)=>(e.examDate&&e.examDate instanceof Date?(0,A.GP)(e.examDate,"dd/MM/yy",{locale:M.es}):"N/A").toLowerCase().includes(a)),a=t(a,eD,(e,a)=>(e.examNe||"").toLowerCase().includes(a)),a=t(a,eO,(e,a)=>{var t;return ec(null!=(t=e.monto)?t:void 0,e.montoMoneda||void 0).toLowerCase().includes(a)}),a=t(a,ek,(e,a)=>(e.consignatario||"").toLowerCase().includes(a)),(null==e?void 0:e.role)!=="autorevisor"&&(null==e?void 0:e.role)!=="autorevisor_plus"&&(a=t(a,eB,(e,a)=>(e.savedBy||"").toLowerCase().includes(a))),a},[K,eS,eM,eD,eO,ek,eB,null==e?void 0:e.role]),ez=(0,r.useCallback)(async(a,t,s)=>{if(!e||!e.email)return void d({title:"Error",description:"Usuario no autenticado.",variant:"destructive"});let r=(0,C.H9)(y.db,"Memorandum",a);try{let o={rhPaymentStatus:t,rhStatusLastUpdatedAt:(0,C.O5)(),rhStatusLastUpdatedBy:e.email};"otros"===t&&s&&(o.rhPaymentOtherDetails=s),await (0,C.mZ)(r,o),d({title:"\xc9xito",description:"Estado de RH actualizado para ".concat(a,".")}),ee(e=>(null==e?void 0:e.map(e=>e.solicitudId===a?{...e,rhPaymentStatus:t,rhPaymentOtherDetails:null!=s?s:e.rhPaymentOtherDetails}:e))||null)}catch(e){console.error("Error updating RH status: ",e),d({title:"Error",description:"No se pudo actualizar el estado de RH.",variant:"destructive"})}},[e,d]),eZ=async e=>{el(e),eb(!1),ep([]),ev(!0),en(!0);try{let a=(0,C.rJ)(y.db,"Memorandum",e,"comments"),t=(0,C.P)(a,(0,C.My)("createdAt","asc")),s=(await (0,C.GG)(t)).docs.map(e=>{let a=e.data();return{id:e.id,...a,createdAt:a.createdAt instanceof C.Dc?a.createdAt.toDate():new Date}});ep(s)}catch(e){console.error("Error fetching comments: ",e),d({title:"Error",description:"No se pudieron cargar los comentarios.",variant:"destructive"}),ep([])}finally{ev(!1)}},eJ=()=>{en(!1),el(null),eh(""),eb(!1),ep([])},eV=async()=>{if(!ex.trim()||!ei||!e||!e.email)return void d({title:"Error",description:"El comentario no puede estar vac\xedo o falta informaci\xf3n del usuario/solicitud.",variant:"destructive"});eN(!0);let a="Memorandum";try{let t,s=(0,C.rJ)(y.db,a,ei,"comments"),r={solicitudId:ei,text:ex.trim(),userId:e.uid,userEmail:e.email,createdAt:(0,C.O5)()},o=await (0,C.gS)(s,r);if(ej){let e=(0,C.H9)(y.db,a,ei);await (0,C.mZ)(e,{hasOpenUrgentComment:!0}),t=!0}ep(e=>[...e,{...r,id:o.id,createdAt:new Date}]),eh(""),eb(!1),d({title:"\xc9xito",description:"Comentario publicado."}),ee(e=>(null==e?void 0:e.map(e=>{if(e.solicitudId===ei){var a;let s={...e,commentsCount:(null!=(a=e.commentsCount)?a:0)+1};return void 0!==t&&(s.hasOpenUrgentComment=t),s}return e}))||null)}catch(e){console.error("Error posting comment: ",e),d({title:"Error",description:"No se pudo publicar el comentario.",variant:"destructive"})}finally{eN(!1)}},eW=async()=>{if(!ew||(null==e?void 0:e.role)!=="admin"||!e.email){d({title:"Error",description:"No se pudo eliminar el memorando o acci\xf3n no autorizada.",variant:"destructive"}),eC(!1);return}let a=(0,C.H9)(y.db,"Memorandum",ew);try{let t=await (0,C.x7)(a);if(!t.exists()){d({title:"Error",description:"El memorando ".concat(ew," no existe."),variant:"destructive"}),eC(!1);return}let s=t.data(),r=(0,C.H9)(y.db,"Eliminaciones",ew),o=(0,C.H9)((0,C.rJ)(y.db,"Eliminaciones",ew,"AuditTrail")),n={action:"deleted",deletedBy:e.email,deletedAt:(0,C.O5)()},i=(0,C.wP)(y.db);i.set(r,s),i.set(o,n),i.delete(a),await i.commit(),d({title:"\xc9xito",description:"Memorando ".concat(ew," eliminado y archivado.")}),ee(e=>e?e.filter(e=>e.solicitudId!==ew):null)}catch(e){console.error("Error deleting and archiving memorandum:",e),d({title:"Error",description:"No se pudo completar la eliminaci\xf3n y archivado.",variant:"destructive"})}finally{eC(!1),eA(null)}};(0,r.useEffect)(()=>{et(!0)},[]),(0,r.useEffect)(()=>{if(ea&&!a&&(null==e?void 0:e.email)){if("autorevisor"===e.role)eF(e.email);else if("autorevisor_plus"===e.role){let a=e.canReviewUserEmails&&e.canReviewUserEmails.length>0?", ".concat(e.canReviewUserEmails.join(", ")):"";eF("".concat(e.email).concat(a))}}},[ea,a,e]);let eQ=async a=>{var t;let s=null==a?void 0:a.event,r=null!=(t=null==a?void 0:a.preserveFilters)&&t;if(s&&s.preventDefault(),!e)return void d({title:"No autenticado",description:"Debe iniciar sesi\xf3n para buscar.",variant:"destructive"});Q(!0),Y(null),ee(null),er(""),eL(!1),e_(null),r||(eP(""),eR(""),eE(""),eI(""),eT(""),(null==e?void 0:e.role)!=="autorevisor"&&(null==e?void 0:e.role)!=="autorevisor_plus"&&eF(""));let o=(0,C.rJ)(y.db,"Memorandum"),n=x.trim(),i=[];if(i.push((0,C.My)("examDate","desc")),null==e?void 0:e.email)if("autorevisor"===e.role)i.push((0,C._M)("savedBy","==",e.email));else if(e.visibilityGroup&&e.visibilityGroup.length>0)try{let a=(0,C.P)((0,C.rJ)(y.db,"users"),(0,C._M)("uid","in",e.visibilityGroup)),t=(await (0,C.GG)(a)).docs.map(e=>e.data().email).filter(Boolean);t.length>0?i.push((0,C._M)("savedBy","in",t)):i.push((0,C._M)("savedBy","==",e.email))}catch(a){console.error("Error fetching group member emails",a),i.push((0,C._M)("savedBy","==",e.email))}else if("autorevisor_plus"===e.role&&e.canReviewUserEmails&&e.canReviewUserEmails.length>0){let a=[e.email,...e.canReviewUserEmails];i.push((0,C._M)("savedBy","in",a))}else"autorevisor_plus"!==e.role||e.canReviewUserEmails&&0!==e.canReviewUserEmails.length||i.push((0,C._M)("savedBy","==",e.email));try{switch(u){case"dateToday":let e=(0,S.o)(new Date),a=(0,P.D)(new Date);i.push((0,C._M)("examDate",">=",C.Dc.fromDate(e))),i.push((0,C._M)("examDate","<=",C.Dc.fromDate(a))),n=(0,A.GP)(new Date,"PPP",{locale:M.es});break;case"dateCurrentMonth":let t=(0,D.w)(new Date),s=(0,E.p)(new Date);i.push((0,C._M)("examDate",">=",C.Dc.fromDate(t))),i.push((0,C._M)("examDate","<=",C.Dc.fromDate(s))),n=(0,A.GP)(new Date,"MMMM yyyy",{locale:M.es});break;case"dateSpecific":if(!f){Y("Por favor, seleccione una fecha espec\xedfica."),Q(!1);return}let r=(0,S.o)(f),l=(0,P.D)(f);i.push((0,C._M)("examDate",">=",C.Dc.fromDate(r))),i.push((0,C._M)("examDate","<=",C.Dc.fromDate(l))),n=(0,A.GP)(f,"PPP",{locale:M.es});break;case"dateRange":if(!R||!U){Y("Por favor, seleccione un rango de fechas (inicio y fin)."),Q(!1);return}if(R>U){Y("La fecha de inicio no puede ser posterior a la fecha de fin."),Q(!1);return}let d=(0,S.o)(R),c=(0,P.D)(U);i.push((0,C._M)("examDate",">=",C.Dc.fromDate(d))),i.push((0,C._M)("examDate","<=",C.Dc.fromDate(c))),n="Rango: ".concat((0,A.GP)(R,"dd/MM/yy",{locale:M.es})," - ").concat((0,A.GP)(U,"dd/MM/yy",{locale:M.es}));break;default:Y("Tipo de b\xfasqueda no v\xe1lido."),Q(!1);return}er(n);let m=(0,C.P)(o,...i),p=await (0,C.GG)(m);if(p.empty)Y("No se encontraron memorandos para los criterios ingresados.");else{let e=p.docs.map(async e=>{var a,t,s,r,o,n,i,l,d,c,m;let u=e.data(),p=u.examDate instanceof C.Dc?u.examDate.toDate():u.examDate instanceof Date?u.examDate:void 0,x=u.savedAt instanceof C.Dc?u.savedAt.toDate():u.savedAt instanceof Date?u.savedAt:void 0,h=u.rhPaymentDate instanceof C.Dc?u.rhPaymentDate.toDate():u.rhPaymentDate instanceof Date?u.rhPaymentDate:void 0,f=u.rhPaymentStartDate instanceof C.Dc?u.rhPaymentStartDate.toDate():u.rhPaymentStartDate instanceof Date?u.rhPaymentStartDate:void 0,v=u.rhPaymentEndDate instanceof C.Dc?u.rhPaymentEndDate.toDate():u.rhPaymentEndDate instanceof Date?u.rhPaymentEndDate:void 0,g=0;try{let a=(0,C.rJ)(y.db,"Memorandum",e.id,"comments");g=(await (0,C.d_)(a)).data().count}catch(a){console.error("Error fetching comments count for ".concat(e.id,": "),a)}return{...u,solicitudId:e.id,examDate:p,savedAt:x,monto:null!=(a=u.monto)?a:null,montoMoneda:u.montoMoneda||null,cantidadEnLetras:u.cantidadEnLetras||null,consignatario:u.consignatario||null,declaracionNumero:u.declaracionNumero||null,unidadRecaudadora:u.unidadRecaudadora||null,codigo1:u.codigo1||null,codigo2:u.codigo2||null,banco:u.banco||null,bancoOtros:u.bancoOtros||null,numeroCuenta:u.numeroCuenta||null,monedaCuenta:u.monedaCuenta||null,monedaCuentaOtros:u.monedaCuentaOtros||null,elaborarChequeA:u.elaborarChequeA||null,elaborarTransferenciaA:u.elaborarTransferenciaA||null,impuestosPagadosCliente:null!=(t=u.impuestosPagadosCliente)&&t,impuestosPagadosRC:u.impuestosPagadosRC||null,impuestosPagadosTB:u.impuestosPagadosTB||null,impuestosPagadosCheque:u.impuestosPagadosCheque||null,impuestosPendientesCliente:null!=(s=u.impuestosPendientesCliente)&&s,soporte:null!=(r=u.soporte)&&r,documentosAdjuntos:null!=(o=u.documentosAdjuntos)&&o,constanciasNoRetencion:null!=(n=u.constanciasNoRetencion)&&n,constanciasNoRetencion1:null!=(i=u.constanciasNoRetencion1)&&i,constanciasNoRetencion2:null!=(l=u.constanciasNoRetencion2)&&l,pagoServicios:null!=(d=u.pagoServicios)&&d,tipoServicio:u.tipoServicio||null,otrosTipoServicio:u.otrosTipoServicio||null,facturaServicio:u.facturaServicio||null,institucionServicio:u.institucionServicio||null,correo:u.correo||null,observation:u.observation||null,savedBy:u.savedBy||null,commentsCount:g,hasOpenUrgentComment:null!=(c=u.hasOpenUrgentComment)&&c,isMemorandum:null!=(m=u.isMemorandum)&&m,memorandumCollaborators:u.memorandumCollaborators||[],rhPaymentStatus:u.rhPaymentStatus||null,rhPaymentOtherDetails:u.rhPaymentOtherDetails||null,rhPaymentDate:h,rhPaymentStartDate:f,rhPaymentEndDate:v,rhStatusLastUpdatedBy:u.rhStatusLastUpdatedBy||null,rhStatusLastUpdatedAt:u.rhStatusLastUpdatedAt?u.rhStatusLastUpdatedAt.toDate():void 0}}),a=await Promise.all(e);ee(a)}}catch(a){console.error("Error fetching documents from Firestore: ",a);let e="Error al buscar los memorandos. Intente de nuevo.";"permission-denied"===a.code?e="No tiene permisos para acceder a esta informaci\xf3n.":("failed-precondition"===a.code||a.message&&a.message.toLowerCase().includes("index"))&&(e="Error de consulta: Es posible que se requiera un \xedndice compuesto en Firestore que no existe. Por favor, revise la consola del navegador para ver un enlace que permita crear el \xedndice necesario.",d({title:"\xcdndice Requerido",description:"Es posible que necesite crear un \xedndice compuesto en Firestore. Revise la consola del navegador (F12) para m\xe1s detalles.",variant:"destructive",duration:1e4})),Y(e)}finally{Q(!1)}},eX=async()=>{let e=e$||[];if(0===e.length)return void d({title:"Sin Datos",description:"No hay datos para exportar. Realice una b\xfasqueda primero.",variant:"default"});eH(!0),d({title:"Exportando...",description:"Preparando datos para Excel, esto puede tardar unos segundos...",duration:1e4});let a=e.map(async e=>{let a="N/A";if(e.commentsCount&&e.commentsCount>0)try{let t=(0,C.rJ)(y.db,"Memorandum",e.solicitudId,"comments"),s=(0,C.P)(t,(0,C.My)("createdAt","asc")),r=await (0,C.GG)(s);r.empty||(a=r.docs.map(e=>{let a=e.data(),t=a.createdAt instanceof C.Dc?a.createdAt.toDate():new Date;return"".concat(a.userEmail," - ").concat((0,A.GP)(t,"dd/MM/yy HH:mm",{locale:M.es}),": ").concat(a.text)}).join("\n"))}catch(t){console.error("Error fetching comments for ".concat(e.solicitudId,": "),t),a="Error al cargar comentarios"}else 0===e.commentsCount&&(a="Sin comentarios");let t={caso_no_iniciado:"Caso no iniciado",pagado_efectivo:"Pagado Efectivo",proceso_deduccion:"En Proceso de Deducci\xf3n",otros:"Otros: ".concat(e.rhPaymentOtherDetails||"N/A")};return{"Estado Pago (RH)":e.isMemorandum?t[e.rhPaymentStatus||""]||"En Tr\xe1mite RH":"N/A","ID Solicitud":e.solicitudId,Fecha:e.examDate instanceof Date?(0,A.GP)(e.examDate,"yyyy-MM-dd HH:mm",{locale:M.es}):"N/A",NE:e.examNe,Monto:e.monto,"Moneda Monto":e.montoMoneda,Consignatario:e.consignatario||"N/A",Declaracion:e.declaracionNumero||"N/A",Referencia:e.examReference||"N/A","Guardado Por":e.savedBy||"N/A","Cantidad en Letras":e.cantidadEnLetras||"N/A","Destinatario Solicitud":e.examRecipient,"Unidad Recaudadora":e.unidadRecaudadora||"N/A","C\xf3digo 1":e.codigo1||"N/A","Codigo MUR":e.codigo2||"N/A",Banco:"ACCION POR CHEQUE/NO APLICA BANCO"===e.banco?"Acci\xf3n por Cheque / No Aplica Banco":e.banco||"N/A","Otro Banco":"Otros"===e.banco&&e.bancoOtros||"N/A","N\xfamero de Cuenta":"ACCION POR CHEQUE/NO APLICA BANCO"===e.banco?"N/A":e.numeroCuenta||"N/A","Moneda de la Cuenta":"ACCION POR CHEQUE/NO APLICA BANCO"===e.banco?"N/A":"Otros"===e.monedaCuenta?e.monedaCuentaOtros||"N/A":e.monedaCuenta||"N/A","Otra Moneda Cuenta":"Otros"===e.monedaCuenta&&e.monedaCuentaOtros||"N/A","Elaborar Cheque A":e.elaborarChequeA||"N/A","Elaborar Transferencia A":e.elaborarTransferenciaA||"N/A","Impuestos Pagados Cliente":e.impuestosPagadosCliente?"S\xed":"No","R/C (Imp. Pagados)":e.impuestosPagadosCliente&&e.impuestosPagadosRC||"N/A","T/B (Imp. Pagados)":e.impuestosPagadosCliente&&e.impuestosPagadosTB||"N/A","Cheque (Imp. Pagados)":e.impuestosPagadosCliente&&e.impuestosPagadosCheque||"N/A","Impuestos Pendientes Cliente":e.impuestosPendientesCliente?"S\xed":"No",Soporte:e.soporte?"S\xed":"No","Documentos Adjuntos":e.documentosAdjuntos?"S\xed":"No","Constancias de No Retenci\xf3n":e.constanciasNoRetencion?"S\xed":"No","Constancia 1%":e.constanciasNoRetencion?e.constanciasNoRetencion1?"S\xed":"No":"N/A","Constancia 2%":e.constanciasNoRetencion?e.constanciasNoRetencion2?"S\xed":"No":"N/A","Pago de Servicios":e.pagoServicios?"S\xed":"No","Tipo de Servicio":e.pagoServicios&&("OTROS"===e.tipoServicio?e.otrosTipoServicio:e.tipoServicio)||"N/A","Otro Tipo de Servicio":e.pagoServicios&&"OTROS"===e.tipoServicio&&e.otrosTipoServicio||"N/A","Factura Servicio":e.pagoServicios&&e.facturaServicio||"N/A","Instituci\xf3n Servicio":e.pagoServicios&&e.institucionServicio||"N/A","Correo Notificaci\xf3n":e.correo||"N/A",Observación:e.observation||"N/A","Usuario (De)":e.examManager,"Fecha de Guardado":e.savedAt instanceof Date?(0,A.GP)(e.savedAt,"yyyy-MM-dd HH:mm:ss",{locale:M.es}):"N/A",Comentarios:a,"Comentario Urgente Abierto":e.hasOpenUrgentComment?"S\xed":"No"}});try{let e=await Promise.all(a);(0,w.cY)(e,["Estado Pago (RH)","ID Solicitud","Fecha","NE","Monto","Moneda Monto","Consignatario","Declaracion","Referencia","Guardado Por","Cantidad en Letras","Destinatario Solicitud","Unidad Recaudadora","C\xf3digo 1","Codigo MUR","Banco","Otro Banco","N\xfamero de Cuenta","Moneda de la Cuenta","Otra Moneda Cuenta","Elaborar Cheque A","Elaborar Transferencia A","Impuestos Pagados Cliente","R/C (Imp. Pagados)","T/B (Imp. Pagados)","Cheque (Imp. Pagados)","Impuestos Pendientes Cliente","Soporte","Documentos Adjuntos","Constancias de No Retenci\xf3n","Constancia 1%","Constancia 2%","Pago de Servicios","Tipo de Servicio","Otro Tipo de Servicio","Factura Servicio","Instituci\xf3n Servicio","Correo Notificaci\xf3n","Observaci\xf3n","Usuario (De)","Fecha de Guardado","Comentarios","Comentario Urgente Abierto"],"Reporte_Memorandos_".concat(u,"_").concat(es.replace(/[^a-zA-Z0-9]/g,"_"),"_").concat(new Date().toISOString().split("T")[0],".xlsx")),d({title:"Exportaci\xf3n Completa",description:"El archivo Excel se ha descargado."})}catch(e){console.error("Error during data export preparation: ",e),d({title:"Error de Exportaci\xf3n",description:"No se pudo preparar los datos para exportar.",variant:"destructive"})}finally{eH(!1)}};if(!ea||a&&!K&&!eG)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center grid-bg",children:(0,s.jsx)(N.A,{className:"h-12 w-12 animate-spin text-white"})});if(eG&&eU)return(0,s.jsx)(i.G,{children:(0,s.jsx)("div",{className:"py-2 md:py-5 max-w-4xl mx-auto",children:(0,s.jsx)(ed,{solicitud:eU,onBackToList:()=>{eL(!1),e_(null)}})})});let eY=(null==e?void 0:e.role)==="admin"||(null==e?void 0:e.role)==="revisor"||(null==e?void 0:e.role)==="calificador"||(null==e?void 0:e.role)==="supervisor",eK=(null==e?void 0:e.role)==="autorevisor"||(null==e?void 0:e.role)==="autorevisor_plus"||(null==e?void 0:e.role)==="revisor";return(0,s.jsxs)(i.G,{children:[(0,s.jsx)("div",{className:"py-2 md:py-5",children:(0,s.jsxs)(m.Zp,{className:"w-full custom-shadow",children:[(0,s.jsxs)(m.aR,{children:[(0,s.jsx)(m.ZB,{className:"text-2xl font-semibold text-foreground",children:"Base de Datos de Memorandos (RH)"}),(0,s.jsx)(m.BT,{className:"text-muted-foreground",children:"Seleccione un tipo de b\xfasqueda e ingrese los criterios."})]}),(0,s.jsxs)(m.Wu,{children:[(0,s.jsxs)("form",{onSubmit:e=>eQ({event:e}),className:"space-y-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[(0,s.jsxs)(O.l6,{value:u,onValueChange:e=>{p(e),h(""),v(void 0),F(void 0),q(void 0),ee(null),Y(null),er("")},children:[(0,s.jsx)(O.bq,{className:"w-full sm:w-[200px] shrink-0",children:(0,s.jsx)(O.yv,{placeholder:"Tipo de b\xfasqueda"})}),(0,s.jsxs)(O.gC,{children:[(0,s.jsx)(O.eb,{value:"dateToday",children:"Por Fecha (Hoy)"}),(0,s.jsx)(O.eb,{value:"dateSpecific",children:"Por Fecha (Espec\xedfica)"}),eY&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.eb,{value:"dateCurrentMonth",children:"Por Mes (Actual)"}),(0,s.jsx)(O.eb,{value:"dateRange",children:"Por Rango de Fechas"})]})]})]}),(()=>{switch(u){case"dateToday":return(0,s.jsx)("p",{className:"text-sm text-muted-foreground flex-grow items-center flex h-10",children:"Se buscar\xe1n los memorandos de hoy."});case"dateCurrentMonth":return(0,s.jsx)("p",{className:"text-sm text-muted-foreground flex-grow items-center flex h-10",children:"Se buscar\xe1n los memorandos del mes actual."});case"dateSpecific":return(0,s.jsxs)(I.AM,{open:H,onOpenChange:$,children:[(0,s.jsx)(I.Wv,{asChild:!0,children:(0,s.jsxs)(l.$,{variant:"outline",className:(0,G.cn)("w-full justify-start text-left font-normal flex-grow",!f&&"text-muted-foreground"),children:[(0,s.jsx)(g.A,{className:"mr-2 h-4 w-4"}),f?(0,A.GP)(f,"PPP",{locale:M.es}):(0,s.jsx)("span",{children:"Seleccione una fecha"})]})}),(0,s.jsx)(I.hl,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(k.V,{mode:"single",selected:f,onSelect:e=>{v(e),$(!1)},initialFocus:!0,locale:M.es})})]});case"dateRange":return(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 flex-grow",children:[(0,s.jsxs)(I.AM,{open:z,onOpenChange:Z,children:[(0,s.jsx)(I.Wv,{asChild:!0,children:(0,s.jsxs)(l.$,{variant:"outline",className:(0,G.cn)("w-full justify-start text-left font-normal",!R&&"text-muted-foreground"),children:[(0,s.jsx)(g.A,{className:"mr-2 h-4 w-4"}),R?(0,A.GP)(R,"dd/MM/yy",{locale:M.es}):(0,s.jsx)("span",{children:"Fecha Inicio"})]})}),(0,s.jsx)(I.hl,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(k.V,{mode:"single",selected:R,onSelect:e=>{F(e),Z(!1)},initialFocus:!0,locale:M.es})})]}),(0,s.jsxs)(I.AM,{open:J,onOpenChange:V,children:[(0,s.jsx)(I.Wv,{asChild:!0,children:(0,s.jsxs)(l.$,{variant:"outline",className:(0,G.cn)("w-full justify-start text-left font-normal",!U&&"text-muted-foreground"),children:[(0,s.jsx)(g.A,{className:"mr-2 h-4 w-4"}),U?(0,A.GP)(U,"dd/MM/yy",{locale:M.es}):(0,s.jsx)("span",{children:"Fecha Fin"})]})}),(0,s.jsx)(I.hl,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(k.V,{mode:"single",selected:U,onSelect:e=>{q(e),V(!1)},initialFocus:!0,locale:M.es})})]})]});default:return null}})()]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-3",children:[(0,s.jsxs)(l.$,{type:"submit",className:"btn-primary w-full sm:w-auto",disabled:W,children:[(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4"})," ",W?"Buscando...":"Ejecutar B\xfasqueda"]}),(0,s.jsxs)(l.$,{type:"button",onClick:eX,variant:"outline",className:"w-full sm:w-auto",disabled:!e$||W||e$&&0===e$.length||eq,children:[eq?(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(b.A,{className:"mr-2 h-4 w-4"}),eq?"Exportando...":"Exportar Tabla"]})]})]}),W&&(0,s.jsxs)("div",{className:"flex justify-center items-center py-6",children:[(0,s.jsx)(N.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-3 text-muted-foreground",children:"Cargando memorandos..."})]}),X&&(0,s.jsx)("div",{className:"mt-4 p-4 bg-destructive/10 text-destructive border border-destructive/30 rounded-md text-center",children:X}),e$&&!W&&(0,s.jsx)(em,{solicitudes:e$,searchType:u,searchTerm:es,currentUserRole:null==e?void 0:e.role,onUpdateRHStatus:ez,onViewDetails:e=>{e_(e),eL(!0)},onOpenCommentsDialog:eZ,onDeleteSolicitud:a=>{if((null==e?void 0:e.role)!=="admin")return void d({title:"Error",description:"No tiene permisos para eliminar memorandos.",variant:"destructive"});eA(a),eC(!0)},onRefreshSearch:()=>eQ({preserveFilters:!0}),filterSolicitudIdInput:eS,setFilterSolicitudIdInput:eP,filterNEInput:eD,setFilterNEInput:eE,filterFechaSolicitudInput:eM,setFilterFechaSolicitudInput:eR,filterMontoInput:eO,setFilterMontoInput:eI,filterConsignatarioInput:ek,setFilterConsignatarioInput:eT,filterGuardadoPorInput:eB,setFilterGuardadoPorInput:eF}),!K&&!W&&!X&&!es&&(0,s.jsx)("div",{className:"mt-4 p-4 bg-blue-500/10 text-blue-700 border border-blue-500/30 rounded-md text-center",children:"Seleccione un tipo de b\xfasqueda e ingrese los criterios para ver resultados."}),K&&0===K.length&&!W&&!X&&es&&(0,s.jsx)("div",{className:"mt-4 p-4 bg-yellow-500/10 text-yellow-700 border border-yellow-500/30 rounded-md text-center",children:"No se encontraron memorandos para los criterios de b\xfasqueda ingresados."})]})]})}),(0,s.jsx)(B.lG,{open:eo,onOpenChange:eJ,children:(0,s.jsxs)(B.Cf,{className:"sm:max-w-2xl",children:[(0,s.jsxs)(B.c7,{children:[(0,s.jsxs)(B.L3,{children:["Comentarios para Memorando ID: ",ei]}),(0,s.jsx)(B.rr,{children:"Ver y a\xf1adir comentarios para este memorando."})]}),(0,s.jsxs)("div",{className:"py-4 space-y-4",children:[(0,s.jsx)("div",{className:"h-60 overflow-y-auto border p-2 rounded-md bg-muted/20 space-y-2",children:ef?(0,s.jsxs)("div",{className:"flex items-center justify-center h-full",children:[(0,s.jsx)(N.A,{className:"h-6 w-6 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2 text-sm text-muted-foreground",children:"Cargando comentarios..."})]}):0===eu.length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No hay comentarios a\xfan."}):eu.map(e=>(0,s.jsxs)("div",{className:"p-2 my-1 border-b bg-card shadow-sm rounded",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,s.jsx)("p",{className:"font-semibold text-primary text-xs",children:e.userEmail}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:(0,A.GP)(e.createdAt,"dd/MM/yyyy HH:mm",{locale:M.es})})]}),(0,s.jsx)("p",{className:"text-sm text-foreground whitespace-pre-wrap",children:e.text})]},e.id))}),(0,s.jsxs)("div",{children:[(0,s.jsx)(L.J,{htmlFor:"newCommentTextarea",className:"text-sm font-medium text-foreground",children:"Nuevo Comentario:"}),(0,s.jsx)(c.T,{id:"newCommentTextarea",value:ex,onChange:e=>eh(e.target.value),placeholder:"Escriba su comentario aqu\xed...",rows:3,className:"mt-1",disabled:eg})]}),eK&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,s.jsx)(T.S,{id:"urgentCommentCheckbox",checked:ej,onCheckedChange:e=>eb(!!e),disabled:eg}),(0,s.jsx)(L.J,{htmlFor:"urgentCommentCheckbox",className:"text-sm font-medium text-amber-700 dark:text-amber-500 cursor-pointer",children:"Indicar que la operaci\xf3n requiere atenci\xf3n especial"})]})]}),(0,s.jsxs)(B.Es,{children:[(0,s.jsx)(l.$,{variant:"outline",onClick:eJ,disabled:eg,children:"Salir"}),(0,s.jsxs)(l.$,{onClick:eV,disabled:eg||!ex.trim(),children:[eg&&(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4 animate-spin"}),eg?"Publicando...":"Publicar Comentario"]})]})]})}),(0,s.jsx)(B.lG,{open:ey,onOpenChange:eC,children:(0,s.jsxs)(B.Cf,{className:"sm:max-w-md",children:[(0,s.jsx)(B.c7,{children:(0,s.jsx)(B.L3,{children:"Confirmar Eliminaci\xf3n"})}),(0,s.jsx)(B.rr,{children:"Estas seguro de realizar esta opci\xf3n. Operacion de borrar es permanente. El memorando ser\xe1 archivado."}),(0,s.jsxs)(B.Es,{className:"mt-4",children:[(0,s.jsx)(l.$,{variant:"outline",onClick:()=>{eC(!1),eA(null)},children:"Cancelar"}),(0,s.jsx)(l.$,{variant:"destructive",onClick:eW,children:"Aceptar"})]})]})})]})}},73457:(e,a,t)=>{"use strict";t.d(a,{S:()=>l});var s=t(95155),r=t(12115),o=t(38162),n=t(72251),i=t(64269);let l=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(o.bL,{ref:a,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,s.jsx)(o.C1,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})})});l.displayName=o.bL.displayName},76444:(e,a,t)=>{"use strict";t.d(a,{J:()=>d});var s=t(95155),r=t(12115),o=t(10489),n=t(83101),i=t(64269);let l=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(o.b,{ref:a,className:(0,i.cn)(l(),t),...r})});d.displayName=o.b.displayName}},e=>{e.O(0,[2992,7138,3524,4865,2130,2619,3326,5282,9351,6505,4437,5479,5171,5669,8441,1255,7358],()=>e(e.s=29129)),_N_E=e.O()}]);