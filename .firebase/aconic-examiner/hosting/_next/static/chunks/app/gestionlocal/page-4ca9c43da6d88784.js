(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8561],{5225:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(14294).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},5351:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(14294).A)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},9691:(e,a,t)=>{"use strict";t.d(a,{j:()=>l});var s=t(95155),r=t(51834),i=t(17037),n=t(59321);function l(e){let{isOpen:a,onClose:t,worksheet:l}=e;return a&&l?(0,s.jsx)(r.lG,{open:a,onOpenChange:t,children:(0,s.jsx)(r.Cf,{className:"max-w-4xl p-0 h-[90vh] flex flex-col",children:(0,s.jsx)(i.F,{className:"flex-grow",children:(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)(n.v,{worksheet:l,onClose:t})})})})}):null}},10489:(e,a,t)=>{"use strict";t.d(a,{b:()=>l});var s=t(12115),r=t(97602),i=t(95155),n=s.forwardRef((e,a)=>(0,i.jsx)(r.sG.label,{...e,ref:a,onMouseDown:a=>{var t;a.target.closest("button, input, select, textarea")||(null==(t=e.onMouseDown)||t.call(e,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));n.displayName="Label";var l=n},20146:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(14294).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},27500:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(14294).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},28127:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(14294).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},31994:(e,a,t)=>{Promise.resolve().then(t.bind(t,36842))},32383:()=>{},36842:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>J});var s=t(95155),r=t(12115),i=t(54901),n=t(14585),l=t(19708),o=t(35434),d=t(86948),c=t(3998),u=t(92033),h=t(87455),m=t(65142),p=t(87270),x=t(73457),f=t(6259),j=t(58772),v=t(53489),g=t(82274),y=t(20146),N=t(36654),w=t(5351),k=t(27500),b=t(88964),A=t(54550);let C=(0,t(14294).A)("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);var E=t(5282),S=t(11647),M=t(11186),D=t(89522),P=t(15894),R=t(51834),z=t(98053),O=t(4246),L=t(76444),_=t(44846);function $(e){var a,t,o;let{worksheets:d,setWorksheets:h,selectedRows:$,setSelectedRows:I,onAssign:T,onComment:B,onView:H}=e,{toast:G}=(0,P.dj)(),{user:F}=(0,i.A)(),[V,U]=(0,r.useState)(1),[q,Z]=(0,r.useState)(30),[J,W]=(0,r.useState)({isOpen:!1,type:"aforador"}),[Q,X]=(0,r.useState)(!1),K=(0,r.useRef)(null),[Y,ee]=(0,r.useState)(!1),[ea,et]=(0,r.useState)(!1),[es,er]=(0,r.useState)({isOpen:!1,success:[],skipped:[]}),ei=(0,r.useMemo)(()=>ea?d.filter(e=>{let a=e.aforo;return!a||"Tr\xe1mite Completo"!==a.digitadorStatus}):d,[d,ea]),en=Math.ceil(ei.length/q),el=(0,r.useMemo)(()=>{let e=(V-1)*q;return ei.slice(e,e+q)},[ei,V,q]),eo=async()=>{if(!F||!F.displayName||0===$.length)return;X(!0);let e=(0,l.wP)(n.db),a=[],t=[];for(let s of $){let r=d.find(e=>e.id===s),i=null==r?void 0:r.aforo;if(r&&i&&i.declaracionAduanera){let t=(0,l.H9)(n.db,"worksheets",s,"aforo","metadata");e.set(t,{digitadorStatus:"Tr\xe1mite Completo",digitadorStatusLastUpdate:{by:F.displayName,at:l.Dc.now()}},{merge:!0}),a.push(r.ne)}else r&&t.push(r.ne)}try{a.length>0&&(await e.commit(),h(e=>e.map(e=>{if(a.includes(e.ne)){let a={...e.aforo,digitadorStatus:"Tr\xe1mite Completo"};return{...e,aforo:a}}return e}))),er({isOpen:!0,success:a,skipped:t}),I([])}catch(e){G({title:"Error",description:"No se pudo completar la acci\xf3n masiva.",variant:"destructive"})}finally{X(!1)}},ed=async(e,a)=>{if(!F||!F.displayName||0===$.length)return;if("digitadorStatus"===e&&"Tr\xe1mite Completo"===a){ee(!0),W({isOpen:!1,type:"aforador"});return}let t=(0,l.wP)(n.db);$.forEach(s=>{let r=(0,l.H9)(n.db,"worksheets",s,"aforo","metadata");t.set(r,{[e]:a,["".concat(e,"LastUpdate")]:{by:F.displayName,at:l.Dc.now()}},{merge:!0})});try{await t.commit(),G({title:"Actualizaci\xf3n Masiva Exitosa",description:"".concat($.length," registros actualizados.")}),h(t=>t.map(t=>{if($.includes(t.id)){let s={...t.aforo,[e]:a};return{...t,aforo:s}}return t})),I([])}catch(e){console.error("Bulk update error:",e),G({title:"Error",description:"No se pudo completar la acci\xf3n masiva.",variant:"destructive"})}W({isOpen:!1,type:"aforador"})},ec=async(e,a,t)=>{if(!F||!F.displayName)return void G({title:"Error",description:"Debe estar autenticado.",variant:"destructive"});if("digitador"===t&&"Tr\xe1mite Completo"===a)return void W({isOpen:!0,worksheet:d.find(a=>a.id===e),type:"digitador"});let s=(0,l.H9)(n.db,"worksheets",e,"aforo","metadata");try{let r="aforador"===t?"aforadorStatus":"digitadorStatus",i={[r]:a,["".concat(r,"LastUpdate")]:{by:F.displayName,at:l.Dc.now()}};await (0,l.wP)(n.db).set(s,i,{merge:!0}).commit(),G({title:"Estado Actualizado",description:"El estado del ".concat(t,' ha sido actualizado a "').concat(a,'".')}),h(t=>t.map(t=>{if(t.id===e){let e={...t.aforo,[r]:a};return{...t,aforo:e}}return t})),W({isOpen:!1,type:"aforador"})}catch(e){console.error(e),G({title:"Error",description:"No se pudo actualizar el estado.",variant:"destructive"})}},eu=async e=>{if(!F||!F.displayName)return;let a=(0,l.H9)(n.db,"worksheets",e,"aforo","metadata");try{let t={revisorStatus:"Revalidaci\xf3n Solicitada",revisorStatusLastUpdate:{by:F.displayName,at:l.Dc.now()}};await (0,l.wP)(n.db).set(a,t,{merge:!0}).commit(),G({title:"Solicitud Enviada",description:"Se ha solicitado la revalidaci\xf3n al revisor."}),h(a=>a.map(a=>{if(a.id===e){let e={...a.aforo,revisorStatus:"Revalidaci\xf3n Solicitada"};return{...a,aforo:e}}return a}))}catch(e){console.error(e),G({title:"Error",description:"No se pudo solicitar la revalidaci\xf3n.",variant:"destructive"})}},eh=async(e,a)=>{if(!F||!F.displayName||!a||""===a.trim())return;let t=(0,l.H9)(n.db,"worksheets",e,"aforo","metadata"),s=(0,l.wP)(n.db);try{s.set(t,{declaracionAduanera:a,digitadorStatus:"Tr\xe1mite Completo",digitadorStatusLastUpdate:{by:F.displayName,at:l.Dc.now()}},{merge:!0}),await s.commit(),G({title:"Declaraci\xf3n y Estado Guardados",description:"Declaraci\xf3n guardada y estado actualizado a 'Tr\xe1mite Completo'."}),h(t=>t.map(t=>{if(t.id===e){let e={...t.aforo,declaracionAduanera:a,digitadorStatus:"Tr\xe1mite Completo"};return{...t,aforo:e}}return t}))}catch(e){console.error(e),G({title:"Error",description:"No se pudo guardar el n\xfamero de declaraci\xf3n.",variant:"destructive"})}},em=function(){let e,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e=a&&$.length>0?$.map(e=>({NE:e,"Declaracion Aduanera":""})):[{NE:"","Declaracion Aduanera":""}];let t=O.Wp.json_to_sheet(e),s=O.Wp.book_new();O.Wp.book_append_sheet(s,t,"Declaraciones"),O._h(s,"plantilla_declaraciones.xlsx")},ep=async function(e){var a;let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=null==(a=e.target.files)?void 0:a[0];if(!s)return;X(!0),G({title:"Importando...",description:"Procesando el archivo Excel."});let r=new FileReader;r.onload=async e=>{try{var a;let s=new Uint8Array(null==(a=e.target)?void 0:a.result),r=O.LF(s,{type:"array"}),i=r.SheetNames[0],o=r.Sheets[i],d=O.Wp.sheet_to_json(o),c=(0,l.wP)(n.db),u=0,m=new Set(t?$:d.map(e=>String(e.NE).trim().toUpperCase()));for(let e of d){let a=String(e.NE).trim().toUpperCase(),s=String(e["Declaracion Aduanera"]||"").trim();if(a&&s&&m.has(a)){let e=(0,l.H9)(n.db,"worksheets",a,"aforo","metadata"),r={declaracionAduanera:s};t&&(r.digitadorStatus="Tr\xe1mite Completo",r.digitadorStatusLastUpdate={by:null==F?void 0:F.displayName,at:l.Dc.now()}),c.set(e,r,{merge:!0}),u++}}u>0?(await c.commit(),h(e=>e.map(e=>{let a=d.find(a=>String(a.NE).trim().toUpperCase()===e.id);if(a&&m.has(e.id)){let s=String(a["Declaracion Aduanera"]||"").trim(),r={...e.aforo,declaracionAduanera:s};return t&&(r.digitadorStatus="Tr\xe1mite Completo"),{...e,aforo:r}}return e})),G({title:"Importaci\xf3n Completa",description:"".concat(u," declaraciones han sido actualizadas.")}),t&&(ee(!1),I([]))):G({title:"Sin Cambios",description:"No se encontraron NEs coincidentes en el archivo para actualizar."})}catch(e){G({title:"Error de Importaci\xf3n",description:e.message||"Hubo un problema al leer el archivo Excel.",variant:"destructive"})}finally{X(!1),K.current&&(K.current.value="")}},r.readAsArrayBuffer(s)},ex=async()=>{if(!F||!F.displayName||0===$.length)return;setIsLoading(!0);let e=(0,l.wP)(n.db);for(let a of $){let t=(0,l.H9)(n.db,"worksheets",a);e.update(t,{entregadoAforoAt:l.Dc.now()})}try{await e.commit(),G({title:"Acuse Masivo Exitoso",description:"".concat($.length," caso(s) han sido actualizados.")}),h(e=>e.map(e=>$.includes(e.id)?{...e,entregadoAforoAt:l.Dc.now()}:e)),I([])}catch(e){console.error("Error with bulk acknowledge:",e),G({title:"Error",description:"No se pudo registrar el acuse masivo.",variant:"destructive"})}finally{setIsLoading(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 p-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,s.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>{var e;return null==(e=K.current)?void 0:e.click()},disabled:Q,children:[Q?(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4"})," Importar Declaraciones"]}),(0,s.jsxs)(c.$,{onClick:()=>em(!1),variant:"outline",size:"sm",children:[(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4"})," Plantilla"]}),(0,s.jsx)("input",{type:"file",ref:K,onChange:e=>ep(e,!1),className:"hidden",accept:".xlsx, .xls"}),(0,s.jsxs)(c.$,{variant:"secondary",size:"sm",onClick:eo,disabled:0===$.length||Q,children:["Completar Digitaci\xf3n (",$.length,")"]}),(0,s.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>W({isOpen:!0,type:"bulk-aforador"}),disabled:0===$.length,children:["Asignar Estatus Aforador (",$.length,")"]}),(0,s.jsxs)(c.$,{variant:"outline",size:"sm",onClick:ex,disabled:0===$.length||isLoading,children:[(0,s.jsx)(g.A,{className:"mr-2 h-4 w-4"})," Enviar Acuse (",$.length,")"]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(_.d,{id:"pending-filter",checked:ea,onCheckedChange:et}),(0,s.jsx)(L.J,{htmlFor:"pending-filter",children:"Solo Pendientes"})]})]}),(0,s.jsx)("div",{className:"overflow-x-auto table-container rounded-lg border",children:(0,s.jsxs)(p.XI,{children:[(0,s.jsx)(p.A0,{children:(0,s.jsxs)(p.Hj,{children:[(0,s.jsx)(p.nd,{className:"w-12",children:(0,s.jsx)(x.S,{checked:$.length>0&&$.length===el.length,onCheckedChange:()=>{$.length===el.length?I([]):I(el.map(e=>e.id))}})}),(0,s.jsx)(p.nd,{children:"Acciones"}),(0,s.jsx)(p.nd,{children:"Insignias"}),(0,s.jsx)(p.nd,{children:"NE"}),(0,s.jsx)(p.nd,{children:"Consignatario"}),(0,s.jsx)(p.nd,{children:"Modelo (Patr\xf3n)"}),(0,s.jsx)(p.nd,{children:"Fecha Creaci\xf3n"}),(0,s.jsx)(p.nd,{children:"Aforador Asignado"}),(0,s.jsx)(p.nd,{children:"Estado Aforador"}),(0,s.jsx)(p.nd,{children:"Revisor Asignado"}),(0,s.jsx)(p.nd,{children:"Estado Revisor"}),(0,s.jsx)(p.nd,{children:"Digitador Asignado"}),(0,s.jsx)(p.nd,{children:"Estado Digitador"}),(0,s.jsx)(p.nd,{children:"Declaraci\xf3n Aduanera"})]})}),(0,s.jsx)(p.BF,{children:el.map(e=>{let a=e.aforo;return(0,s.jsxs)(p.Hj,{"data-state":$.includes(e.id)?"selected":void 0,children:[(0,s.jsx)(p.nA,{children:(0,s.jsx)(x.S,{checked:$.includes(e.id),onCheckedChange:()=>{var a;return a=e.id,void I(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])}})}),(0,s.jsx)(p.nA,{children:(0,s.jsxs)(f.rI,{children:[(0,s.jsx)(f.ty,{asChild:!0,children:(0,s.jsx)(c.$,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,s.jsx)(y.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(f.SQ,{align:"end",children:[(0,s.jsxs)(f._2,{onClick:()=>H(e),children:[(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4"})," Ver Hoja de Trabajo"]}),(0,s.jsxs)(f._2,{onClick:()=>T(e,"aforador"),children:[(0,s.jsx)(w.A,{className:"mr-2 h-4 w-4"})," Asignar Aforador"]}),(0,s.jsxs)(f._2,{onClick:()=>T(e,"revisor"),children:[(0,s.jsx)(w.A,{className:"mr-2 h-4 w-4"})," Asignar Revisor"]}),(0,s.jsxs)(f._2,{onClick:()=>T(e,"digitador"),children:[(0,s.jsx)(w.A,{className:"mr-2 h-4 w-4"})," Asignar Digitador"]}),(0,s.jsxs)(f._2,{onClick:()=>B(e),children:[(0,s.jsx)(k.A,{className:"mr-2 h-4 w-4"})," Ver/A\xf1adir Comentarios"]})]})]})}),(0,s.jsx)(p.nA,{children:(0,s.jsx)(D.V,{caseData:{...e,...a}})}),(0,s.jsx)(p.nA,{children:e.ne}),(0,s.jsx)(p.nA,{children:e.consignee}),(0,s.jsx)(p.nA,{children:e.patternRegime||"N/A"}),(0,s.jsx)(p.nA,{children:(e=>{if(!e)return"N/A";let a=e.toDate?e.toDate():new Date(e);return(0,E.GP)(a,"dd/MM/yyyy")})(e.createdAt)}),(0,s.jsx)(p.nA,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.E,{variant:"secondary",children:(null==a?void 0:a.aforador)||"N/A"}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>T(e,"aforador"),children:(0,s.jsx)(b.A,{className:"h-3 w-3"})})]})}),(0,s.jsx)(p.nA,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.E,{variant:(null==a?void 0:a.aforadorStatus)==="En revisi\xf3n"?"default":"outline",children:(null==a?void 0:a.aforadorStatus)||"Pendiente"}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>W({isOpen:!0,worksheet:e,type:"aforador"}),children:(0,s.jsx)(b.A,{className:"h-3 w-3"})})]})}),(0,s.jsx)(p.nA,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.E,{variant:"secondary",children:(null==a?void 0:a.revisor)||"N/A"}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>T(e,"revisor"),children:(0,s.jsx)(b.A,{className:"h-3 w-3"})})]})}),(0,s.jsx)(p.nA,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.E,{variant:(null==a?void 0:a.revisorStatus)==="Aprobado"?"default":(null==a?void 0:a.revisorStatus)==="Rechazado"?"destructive":"outline",children:(null==a?void 0:a.revisorStatus)||"Pendiente"}),(null==a?void 0:a.revisorStatus)==="Rechazado"&&(0,s.jsxs)(c.$,{variant:"secondary",size:"sm",className:"h-6 px-2 text-xs",onClick:()=>eu(e.id),children:[(0,s.jsx)(A.A,{className:"mr-1 h-3 w-3"})," Revalidar"]})]})}),(0,s.jsx)(p.nA,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.E,{variant:"secondary",children:(null==a?void 0:a.digitador)||"N/A"}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>T(e,"digitador"),children:(0,s.jsx)(b.A,{className:"h-3 w-3"})})]})}),(0,s.jsx)(p.nA,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.E,{variant:(null==a?void 0:a.digitadorStatus)==="Tr\xe1mite Completo"?"default":"outline",children:(null==a?void 0:a.digitadorStatus)||"Pendiente"}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>W({isOpen:!0,worksheet:e,type:"digitador"}),children:(0,s.jsx)(b.A,{className:"h-3 w-3"})})]})}),(0,s.jsx)(p.nA,{children:(0,s.jsx)(m.p,{defaultValue:(null==a?void 0:a.declaracionAduanera)||"",onBlur:a=>eh(e.id,a.target.value),className:"h-8 text-xs",placeholder:"No. Declaraci\xf3n"})})]},e.id)})})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between space-x-2 py-4",children:[(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[$.length," de ",ei.length," fila(s) seleccionadas."]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm",children:"Filas por p\xe1gina:"}),(0,s.jsxs)(M.l6,{value:String(q),onValueChange:e=>{"all"===e?Z(ei.length):Z(Number(e)),U(1)},children:[(0,s.jsx)(M.bq,{className:"w-24 h-8",children:(0,s.jsx)(M.yv,{})}),(0,s.jsxs)(M.gC,{children:[(0,s.jsx)(M.eb,{value:"30",children:"30"}),(0,s.jsx)(M.eb,{value:"40",children:"40"}),(0,s.jsx)(M.eb,{value:"50",children:"50"}),(0,s.jsx)(M.eb,{value:"all",children:"Todos"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("span",{className:"text-sm",children:["P\xe1gina ",V," de ",en]}),(0,s.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>U(e=>Math.max(e-1,1)),disabled:1===V,children:"Anterior"}),(0,s.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>U(e=>Math.min(e+1,en)),disabled:V===en,children:"Siguiente"})]})]}),(0,s.jsx)(R.lG,{open:J.isOpen,onOpenChange:()=>W({isOpen:!1,type:"aforador"}),children:(0,s.jsxs)(R.Cf,{children:[(0,s.jsxs)(R.c7,{children:[(0,s.jsxs)(R.L3,{children:["Cambiar Estado de ",(null==(a=J.type)?void 0:a.includes("aforador"))?"Aforador":"Digitador"," ",(null==(t=J.type)?void 0:t.includes("bulk"))?"Masivo":""]}),(0,s.jsx)(R.rr,{children:J.worksheet?"Seleccione el nuevo estado para el NE: ".concat(J.worksheet.ne):"Seleccione el estatus a aplicar a los ".concat($.length," casos seleccionados.")})]}),(0,s.jsxs)(M.l6,{onValueChange:e=>{J.worksheet?ec(J.worksheet.id,e,J.type):J.type&&ed(J.type.split("-")[1],e)},children:[(0,s.jsx)(M.bq,{children:(0,s.jsx)(M.yv,{placeholder:"Seleccionar estado..."})}),(0,s.jsx)(M.gC,{children:(null==(o=J.type)?void 0:o.includes("aforador"))?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M.eb,{value:"Pendiente",children:"Pendiente"}),(0,s.jsx)(M.eb,{value:"En proceso",children:"En proceso"}),(0,s.jsx)(M.eb,{value:"Incompleto",children:"Incompleto"}),(0,s.jsx)(M.eb,{value:"En revisi\xf3n",children:"En revisi\xf3n"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M.eb,{value:"Pendiente",children:"Pendiente"}),(0,s.jsx)(M.eb,{value:"En Proceso",children:"En Proceso"}),(0,s.jsx)(M.eb,{value:"Almacenado",children:"Almacenado"}),(0,s.jsx)(M.eb,{value:"Tr\xe1mite Completo",children:"Tr\xe1mite Completo"})]})})]}),(0,s.jsx)(R.Es,{children:(0,s.jsx)(c.$,{variant:"outline",onClick:()=>W({isOpen:!1,type:"aforador"}),children:"Cancelar"})})]})}),(0,s.jsx)(R.lG,{open:Y,onOpenChange:ee,children:(0,s.jsxs)(R.Cf,{children:[(0,s.jsxs)(R.c7,{children:[(0,s.jsx)(R.L3,{children:"Completar Tr\xe1mite Masivo"}),(0,s.jsxs)(R.rr,{children:["Descargue la plantilla, llene los n\xfameros de declaraci\xf3n para los ",$.length," casos seleccionados y s\xfabala para finalizar."]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-4 py-4",children:[(0,s.jsxs)(c.$,{onClick:()=>em(!0),variant:"secondary",children:[(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4"})," Descargar Plantilla con NEs"]}),(0,s.jsxs)(c.$,{onClick:()=>{var e;return null==(e=K.current)?void 0:e.click()},disabled:Q,children:[Q?(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(C,{className:"mr-2 h-4 w-4"}),"Subir Plantilla Completada"]}),(0,s.jsx)("input",{type:"file",ref:K,onChange:e=>ep(e,!0),className:"hidden",accept:".xlsx, .xls"})]}),(0,s.jsx)(R.Es,{children:(0,s.jsx)(c.$,{variant:"outline",onClick:()=>ee(!1),children:"Cancelar"})})]})}),(0,s.jsx)(z.Lt,{open:es.isOpen,onOpenChange:e=>er(a=>({...a,isOpen:e})),children:(0,s.jsxs)(z.EO,{children:[(0,s.jsxs)(z.wd,{children:[(0,s.jsx)(R.L3,{children:"Resultado de la Operaci\xf3n Masiva"}),(0,s.jsx)(z.$v,{children:(0,s.jsxs)("div",{className:"space-y-4 max-h-60 overflow-y-auto",children:[es.success.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-green-600",children:"Casos completados exitosamente:"}),(0,s.jsx)("ul",{className:"list-disc list-inside text-sm text-muted-foreground",children:es.success.map(e=>(0,s.jsx)("li",{children:e},e))})]}),es.skipped.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold text-amber-600",children:"Casos omitidos (sin declaraci\xf3n aduanera):"}),(0,s.jsx)("ul",{className:"list-disc list-inside text-sm text-muted-foreground",children:es.skipped.map(e=>(0,s.jsx)("li",{children:e},e))})]})]})})]}),(0,s.jsx)(z.ck,{children:(0,s.jsx)(z.Rx,{onClick:()=>er({isOpen:!1,success:[],skipped:[]}),children:"Entendido"})})]})})]})}var I=t(63817),T=t(72251),B=t(64269);function H(e){let{isOpen:a,onClose:t,worksheet:o,type:d,selectedWorksheetIds:h,setWorksheets:m}=e,{user:p}=(0,i.A)(),{toast:x}=(0,P.dj)(),[f,j]=(0,r.useState)(null),[v,g]=(0,r.useState)([]),[y,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{a&&(async()=>{let e;if(0===(e=d.includes("aforador")||d.includes("digitador")?["aforador","supervisor","coordinadora"]:d.includes("revisor")?["agente aduanero"]:[]).length)return g([]);let a=(0,l.P)((0,l.rJ)(n.db,"users"),(0,l._M)("role","in",e));g((await (0,l.GG)(a)).docs.map(e=>({uid:e.id,...e.data()})))})()},[a,d]);let w=async()=>{let e;if(!f||!(null==p?void 0:p.displayName))return;N(!0);let a=(0,l.wP)(n.db);e=d.includes("aforador")?"aforador":d.includes("revisor")?"revisor":"digitador";let s=l.Dc.now(),r=f.displayName||f.email,i=o?[o.id]:h||[];if(0===i.length){x({title:"Error",description:"No se seleccionaron hojas de trabajo.",variant:"destructive"}),N(!1);return}i.forEach(t=>{let i=(0,l.H9)(n.db,"worksheets/".concat(t,"/aforo/metadata")),o={[e]:r,["".concat(e,"AssignedAt")]:s,["".concat(e,"AssignedBy")]:p.displayName};a.set(i,o,{merge:!0})});try{await a.commit(),x({title:"Asignaci\xf3n Exitosa",description:"".concat(r," ha sido asignado como ").concat(e," a ").concat(i.length," hoja(s) de trabajo.")}),m&&m(a=>a.map(a=>{if(i.includes(a.id)){let t={...a.aforo,[e]:r};return{...a,aforo:t}}return a})),t()}catch(e){console.error(e),x({title:"Error",description:"No se pudo completar la asignaci\xf3n.",variant:"destructive"})}finally{N(!1)}},k="Asignar ".concat(d.includes("aforador")?"Aforador":d.includes("revisor")?"Revisor":"Digitador").concat(d.includes("bulk")?" Masivamente":""),b=o?"Seleccione un usuario para el NE: ".concat(o.ne):"Seleccione un usuario para ".concat((null==h?void 0:h.length)||0," hoja(s) de trabajo.");return(0,s.jsx)(R.lG,{open:a,onOpenChange:t,children:(0,s.jsxs)(R.Cf,{className:"sm:max-w-md",children:[(0,s.jsxs)(R.c7,{children:[(0,s.jsx)(R.L3,{children:k}),(0,s.jsx)(R.rr,{children:b})]}),(0,s.jsxs)(I.uB,{className:"rounded-lg border shadow-sm",children:[(0,s.jsx)(I.G7,{placeholder:"Buscar usuario..."}),(0,s.jsxs)(I.oI,{children:[(0,s.jsx)(I.xL,{children:"No se encontraron usuarios."}),(0,s.jsx)(I.L$,{children:v.map(e=>(0,s.jsxs)(I.h_,{value:e.displayName||e.email||"",onSelect:()=>j(e),children:[(0,s.jsx)(T.A,{className:(0,B.cn)("mr-2 h-4 w-4",(null==f?void 0:f.uid)===e.uid?"opacity-100":"opacity-0")}),e.displayName||e.email]},e.uid))})]})]}),(0,s.jsxs)(R.Es,{children:[(0,s.jsx)(c.$,{variant:"outline",onClick:t,children:"Cancelar"}),(0,s.jsxs)(c.$,{onClick:w,disabled:!f||y,children:[y&&(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirmar Asignaci\xf3n"]})]})]})})}var G=t(31120),F=t(94979),V=t(17037),U=t(80160);function q(e){let{isOpen:a,onClose:t,worksheet:o}=e,{user:d}=(0,i.A)(),{toast:h}=(0,P.dj)(),[m,p]=(0,r.useState)([]),[x,f]=(0,r.useState)(""),[j,v]=(0,r.useState)(!0),[g,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!a)return;v(!0);let e=(0,l.rJ)(n.db,"worksheets/".concat(o.id,"/aforoComments")),t=(0,l.P)(e,(0,l.My)("createdAt","desc")),s=(0,l.aQ)(t,e=>{p(e.docs.map(e=>({id:e.id,...e.data()}))),v(!1)},e=>{console.error("Error fetching comments:",e),v(!1)});return()=>s()},[a,o.id]);let N=async()=>{if(!x.trim()||!(null==d?void 0:d.displayName))return;y(!0);let e=(0,l.rJ)(n.db,"worksheets/".concat(o.id,"/aforoComments"));try{await (0,l.gS)(e,{text:x.trim(),author:d.displayName,createdAt:(0,l.O5)()}),f("")}catch(e){h({title:"Error",description:"No se pudo guardar el comentario.",variant:"destructive"})}finally{y(!1)}};return(0,s.jsx)(R.lG,{open:a,onOpenChange:t,children:(0,s.jsxs)(R.Cf,{className:"max-w-lg",children:[(0,s.jsxs)(R.c7,{children:[(0,s.jsx)(R.L3,{children:"Comentarios de Aforo"}),(0,s.jsxs)(R.rr,{children:["Comentarios para la hoja de trabajo: ",o.ne]})]}),(0,s.jsx)(V.F,{className:"h-72 my-4",children:(0,s.jsxs)("div",{className:"space-y-4 pr-6",children:[j&&(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(u.A,{className:"h-6 w-6 animate-spin"})}),!j&&0===m.length&&(0,s.jsx)("p",{className:"text-center text-muted-foreground",children:"No hay comentarios."}),m.map(e=>{var a;return(0,s.jsxs)("div",{className:"p-3 border rounded-lg bg-secondary/50",children:[(0,s.jsx)("p",{className:"text-sm",children:e.text}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground text-right mt-2",children:["- ",e.author,", ",(a=e.createdAt)?(0,E.GP)(a.toDate(),"dd/MM/yy hh:mm a",{locale:U.es}):"Justo ahora"]})]},e.id)})]})}),(0,s.jsxs)("div",{className:"space-y-2 pt-4 border-t",children:[(0,s.jsx)(G.T,{placeholder:"A\xf1adir un nuevo comentario...",value:x,onChange:e=>f(e.target.value),disabled:g}),(0,s.jsxs)(c.$,{onClick:N,disabled:g||!x.trim(),className:"w-full",children:[g?(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(F.A,{className:"mr-2 h-4 w-4"}),"Enviar"]})]}),(0,s.jsx)(R.Es,{children:(0,s.jsx)(c.$,{variant:"outline",onClick:t,children:"Cerrar"})})]})})}var Z=t(9691);function J(){let{user:e,loading:a}=(0,i.A)(),{toast:t}=(0,P.dj)(),[p,x]=(0,r.useState)([]),[f,j]=(0,r.useState)(!0),[v,g]=(0,r.useState)(""),[y,N]=(0,r.useState)(""),[w,k]=(0,r.useState)(null),[b,A]=(0,r.useState)(null),[C,E]=(0,r.useState)(null),[S,M]=(0,r.useState)([]),D=(0,r.useCallback)(()=>{if(!e)return;j(!0);let a=(0,l.P)((0,l.rJ)(n.db,"worksheets"),(0,l._M)("worksheetType","in",["hoja_de_trabajo",null]),(0,l.My)("createdAt","desc"));return(0,l.aQ)(a,async e=>{let a=e.docs.map(async e=>{let a={id:e.id,...e.data()},t=(0,l.H9)(n.db,"worksheets/".concat(e.id,"/aforo/metadata")),s=await (0,l.x7)(t);return s.exists()&&(a.aforo=s.data()),a});x(await Promise.all(a)),j(!1)},e=>{console.error("Error fetching worksheets:",e),t({title:"Error",description:"No se pudieron cargar las hojas de trabajo.",variant:"destructive"}),j(!1)})},[e,t]);(0,r.useEffect)(()=>{let e=D();return()=>{e&&e()}},[D]);let R=(0,r.useMemo)(()=>p.filter(e=>{let a=!v||e.ne.toLowerCase().includes(v.toLowerCase()),t=!y||e.consignee.toLowerCase().includes(y.toLowerCase());return a&&t}),[p,v,y]);return(0,s.jsxs)(o.G,{children:[(0,s.jsx)("div",{className:"py-2 md:py-5",children:(0,s.jsxs)(d.Zp,{className:"w-full max-w-screen-2xl mx-auto custom-shadow",children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsx)(d.ZB,{children:"Gesti\xf3n Local de Aforo"}),(0,s.jsx)(d.BT,{children:"Nueva vista optimizada para la asignaci\xf3n y seguimiento de aforos sobre hojas de trabajo."}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 pt-4 border-t",children:[(0,s.jsx)(m.p,{placeholder:"Filtrar por NE...",value:v,onChange:e=>g(e.target.value),className:"max-w-xs"}),(0,s.jsx)(m.p,{placeholder:"Filtrar por Consignatario...",value:y,onChange:e=>N(e.target.value),className:"max-w-xs"}),(0,s.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,s.jsxs)(c.$,{variant:"outline",onClick:()=>k({isOpen:!0,type:"bulk-aforador"}),disabled:0===S.length,children:["Asignar Aforador (",S.length,")"]}),(0,s.jsxs)(c.$,{variant:"outline",onClick:()=>k({isOpen:!0,type:"bulk-revisor"}),disabled:0===S.length,children:["Asignar Revisor (",S.length,")"]}),(0,s.jsxs)(c.$,{variant:"outline",onClick:()=>k({isOpen:!0,type:"bulk-digitador"}),disabled:0===S.length,children:["Asignar Digitador (",S.length,")"]})]})]})]}),(0,s.jsx)(d.Wu,{children:f?(0,s.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,s.jsx)(u.A,{className:"h-8 w-8 animate-spin"})}):0===R.length?(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsx)(h.A,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,s.jsx)("h3",{className:"mt-2 text-lg font-medium",children:"No hay hojas de trabajo"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"No se encontraron hojas de trabajo con los filtros actuales."})]}):(0,s.jsx)($,{worksheets:R,setWorksheets:x,selectedRows:S,setSelectedRows:M,onAssign:(e,a)=>k({isOpen:!0,type:a,worksheet:e}),onComment:e=>A({isOpen:!0,worksheet:e}),onView:e=>E({isOpen:!0,worksheet:e})})})]})}),w&&(0,s.jsx)(H,{isOpen:w.isOpen,onClose:()=>k(null),worksheet:w.worksheet,type:w.type,selectedWorksheetIds:S,setWorksheets:x}),b&&(0,s.jsx)(q,{isOpen:b.isOpen,onClose:()=>A(null),worksheet:b.worksheet}),C&&(0,s.jsx)(Z.j,{isOpen:C.isOpen,onClose:()=>E(null),worksheet:C.worksheet})]})}},38162:(e,a,t)=>{"use strict";t.d(a,{C1:()=>A,bL:()=>b});var s=t(12115),r=t(94446),i=t(3468),n=t(92556),l=t(23558),o=t(78108),d=t(84288),c=t(76842),u=t(97602),h=t(95155),m="Checkbox",[p,x]=(0,i.A)(m),[f,j]=p(m),v=s.forwardRef((e,a)=>{let{__scopeCheckbox:t,name:i,checked:o,defaultChecked:d,required:c,disabled:m,value:p="on",onCheckedChange:x,form:j,...v}=e,[g,y]=s.useState(null),b=(0,r.s)(a,e=>y(e)),A=s.useRef(!1),C=!g||j||!!g.closest("form"),[E=!1,S]=(0,l.i)({prop:o,defaultProp:d,onChange:x}),M=s.useRef(E);return s.useEffect(()=>{let e=null==g?void 0:g.form;if(e){let a=()=>S(M.current);return e.addEventListener("reset",a),()=>e.removeEventListener("reset",a)}},[g,S]),(0,h.jsxs)(f,{scope:t,state:E,disabled:m,children:[(0,h.jsx)(u.sG.button,{type:"button",role:"checkbox","aria-checked":w(E)?"mixed":E,"aria-required":c,"data-state":k(E),"data-disabled":m?"":void 0,disabled:m,value:p,...v,ref:b,onKeyDown:(0,n.m)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,n.m)(e.onClick,e=>{S(e=>!!w(e)||!e),C&&(A.current=e.isPropagationStopped(),A.current||e.stopPropagation())})}),C&&(0,h.jsx)(N,{control:g,bubbles:!A.current,name:i,value:p,checked:E,required:c,disabled:m,form:j,style:{transform:"translateX(-100%)"},defaultChecked:!w(d)&&d})]})});v.displayName=m;var g="CheckboxIndicator",y=s.forwardRef((e,a)=>{let{__scopeCheckbox:t,forceMount:s,...r}=e,i=j(g,t);return(0,h.jsx)(c.C,{present:s||w(i.state)||!0===i.state,children:(0,h.jsx)(u.sG.span,{"data-state":k(i.state),"data-disabled":i.disabled?"":void 0,...r,ref:a,style:{pointerEvents:"none",...e.style}})})});y.displayName=g;var N=e=>{let{control:a,checked:t,bubbles:r=!0,defaultChecked:i,...n}=e,l=s.useRef(null),c=(0,o.Z)(t),u=(0,d.X)(a);s.useEffect(()=>{let e=l.current,a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==t&&a){let s=new Event("click",{bubbles:r});e.indeterminate=w(t),a.call(e,!w(t)&&t),e.dispatchEvent(s)}},[c,t,r]);let m=s.useRef(!w(t)&&t);return(0,h.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:null!=i?i:m.current,...n,tabIndex:-1,ref:l,style:{...e.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function w(e){return"indeterminate"===e}function k(e){return w(e)?"indeterminate":e?"checked":"unchecked"}var b=v,A=y},44846:(e,a,t)=>{"use strict";t.d(a,{d:()=>l});var s=t(95155),r=t(12115),i=t(27599),n=t(64269);let l=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.bL,{className:(0,n.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...r,ref:a,children:(0,s.jsx)(i.zi,{className:(0,n.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});l.displayName=i.bL.displayName},58772:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(14294).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},59729:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(14294).A)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},60406:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(14294).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},63817:(e,a,t)=>{"use strict";t.d(a,{G7:()=>d,L$:()=>h,h_:()=>m,oI:()=>c,uB:()=>o,xL:()=>u});var s=t(95155),r=t(12115),i=t(41808),n=t(90109),l=t(64269);t(51834);let o=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.uB,{ref:a,className:(0,l.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...r})});o.displayName=i.uB.displayName;let d=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,s.jsx)(n.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,s.jsx)(i.uB.Input,{ref:a,className:(0,l.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...r})]})});d.displayName=i.uB.Input.displayName;let c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.uB.List,{ref:a,className:(0,l.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...r})});c.displayName=i.uB.List.displayName;let u=r.forwardRef((e,a)=>(0,s.jsx)(i.uB.Empty,{ref:a,className:"py-6 text-center text-sm",...e}));u.displayName=i.uB.Empty.displayName;let h=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.uB.Group,{ref:a,className:(0,l.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...r})});h.displayName=i.uB.Group.displayName,r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.uB.Separator,{ref:a,className:(0,l.cn)("-mx-1 h-px bg-border",t),...r})}).displayName=i.uB.Separator.displayName;let m=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.uB.Item,{ref:a,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled='true']:pointer-events-none data-[disabled='true']:opacity-50",t),...r})});m.displayName=i.uB.Item.displayName},76251:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(14294).A)("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]])},82274:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(14294).A)("FilePenLine",[["path",{d:"m18 5-2.414-2.414A2 2 0 0 0 14.172 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"142zxg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]])},83686:()=>{},89522:(e,a,t)=>{"use strict";t.d(a,{V:()=>v});var s=t(95155);t(12115);var r=t(46767),i=t(11064),n=t(19201),l=t(44575),o=t(77187),d=t(80358),c=t(98039),u=t(60406),h=t(15039),m=t(5225),p=t(64269);let x=e=>{let{Icon:a,tooltipText:t,isComplete:i,pulse:n}=e;if(null===i)return null;let l=(0,p.cn)("h-6 w-6 rounded-full flex items-center justify-center border",i?"bg-blue-500 text-white border-blue-600":"bg-gray-300 text-gray-600 border-gray-400",n&&"animate-pulse");return(0,s.jsxs)(r.m_,{children:[(0,s.jsx)(r.k$,{asChild:!0,children:(0,s.jsx)("div",{className:l,children:(0,s.jsx)(a,{className:"h-4 w-4"})})}),(0,s.jsx)(r.ZI,{children:(0,s.jsx)("p",{children:t})})]})},f=e=>{let{entregadoAforoAt:a,acuseLog:t}=e,l=null==t?void 0:t.updatedBy;return a?(0,s.jsxs)(r.m_,{children:[(0,s.jsx)(r.k$,{asChild:!0,children:(0,s.jsx)("div",{children:(0,s.jsx)(n.A,{className:"h-5 w-5 text-blue-500"})})}),(0,s.jsx)(r.ZI,{children:l?(0,s.jsxs)("p",{children:["Recibido por ",l]}):(0,s.jsx)("p",{children:"Acuse de recibido confirmado"})})]}):(0,s.jsxs)(r.m_,{children:[(0,s.jsx)(r.k$,{asChild:!0,children:(0,s.jsx)("div",{children:(0,s.jsx)(i.A,{className:"h-5 w-5 text-gray-400"})})}),(0,s.jsx)(r.ZI,{children:(0,s.jsx)("p",{children:"Acuse de recibido pendiente"})})]})},j=e=>{let a,t,i,n,d,{worksheetType:c}=e;switch(c){case"anexo_5":a=null,t="5",i="Anexo 5",n="bg-cyan-500",d="text-white";break;case"anexo_7":a=null,t="7",i="Anexo 7",n="bg-purple-500",d="text-white";break;case"corporate_report":a=l.A,t=null,i="Reporte Corporativo",n="bg-gray-700",d="text-white";break;default:a=o.A,t=null,i="Hoja de Trabajo",n="bg-gray-300",d="text-gray-700"}let u=(0,p.cn)("h-6 w-6 rounded-full flex items-center justify-center border",n,d);return(0,s.jsxs)(r.m_,{children:[(0,s.jsx)(r.k$,{asChild:!0,children:(0,s.jsx)("div",{className:u,children:a?(0,s.jsx)(a,{className:"h-4 w-4"}):(0,s.jsx)("span",{className:"text-xs font-bold",children:t})})}),(0,s.jsx)(r.ZI,{children:(0,s.jsx)("p",{children:i})})]})};function v(e){var a,t,i;let{caseData:n}=e,l=(null==(a=n.worksheet)?void 0:a.requiredPermits)&&n.worksheet.requiredPermits.length>0,o=!!l&&n.worksheet.requiredPermits.every(e=>"Entregado"===e.status),p=n.pagos&&n.pagos.length>0,v=!!p&&n.pagos.every(e=>"Pagado"===e.paymentStatus),g="Rectificacion"===n.incidentType,y=!!g&&"Aprobada"===n.incidentStatus,N=n.hasValueDoubt,w=!!N&&!!n.valueDoubtStatus,k=!!n.examenPrevio,b=!!k&&(null==(t=n.examenPrevio)?void 0:t.status)==="complete";return(0,s.jsx)(r.Bc,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(f,{entregadoAforoAt:n.entregadoAforoAt,acuseLog:n.acuseLog}),(0,s.jsx)(j,{worksheetType:null==(i=n.worksheet)?void 0:i.worksheetType}),(0,s.jsx)(x,{Icon:d.A,tooltipText:"Permisos",isComplete:l?o:null}),(0,s.jsx)(x,{Icon:c.A,tooltipText:"Pagos",isComplete:p?v:null}),(0,s.jsx)(x,{Icon:u.A,tooltipText:"Incidencia",isComplete:g?y:null}),(0,s.jsx)(x,{Icon:h.A,tooltipText:"Duda de Valor",isComplete:N?w:null}),(0,s.jsx)(x,{Icon:m.A,tooltipText:"Previo",isComplete:k?b:null})]})})}},98053:(e,a,t)=>{"use strict";t.d(a,{$v:()=>f,EO:()=>h,Lt:()=>o,Rx:()=>j,Zr:()=>v,ck:()=>p,r7:()=>x,tv:()=>d,wd:()=>m});var s=t(95155),r=t(12115),i=t(35646),n=t(64269),l=t(3998);let o=i.bL,d=i.l9,c=i.ZL,u=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:a})});u.displayName=i.hJ.displayName;let h=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsx)(i.UC,{ref:a,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r})]})});h.displayName=i.UC.displayName;let m=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...t})};m.displayName="AlertDialogHeader";let p=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};p.displayName="AlertDialogFooter";let x=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.hE,{ref:a,className:(0,n.cn)("text-lg font-semibold",t),...r})});x.displayName=i.hE.displayName;let f=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.VY,{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})});f.displayName=i.VY.displayName;let j=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.rc,{ref:a,className:(0,n.cn)((0,l.r)(),t),...r})});j.displayName=i.rc.displayName;let v=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.ZD,{ref:a,className:(0,n.cn)((0,l.r)({variant:"outline"}),"mt-2 sm:mt-0",t),...r})});v.displayName=i.ZD.displayName}},e=>{e.O(0,[2992,7138,3524,4865,9255,3744,5282,9351,5330,5479,5171,2228,7913,8441,1255,7358],()=>e(e.s=31994)),_N_E=e.O()}]);