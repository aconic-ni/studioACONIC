(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8582],{7311:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>G});var r=t(95155),s=t(12115),n=t(35434),i=t(22544),l=t(66942),o=t(15653),c=t(3998),d=t(51834),m=t(41052),u=t(15894),x=t(54901),h=t(14585),p=t(19708),j=t(54715),g=t(22452),v=t(13630),N=t(88397),f=t(27500),b=t(45444),y=t(36204),C=t(87270),D=t(76444),A=t(65142),z=t(44846),w=t(11929),E=t(11186),V=t(27339),P=t(26333),q=t(48109),S=t(52587),T=t(86948),I=t(46767),R=t(34238),k=t(50909),J=t(52619),_=t.n(J),B=t(64269),F=t(16235),O=t(20063);let M=o.z.object({id:o.z.string(),type:o.z.string(),number:o.z.string(),isCopy:o.z.boolean(),status:o.z.custom()}),$=o.z.object({id:o.z.string(),name:o.z.string(),status:o.z.custom(),tramiteDate:o.z.custom().nullable().optional(),estimatedDeliveryDate:o.z.custom().nullable().optional(),facturaNumber:o.z.string().optional(),assignedExecutive:o.z.string().optional(),comments:o.z.array(o.z.any()).optional(),tipoTramite:o.z.string().optional(),item:o.z.string().optional(),marcaEquipo:o.z.string().optional(),modeloEquipo:o.z.string().optional(),equipoType:o.z.enum(["Refrigerador","Aire Acondicionado"]).optional()}),L=o.z.object({facturaNumber:o.z.string().optional(),documents:o.z.array(M),requiredPermits:o.z.array($),transportDocumentType:o.z.enum(["guia_aerea","bl","carta_porte"]).optional().nullable(),transportCompany:o.z.string().optional(),transportDocumentNumber:o.z.string().optional()});function U(){let{user:e}=(0,x.A)(),{toast:a}=(0,u.dj)(),t=(0,O.useSearchParams)().get("id"),[n,o]=(0,s.useState)(!1),[J,M]=(0,s.useState)(null),[$,U]=(0,s.useState)([]),[H,G]=(0,s.useState)(null),[Z,W]=(0,s.useState)(null),[X,Q]=(0,s.useState)(null),K=(0,i.mN)({resolver:(0,l.u)(L),defaultValues:{facturaNumber:"",documents:[],requiredPermits:[],transportDocumentType:null,transportCompany:"",transportDocumentNumber:""}}),{fields:Y,append:ee,remove:ea,update:et}=(0,i.jz)({control:K.control,name:"documents"}),{fields:er,append:es,remove:en,update:ei}=(0,i.jz)({control:K.control,name:"requiredPermits"});K.watch("requiredPermits");let[el,eo]=(0,s.useState)(!1),[ec,ed]=(0,s.useState)(""),[em,eu]=(0,s.useState)(!1),[ex,eh]=(0,s.useState)(""),[ep,ej]=(0,s.useState)(""),[eg,ev]=(0,s.useState)(!1),[eN,ef]=(0,s.useState)(""),[eb,ey]=(0,s.useState)(""),[eC,eD]=(0,s.useState)("Pendiente"),[eA,ez]=(0,s.useState)(""),ew=K.watch("facturaNumber"),eE=ew?ew.split(";").map(e=>e.trim()).filter(e=>e):[];(0,s.useEffect)(()=>{(async()=>{if(!e||!t)return;let r=await (0,p.x7)((0,p.H9)(h.db,"worksheets",t));if(r.exists()){let e={id:r.id,...r.data()};M(e);let a=(e.requiredPermits||[]).map(e=>({...e,tramiteDate:e.tramiteDate,estimatedDeliveryDate:e.estimatedDeliveryDate}));K.reset({facturaNumber:e.facturaNumber||"",documents:e.documents||[],requiredPermits:a,transportDocumentType:e.transportDocumentType||null,transportCompany:e.transportCompany||"",transportDocumentNumber:e.transportDocumentNumber||""}),ed(e.facturaNumber||"")}else a({title:"Error",description:"No se encontr\xf3 la Hoja de Trabajo para este caso.",variant:"destructive"});if(["admin","supervisor","coordinadora","ejecutivo"].includes(e.role||"")){let e=(0,p.P)((0,p.rJ)(h.db,"users"),(0,p._M)("role","in",["ejecutivo","coordinadora"]));U((await (0,p.GG)(e)).docs.map(e=>({uid:e.id,...e.data()})))}})()},[t,K,e,a]);let eV=async(t,r)=>{if(!e||!e.displayName||!J)return;o(!0);let s=(0,p.wP)(h.db),n=(0,p.H9)(h.db,"worksheets",J.id),i=(0,p.H9)(h.db,"no existes",J.id),l=(0,p.rJ)(i,"actualizaciones"),c=t.requiredPermits.map(e=>({...e,tramiteDate:void 0===e.tramiteDate?null:e.tramiteDate,estimatedDeliveryDate:void 0===e.estimatedDeliveryDate?null:e.estimatedDeliveryDate})),d={...t,requiredPermits:c};s.update(n,d),"facturaNumber"===r.field&&s.update(i,{facturaNumber:t.facturaNumber});let m={updatedAt:p.Dc.now(),updatedBy:e.displayName,field:r.field,oldValue:r.oldValue,newValue:r.newValue,comment:r.comment};s.set((0,p.H9)(l),m);try{await s.commit(),a({title:"Cambio Guardado",description:"La informaci\xf3n ha sido actualizada."});let e=await (0,p.x7)(n);e.exists()&&M({id:e.id,...e.data()})}catch(e){console.error("Error auto-saving:",e),a({title:"Error",description:"No se pudo guardar el cambio.",variant:"destructive"})}finally{o(!1)}},eP=()=>{ef(""),ey(""),eD("Pendiente"),ez("")},eq=(e,a,t)=>{let r=K.getValues("requiredPermits"),s=r[e],n=s[a];if(JSON.stringify(n)===JSON.stringify(t))return;let i=[...r];i[e]={...i[e],[a]:t},eV({...K.getValues(),requiredPermits:i},{field:"permit_".concat(a),oldValue:n,newValue:t,comment:"Permiso '".concat(s.name,"' actualizado. Campo: ").concat(String(a))}),ei(e,{...s,[a]:t})};return t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(T.Zp,{className:"w-full max-w-6xl mx-auto custom-shadow",children:[(0,r.jsxs)(T.aR,{children:[(0,r.jsx)(T.ZB,{children:"Gestionar Documentos y Permisos"}),(0,r.jsxs)(T.BT,{children:["A\xf1ada nuevos documentos o actualice el estado de los permisos para el NE: ",t]})]}),(0,r.jsx)(T.Wu,{children:(0,r.jsx)(m.lV,{...K,children:(0,r.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"space-y-6",children:[(0,r.jsxs)("div",{className:"pt-4 border-t",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Documentos Entregados"}),(0,r.jsxs)(P.AM,{open:el,onOpenChange:eo,children:[(0,r.jsx)(P.Wv,{asChild:!0,children:(0,r.jsxs)(c.$,{type:"button",variant:"outline",size:"sm",children:[(0,r.jsx)(j.A,{className:"mr-2 h-4 w-4"})," A\xf1adir Factura"]})}),(0,r.jsx)(P.hl,{className:"w-80",children:(0,r.jsxs)("div",{className:"grid gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h4",{className:"font-medium leading-none",children:"A\xf1adir Factura(s)"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Separe m\xfaltiples n\xfameros con coma o punto y coma."})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(D.J,{htmlFor:"factura-number",children:"N\xfamero(s) de Factura"}),(0,r.jsx)(A.p,{id:"factura-number",value:ec,onChange:e=>ed(e.target.value)}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(z.d,{id:"factura-original",checked:em,onCheckedChange:eu}),(0,r.jsx)(D.J,{htmlFor:"factura-original",children:"Es Original"})]}),(0,r.jsx)(c.$,{onClick:()=>{if(ec.trim()){let e=ec.trim(),a=[...eE,e];K.setValue("facturaNumber",a.join("; "));let t={id:(0,w.A)(),type:"FACTURA",number:e,isCopy:!em,status:"Entregado"},r=[...Y,t],s={...K.getValues(),documents:r,facturaNumber:a.join("; ")};eV(s,{field:"facturaNumber",oldValue:null==J?void 0:J.facturaNumber,newValue:s.facturaNumber,comment:"Factura a\xf1adida: ".concat(e)}),ee(t),eo(!1),ed("")}else a({title:"N\xfamero de factura requerido",variant:"destructive"})},children:"Guardar Factura(s)"})]})]})})]})]}),(0,r.jsxs)("div",{className:"p-3 border rounded-md mb-4",children:[(0,r.jsx)("h4",{className:"text-md font-medium text-primary mb-2",children:"Documento de Transporte"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[(0,r.jsx)(m.zB,{control:K.control,name:"transportDocumentType",render:e=>{var a;let{field:t}=e;return(0,r.jsxs)(m.eI,{children:[(0,r.jsx)(m.lR,{children:"Tipo de Documento"}),(0,r.jsxs)(E.l6,{onValueChange:e=>eV({...K.getValues(),transportDocumentType:e},{field:"transportDocumentType",oldValue:t.value,newValue:e,comment:"Tipo de documento de transporte actualizado"}),value:null!=(a=t.value)?a:void 0,children:[(0,r.jsx)(m.MJ,{children:(0,r.jsx)(E.bq,{children:(0,r.jsx)(E.yv,{placeholder:"Seleccionar tipo..."})})}),(0,r.jsxs)(E.gC,{children:[(0,r.jsx)(E.eb,{value:"guia_aerea",children:"Gu\xeda A\xe9rea"}),(0,r.jsx)(E.eb,{value:"bl",children:"BL (Conocimiento de Embarque)"}),(0,r.jsx)(E.eb,{value:"carta_porte",children:"Carta de Porte"})]})]}),(0,r.jsx)(m.C5,{})]})}}),(0,r.jsx)(m.zB,{control:K.control,name:"transportCompany",render:e=>{let{field:a}=e;return(0,r.jsxs)(m.eI,{children:[(0,r.jsx)(m.lR,{children:"Compa\xf1\xeda"}),(0,r.jsx)(m.MJ,{children:(0,r.jsx)(A.p,{...a,onBlur:()=>eV(K.getValues(),{field:"transportCompany",oldValue:null==J?void 0:J.transportCompany,newValue:a.value,comment:"Compa\xf1\xeda de transporte actualizada"}),placeholder:"Nombre de la compa\xf1\xeda"})}),(0,r.jsx)(m.C5,{})]})}}),(0,r.jsx)(m.zB,{control:K.control,name:"transportDocumentNumber",render:e=>{let{field:a}=e;return(0,r.jsxs)(m.eI,{children:[(0,r.jsx)(m.lR,{children:"N\xfamero"}),(0,r.jsx)(m.MJ,{children:(0,r.jsx)(A.p,{...a,onBlur:()=>eV(K.getValues(),{field:"transportDocumentNumber",oldValue:null==J?void 0:J.transportDocumentNumber,newValue:a.value,comment:"N\xfamero de documento de transporte actualizado"}),placeholder:"N\xfamero del documento"})}),(0,r.jsx)(m.C5,{})]})}})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_auto_auto] gap-3 items-end mb-4 p-3 border rounded-md",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(D.J,{children:"Tipo de Documento"}),(0,r.jsx)(A.p,{value:ex,onChange:e=>eh(e.target.value),placeholder:"Ej: BL, Packing List"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(D.J,{children:"N\xfamero"}),(0,r.jsx)(A.p,{value:ep,onChange:e=>ej(e.target.value),placeholder:"Ej: 12345"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 pt-5",children:[(0,r.jsx)(z.d,{checked:eg,onCheckedChange:ev}),(0,r.jsx)(D.J,{children:"Es Original"})]}),(0,r.jsxs)(c.$,{type:"button",onClick:()=>{if(ex.trim()&&ep.trim()){let e={id:(0,w.A)(),type:ex,number:ep,isCopy:!eg,status:"Entregado"},a=[...Y,e];eV({...K.getValues(),documents:a},{field:"documents",oldValue:Y,newValue:a,comment:"Documento a\xf1adido: ".concat(ex," - ").concat(ep)}),ee(e),eh(""),ej(""),ev(!1)}else a({title:"Datos incompletos",variant:"destructive"})},children:[(0,r.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"A\xf1adir"]})]}),Y.length>0&&(0,r.jsx)("div",{className:"rounded-md border",children:(0,r.jsxs)(C.XI,{children:[(0,r.jsx)(C.A0,{children:(0,r.jsxs)(C.Hj,{children:[(0,r.jsx)(C.nd,{children:"Tipo"}),(0,r.jsx)(C.nd,{children:"N\xfamero"}),(0,r.jsx)(C.nd,{children:"Formato"}),(0,r.jsx)(C.nd,{className:"text-right",children:"Acci\xf3n"})]})}),(0,r.jsx)(C.BF,{children:Y.map((e,a)=>(0,r.jsxs)(C.Hj,{children:[(0,r.jsx)(C.nA,{children:e.type}),(0,r.jsx)(C.nA,{children:e.number}),(0,r.jsx)(C.nA,{children:e.isCopy?"Copia":"Original"}),(0,r.jsx)(C.nA,{className:"text-right",children:(0,r.jsx)(c.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>(e=>{let a=Y[e],t=Y.filter((a,t)=>t!==e),r=K.getValues("facturaNumber");"FACTURA"===a.type&&(r=(r||"").split(";").map(e=>e.trim()).filter(e=>e!==a.number).join("; "),K.setValue("facturaNumber",r)),eV({...K.getValues(),documents:t,facturaNumber:r},{field:"documents",oldValue:Y,newValue:t,comment:"Documento eliminado: ".concat(a.type," - ").concat(a.number)}),ea(e)})(a),children:(0,r.jsx)(v.A,{className:"h-4 w-4 text-destructive"})})})]},e.id))})]})})]}),(0,r.jsxs)("div",{className:"pt-4 border-t",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Permisos Requeridos"}),(0,r.jsxs)("div",{className:"space-y-4 p-3 border rounded-md",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_1fr_auto] gap-3 items-end",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(D.J,{children:"Nombre del Permiso"}),(0,r.jsxs)(E.l6,{value:eN,onValueChange:ef,children:[(0,r.jsx)(E.bq,{children:(0,r.jsx)(E.yv,{placeholder:"Seleccionar permiso..."})}),(0,r.jsx)(E.gC,{children:R.QL.map(e=>(0,r.jsx)(E.eb,{value:e,children:e},e))})]}),"OTROS"===eN&&(0,r.jsx)(A.p,{value:eb,onChange:e=>ey(e.target.value),placeholder:"Indique cu\xe1l"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(D.J,{children:"Factura Asociada"}),(0,r.jsxs)(E.l6,{value:eA,onValueChange:ez,disabled:0===eE.length,children:[(0,r.jsx)(E.bq,{children:(0,r.jsx)(E.yv,{placeholder:"Seleccionar factura..."})}),(0,r.jsx)(E.gC,{children:eE.map(e=>(0,r.jsx)(E.eb,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(D.J,{children:"Estado"}),(0,r.jsxs)(k.z,{value:eC,onValueChange:e=>eD(e),className:"flex gap-4 pt-2",children:[(0,r.jsxs)(m.eI,{className:"flex items-center space-x-2",children:[(0,r.jsx)(m.MJ,{children:(0,r.jsx)(k.C,{value:"Pendiente"})}),(0,r.jsx)(m.lR,{className:"font-normal",children:"Pendiente"})]}),(0,r.jsxs)(m.eI,{className:"flex items-center space-x-2",children:[(0,r.jsx)(m.MJ,{children:(0,r.jsx)(k.C,{value:"En Tr\xe1mite"})}),(0,r.jsx)(m.lR,{className:"font-normal",children:"En Tr\xe1mite"})]}),(0,r.jsxs)(m.eI,{className:"flex items-center space-x-2",children:[(0,r.jsx)(m.MJ,{children:(0,r.jsx)(k.C,{value:"Entregado"})}),(0,r.jsx)(m.lR,{className:"font-normal",children:"Entregado"})]})]})]})]}),(0,r.jsxs)(c.$,{type:"button",onClick:()=>{let t="OTROS"===eN?eb.trim():eN.trim();if(!t)return void a({title:"Nombre requerido",description:"Por favor, ingrese el nombre del permiso.",variant:"destructive"});let r=eA;r||1!==eE.length||(r=eE[0]);let s={id:(0,w.A)(),name:t,status:eC,facturaNumber:r,assignedExecutive:(null==e?void 0:e.displayName)||"",comments:[]};if(["Dictamen Tecnico INE","IPSA","MINSA","TELCOR"].includes(t))Q(s),W({permit:s,index:-1});else{let e={...s,tipoTramite:"Autorizaci\xf3n"},a=[...er,e];eV({...K.getValues(),requiredPermits:a},{field:"requiredPermits",oldValue:er,newValue:a,comment:"Permiso a\xf1adido: ".concat(t)}),es(e),eP()}},className:"w-full md:w-auto",children:[(0,r.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"A\xf1adir Permiso a la Lista"]})]}),er.length>0?(0,r.jsx)("div",{className:"rounded-md border mt-4",children:(0,r.jsxs)(C.XI,{children:[(0,r.jsx)(C.A0,{children:(0,r.jsxs)(C.Hj,{children:[(0,r.jsx)(C.nd,{children:"Permiso"}),(0,r.jsx)(C.nd,{children:"Factura"}),(0,r.jsx)(C.nd,{children:"Asignado A"}),(0,r.jsx)(C.nd,{children:"Estado"}),(0,r.jsx)(C.nd,{children:"Fecha Tr\xe1mite"}),(0,r.jsx)(C.nd,{children:"Fecha Entrega"}),(0,r.jsx)(C.nd,{className:"text-right",children:"Acciones"})]})}),(0,r.jsx)(C.BF,{children:er.map((a,t)=>{let s=["Dictamen Tecnico INE","IPSA","MINSA","TELCOR"].includes(a.name),n="Dictamen Tecnico INE"===a.name;return(0,r.jsxs)(C.Hj,{children:[(0,r.jsx)(C.nA,{className:"font-medium",children:a.name}),(0,r.jsx)(C.nA,{children:a.facturaNumber||"N/A"}),(0,r.jsx)(C.nA,{children:(0,r.jsx)(i.xI,{control:K.control,name:"requiredPermits.".concat(t,".assignedExecutive"),render:a=>{let{field:s}=a;return(0,r.jsxs)(E.l6,{onValueChange:e=>eq(t,"assignedExecutive",e),value:s.value||(null==e?void 0:e.displayName)||"",children:[(0,r.jsx)(m.MJ,{children:(0,r.jsx)(E.bq,{className:"w-[180px] text-xs h-8",children:(0,r.jsx)(E.yv,{placeholder:"Asignar..."})})}),(0,r.jsx)(E.gC,{children:$.map(e=>(0,r.jsx)(E.eb,{value:e.displayName||"",children:e.displayName},e.uid))})]})}})}),(0,r.jsx)(C.nA,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:(0,B.cn)("h-2.5 w-2.5 rounded-full",((e,a)=>{switch(e){case"Entregado":return"bg-green-500";case"Rechazado":return"bg-red-500";case"En Tr\xe1mite":if(a&&3>=(0,q.c)(a.toDate(),new Date))return"bg-yellow-500";return"bg-blue-500";default:return"bg-gray-400"}})(a.status,a.estimatedDeliveryDate))}),(0,r.jsxs)(E.l6,{onValueChange:e=>eq(t,"status",e),value:a.status,children:[(0,r.jsx)(E.bq,{className:"w-[150px]",children:(0,r.jsx)(E.yv,{})}),(0,r.jsxs)(E.gC,{children:[(0,r.jsx)(E.eb,{value:"Pendiente",children:"Pendiente"}),(0,r.jsx)(E.eb,{value:"En Tr\xe1mite",children:"En Tr\xe1mite"}),(0,r.jsx)(E.eb,{value:"Entregado",children:"Entregado"}),(0,r.jsx)(E.eb,{value:"Rechazado",children:"Rechazado"}),(0,r.jsx)(E.eb,{value:"Sometido de Nuevo",children:"Sometido de Nuevo"})]})]})]})}),(0,r.jsx)(C.nA,{children:(0,r.jsx)(m.zB,{control:K.control,name:"requiredPermits.".concat(t,".tramiteDate"),render:e=>{var a;let{field:s}=e;return(0,r.jsx)(V.l,{date:null==(a=s.value)?void 0:a.toDate(),onDateChange:e=>eq(t,"tramiteDate",e?p.Dc.fromDate(e):null)})}})}),(0,r.jsx)(C.nA,{children:(0,r.jsx)(m.zB,{control:K.control,name:"requiredPermits.".concat(t,".estimatedDeliveryDate"),render:e=>{var a;let{field:s}=e;return(0,r.jsx)(V.l,{date:null==(a=s.value)?void 0:a.toDate(),onDateChange:e=>eq(t,"estimatedDeliveryDate",e?p.Dc.fromDate(e):null)})}})}),(0,r.jsx)(C.nA,{className:"text-right",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[n&&J&&(0,r.jsx)(I.Bc,{children:(0,r.jsxs)(I.m_,{children:[(0,r.jsx)(I.k$,{asChild:!0,children:(0,r.jsx)(c.$,{asChild:!0,variant:"ghost",size:"icon",children:(0,r.jsx)(_(),{href:"/legal/request?ne=".concat(J.ne,"&consignee=").concat(encodeURIComponent(J.consignee),"&serviceType=Dictamen%20Tecnico%20INE&factura=").concat(encodeURIComponent(a.facturaNumber||""),"&contenedor=").concat(encodeURIComponent(J.reference||""),"&item=").concat(encodeURIComponent(a.item||""),"&marca=").concat(encodeURIComponent(a.marcaEquipo||""),"&modelo=").concat(encodeURIComponent(a.modeloEquipo||""),"&tipoEquipo=").concat(encodeURIComponent(a.equipoType||"")),children:(0,r.jsx)(N.A,{className:"h-4 w-4 text-purple-600"})})})}),(0,r.jsx)(I.ZI,{children:(0,r.jsx)("p",{children:"Enviar a Solicitud Legal"})})]})}),(0,r.jsxs)(c.$,{variant:"ghost",size:"icon",onClick:()=>G({permit:a,index:t}),children:[(0,r.jsx)(f.A,{className:"h-4 w-4"}),a.comments&&a.comments.length>0&&(0,r.jsx)(Badge,{variant:"destructive",className:"absolute -top-1 -right-1 h-4 w-4 p-0 justify-center text-xs",children:a.comments.length})]}),s&&(0,r.jsx)(c.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>W({permit:a,index:t}),children:(0,r.jsx)(b.A,{className:"h-4 w-4 text-blue-600"})}),(0,r.jsx)(c.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>(e=>{let a=er[e],t=er.filter((a,t)=>t!==e);eV({...K.getValues(),requiredPermits:t},{field:"requiredPermits",oldValue:er,newValue:t,comment:"Permiso eliminado: ".concat(a.name)}),en(e)})(t),children:(0,r.jsx)(v.A,{className:"h-4 w-4 text-destructive"})})]})})]},a.id)})})]})}):(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-4",children:"No hay permisos requeridos en esta hoja de trabajo."})]}),(0,r.jsx)(d.Es,{className:"pt-6",children:(0,r.jsx)(c.$,{type:"button",variant:"outline",asChild:!0,children:(0,r.jsxs)(_(),{href:"/executive",children:[(0,r.jsx)(y.A,{className:"mr-2 h-4 w-4"})," Volver"]})})})]})})})]}),H&&J&&(0,r.jsx)(S.o,{isOpen:!!H,onClose:()=>G(null),permit:H.permit,worksheetId:J.id,onCommentsUpdate:e=>{eq(H.index,"comments",e)}}),Z&&(0,r.jsx)(F.p,{isOpen:!!Z,onClose:()=>W(null),permit:Z.permit,onSave:e=>((e,t)=>{let r=e>-1?{...er[e],...t}:{...X,...t},s=[...er];e>-1?s[e]=r:s.push(r),eV({...K.getValues(),requiredPermits:s},{field:"requiredPermits",oldValue:er,newValue:s,comment:"Permiso ".concat(e>-1?"actualizado":"a\xf1adido"," con detalles: ").concat(r.name)}),e>-1?ei(e,r):es(r),W(null),Q(null),eP(),a({title:"Permiso Guardado",description:"La informaci\xf3n para ".concat(r.name," ha sido guardada.")})})(Z.index,e)})]}):(0,r.jsxs)(T.Zp,{className:"w-full max-w-4xl mx-auto",children:[(0,r.jsx)(T.aR,{children:(0,r.jsx)(T.ZB,{children:"Error"})}),(0,r.jsx)(T.Wu,{children:(0,r.jsx)("p",{children:"No se ha proporcionado un ID de caso."})})]})}var H=t(92033);let G=function(){return(0,r.jsx)(n.G,{children:(0,r.jsx)("div",{className:"py-2 md:py-5",children:(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"flex justify-center items-center p-8",children:(0,r.jsx)(H.A,{className:"h-12 w-12 animate-spin text-primary"})}),children:(0,r.jsx)(U,{})})})})}},25305:(e,a,t)=>{Promise.resolve().then(t.bind(t,7311))}},e=>{e.O(0,[2992,7138,4865,2130,2619,3326,5282,9351,3504,6505,1344,5479,5171,9817,2754,4896,8441,1255,7358],()=>e(e.s=25305)),_N_E=e.O()}]);