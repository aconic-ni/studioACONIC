(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4696],{11860:(e,a,r)=>{"use strict";r.d(a,{AppProvider:()=>x,I:()=>u,U:()=>h});var s=r(95155),n=r(12115),t=r(11929),l=r(54901),i=r(19708),o=r(14585),c=r(15894),d=r(5282),u=function(e){return e[e.WELCOME=0]="WELCOME",e[e.INITIAL_INFO=1]="INITIAL_INFO",e[e.PRODUCT_LIST=2]="PRODUCT_LIST",e[e.PREVIEW=3]="PREVIEW",e[e.SUCCESS=4]="SUCCESS",e[e.INITIAL_DATA=1]="INITIAL_DATA",e[e.SOLICITUD_LIST=2]="SOLICITUD_LIST",e}({});let m=(0,n.createContext)(void 0),x=e=>{let{children:a}=e,[r,u]=(0,n.useState)(null),[x,h]=(0,n.useState)([]),[p,j]=(0,n.useState)(0),[g,v]=(0,n.useState)(null),[f,N]=(0,n.useState)(!1),[C,b]=(0,n.useState)(!1),[y,A]=(0,n.useState)(null),[z,S]=(0,n.useState)(!1),[w,I]=(0,n.useState)([]),[E,D]=(0,n.useState)(null),[M,R]=(0,n.useState)([]),[k,T]=(0,n.useState)(null),[J,B]=(0,n.useState)(!1),[L,P]=(0,n.useState)(null),[O,q]=(0,n.useState)(null),{user:_}=(0,l.A)(),{toast:V}=(0,c.dj)(),[U,W]=(0,n.useState)(_),F=(0,n.useCallback)(()=>{u(null),h([]),j(0),v(null),N(!1),b(!1),A(null),S(!1),I([]),D(null),R([]),T(null),B(!1),P(null),q(null)},[]);(0,n.useEffect)(()=>{((null==_?void 0:_.uid)!==(null==U?void 0:U.uid)||_&&!U||!_&&U)&&(F(),W(_))},[_,U,F]);let $=(0,n.useCallback)(e=>{D(e)},[]),G=(0,n.useCallback)(e=>{if(!(null==E?void 0:E.ne)){console.error("No se puede generar ID de solicitud: falta el NE en el contexto inicial."),V({title:"Error Interno",description:"No se pudo generar un ID para la solicitud porque falta el NE.",variant:"destructive"});return}let a=new Date,r=(0,d.GP)(a,"ddMMyy-HHmmss"),s="".concat(E.ne,"-").concat(r),n={...e,id:s};R(e=>[...e,n])},[E,V]),H=(0,n.useCallback)(e=>{R(a=>a.map(a=>a.id===e.id?e:a))},[]),X=(0,n.useCallback)(e=>{R(a=>a.filter(a=>a.id!==e))},[]),Z=(0,n.useCallback)(e=>{T(e||null),N(!0)},[]),Q=(0,n.useCallback)(async(e,a)=>{if(z&&(null==r?void 0:r.ne)&&(null==_?void 0:_.email))try{let s=(0,i.rJ)(o.db,"examenesRecuperados"),n={examNe:r.ne,action:e,changedBy:_.email,changedAt:i.Dc.fromDate(new Date),details:a};await (0,i.gS)(s,n)}catch(e){console.error("Error writing audit log:",e),V({title:"Error de Auditor\xeda",description:"No se pudo registrar el cambio en la bit\xe1cora de recuperaci\xf3n.",variant:"destructive"})}},[z,null==r?void 0:r.ne,null==_?void 0:_.email,V]),Y=(0,n.useCallback)(async(e,a)=>{if(!(null==e?void 0:e.ne)||!(null==_?void 0:_.email))return void console.log("Soft save prerequisites not met.",{ne:null==e?void 0:e.ne,user:null==_?void 0:_.email});let r=(0,i.H9)(o.db,"examenesPrevios",e.ne.toUpperCase()),s={...e,products:a,savedBy:_.email,status:"incomplete",lastUpdated:i.Dc.fromDate(new Date)};try{let n=await (0,i.x7)(r);1!==a.length||n.exists()&&n.data().createdAt||(s.createdAt=i.Dc.fromDate(new Date)),s.savedAt=i.Dc.fromDate(new Date),await (0,i.BN)(r,s,{merge:!0}),console.log("Soft save successful for NE: ".concat(e.ne))}catch(e){console.error("Error during soft save:",e),V({title:"Error de Autoguardado",description:"No se pudo guardar el progreso. Revisa tu conexi\xf3n.",variant:"destructive"})}},[_,V]),K=(0,n.useCallback)(function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];u(e),a&&S(!0)},[]),ee=(0,n.useCallback)(e=>{h(e)},[]),ea=(0,n.useCallback)(e=>{let a={...e,id:(0,t.A)(),productTimestampSaveAt:i.Dc.fromDate(new Date)};h(e=>{let s=[...e,a];return Y(r,s),s}),Q("product_added",{productId:a.id,newData:a})},[r,Y,Q]),er=(0,n.useCallback)(e=>{let a;h(s=>{a=s.find(a=>a.id===e.id);let n=s.map(a=>a.id===e.id?e:a);return Y(r,n),n}),Q("product_updated",{productId:e.id,previousData:a,newData:e}),v(null)},[r,Y,Q]),es=(0,n.useCallback)(e=>{let a;h(s=>{a=s.find(a=>a.id===e);let n=s.filter(a=>a.id!==e);return Y(r,n),n}),a&&Q("product_deleted",{productId:e,previousData:a})},[r,Y,Q]),en=(0,n.useCallback)(e=>{j(e)},[]),et=(0,n.useCallback)(e=>{v(e)},[]),el=(0,n.useCallback)(e=>{2===p?v(e):2===p&&T(e),N(!0)},[p]),ei=(0,n.useCallback)(()=>{N(!1),v(null),T(null)},[]),eo=(0,n.useCallback)(e=>{A(e),b(!0)},[]),ec=(0,n.useCallback)(()=>{b(!1),A(null)},[]),ed=(0,n.useCallback)(e=>{I(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},[]),eu=(0,n.useCallback)(()=>{w.length===x.length?I([]):I(x.map(e=>e.id))},[x,w.length]),em=(0,n.useCallback)(()=>{let e=[];h(a=>{let s=a.filter(a=>!w.includes(a.id)||(e.push(a),!1));return Y(r,s),s}),e.forEach(e=>{Q("product_deleted",{productId:e.id,previousData:e})}),I([]),V({title:"Productos eliminados",description:"".concat(e.length," productos han sido eliminados de la lista.")})},[w,Y,r,Q,V]);return(0,s.jsx)(m.Provider,{value:{examData:r,products:x,currentStep:p,editingProduct:g,isAddProductModalOpen:f,isProductDetailModalOpen:C,productToView:y,selectedProducts:w,setExamData:K,setProducts:ee,addProduct:ea,updateProduct:er,deleteProduct:es,setCurrentStep:en,setEditingProduct:et,openAddProductModal:el,closeAddProductModal:ei,openProductDetailModal:eo,closeProductDetailModal:ec,resetApp:F,softSaveExam:Y,toggleProductSelection:ed,toggleSelectAllProducts:eu,deleteSelectedProducts:em,initialContextData:E,setInitialContextData:$,solicitudes:M,addSolicitud:G,updateSolicitud:H,deleteSolicitud:X,editingSolicitud:k,openSolicitudModal:Z,isMemorandumMode:J,setIsMemorandumMode:B,solicitudToViewInline:L,setSolicitudToViewInline:P,caseToAssignAforador:O,setCaseToAssignAforador:q},children:a})},h=()=>{let e=(0,n.useContext)(m);if(void 0===e)throw Error("useAppContext must be used within an AppProvider");return e}},35725:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>Q});var s=r(95155),n=r(12115),t=r(22544),l=r(66942),i=r(15653),o=r(11929),c=r(54901),d=r(14585),u=r(19708),m=r(15894),x=r(3998),h=r(65142),p=r(31120),j=r(41052),g=r(44846),v=r(50909),f=r(87270),N=r(76444),C=r(30848),b=r(72251),y=r(54715),A=r(22452),z=r(13630),S=r(45444),w=r(36204),I=r(92033),E=r(9891),D=r(86501),M=r(73457),R=r(26333),k=r(11186),T=r(34238),J=r(11647),B=r(63817),L=r(64269),P=r(79505),O=r(11860),q=r(27339),_=r(35434),V=r(20063),U=r(86948),W=r(52619),F=r.n(W),$=r(16235);let G=i.z.object({id:i.z.string(),type:i.z.string().min(1,"Tipo es requerido."),number:i.z.string().min(1,"N\xfamero es requerido."),isCopy:i.z.boolean().default(!1),status:i.z.custom().default("Entregado")}),H=i.z.object({id:i.z.string(),name:i.z.string().min(1,"Nombre del permiso es requerido."),status:i.z.custom(),facturaNumber:i.z.string().optional(),assignedExecutive:i.z.string().optional(),comments:i.z.array(i.z.any()).optional(),tramiteDate:i.z.custom().optional().nullable(),estimatedDeliveryDate:i.z.custom().optional().nullable(),tipoTramite:i.z.string().optional(),item:i.z.string().optional(),marcaEquipo:i.z.string().optional(),modeloEquipo:i.z.string().optional(),equipoType:i.z.enum(["Refrigerador","Aire Acondicionado"]).optional()}),X=i.z.object({worksheetType:i.z.enum(["hoja_de_trabajo","anexo_5","anexo_7","corporate_report"]).default("hoja_de_trabajo"),ne:i.z.string().min(1,"El campo NE es requerido."),reference:i.z.string().max(12,"La referencia no puede exceder los 12 caracteres.").optional(),executive:i.z.string().min(1,"Ejecutivo es requerido."),consignee:i.z.string().min(1,"Consignatario es requerido."),aforador:i.z.string().optional(),eta:i.z.date().optional().nullable(),appliesTLC:i.z.boolean().default(!1),tlcName:i.z.string().optional(),appliesModexo:i.z.boolean().default(!1),modexoCode:i.z.string().optional(),facturaNumber:i.z.string().min(1,"La factura es requerida. A\xf1\xe1dala usando el bot\xf3n 'A\xf1adir Factura'."),grossWeight:i.z.string().optional(),netWeight:i.z.string().optional(),description:i.z.string().min(1,"La descripci\xf3n es un campo obligatorio."),packageNumber:i.z.string().optional(),entryCustoms:i.z.string().min(1,"Aduana de entrada es requerida."),dispatchCustoms:i.z.string().min(1,"Aduana de despacho es requerida."),resa:i.z.string().optional(),transportMode:i.z.enum(["aereo","maritimo","frontera","terrestre"],{required_error:"Debe seleccionar un modo de transporte."}),inLocalWarehouse:i.z.boolean().default(!1),inCustomsWarehouse:i.z.boolean().default(!1),location:i.z.string().optional(),documents:i.z.array(G),requiredPermits:i.z.array(H),operationType:i.z.enum(["importacion","exportacion"]).optional().nullable(),patternRegime:i.z.string().optional(),subRegime:i.z.string().optional(),isJointOperation:i.z.boolean().default(!1),jointNe:i.z.string().optional(),jointReference:i.z.string().optional(),dcCorrespondiente:i.z.string().optional(),isSplit:i.z.boolean().default(!1),observations:i.z.string().optional(),transportDocumentType:i.z.enum(["guia_aerea","bl","carta_porte"]).optional().nullable(),transportCompany:i.z.string().optional(),transportDocumentNumber:i.z.string().optional(),precinto:i.z.string().optional(),precintoLateral:i.z.string().optional(),vin:i.z.string().optional()}).refine(e=>!(e.inLocalWarehouse||e.inCustomsWarehouse)||e.location&&""!==e.location.trim(),{message:"La localizaci\xf3n es requerida si la mercanc\xeda est\xe1 en almac\xe9n local o aduana a\xe9rea.",path:["location"]}).refine(e=>!e.isJointOperation||e.isJointOperation&&e.jointNe&&""!==e.jointNe.trim(),{message:"El NE mancomunado es requerido.",path:["jointNe"]}).refine(e=>!e.operationType||e.operationType&&e.patternRegime&&""!==e.patternRegime.trim(),{message:"El Modelo (Patr\xf3n) es requerido si se especifica un Tipo de Operaci\xf3n.",path:["patternRegime"]}).refine(e=>"PSMT NICARAGUA, SOCIEDAD ANONIMA"!==e.consignee.toUpperCase().trim()||!!e.aforador&&""!==e.aforador.trim(),{message:"Debe seleccionar un aforador para PSMT.",path:["aforador"]});function Z(){let{user:e}=(0,c.A)(),{toast:a}=(0,m.dj)(),r=(0,V.useRouter)(),i=(0,V.useSearchParams)(),[_,W]=(0,n.useState)(!1),[G,H]=(0,n.useState)([]),[Z,Q]=(0,n.useState)([]),[Y,K]=(0,n.useState)(!1),[ee,ea]=(0,n.useState)(!1),{setCaseToAssignAforador:er}=(0,O.U)(),[es,en]=(0,n.useState)(null),[et,el]=(0,n.useState)(null),[ei,eo]=(0,n.useState)(null),[ec,ed]=(0,n.useState)(null),[eu,em]=(0,n.useState)(""),[ex,eh]=(0,n.useState)(!1),ep=(0,t.mN)({resolver:(0,l.u)(X),defaultValues:{worksheetType:"hoja_de_trabajo",ne:"",reference:"",executive:"",consignee:"",eta:null,facturaNumber:"",grossWeight:"",netWeight:"",description:"",packageNumber:"",entryCustoms:"",dispatchCustoms:"",resa:"",aforador:"",inLocalWarehouse:!1,inCustomsWarehouse:!1,location:"",documents:[],requiredPermits:[],operationType:null,patternRegime:"",subRegime:"",isJointOperation:!1,jointNe:"",jointReference:"",dcCorrespondiente:"",isSplit:!1,observations:"",appliesTLC:!1,tlcName:"",appliesModexo:!1,modexoCode:"",transportDocumentType:null,transportCompany:"",transportDocumentNumber:"",precinto:"",precintoLateral:"",vin:""}});(0,n.useEffect)(()=>{let e=i.get("id");e&&(eo(e),(async()=>{let r=(0,u.H9)(d.db,"worksheets",e),s=await (0,u.x7)(r);if(s.exists()){var n,t,l;let e={id:s.id,...s.data()};ed(e);let a={...e,eta:null!=(t=null==(n=e.eta)?void 0:n.toDate())?t:null,operationType:null!=(l=e.operationType)?l:null,requiredPermits:(e.requiredPermits||[]).map(e=>{var a,r;return{...e,tramiteDate:null==(a=e.tramiteDate)?void 0:a.toDate(),estimatedDeliveryDate:null==(r=e.estimatedDeliveryDate)?void 0:r.toDate()}})};ep.reset(a)}else a({title:"Error",description:"No se encontr\xf3 la hoja de trabajo para editar.",variant:"destructive"})})())},[i,ep,a]);let{fields:ej,append:eg,remove:ev,update:ef}=(0,t.jz)({control:ep.control,name:"documents"}),{fields:eN,append:eC,remove:eb,update:ey}=(0,t.jz)({control:ep.control,name:"requiredPermits"}),eA=ep.watch("consignee"),ez=ep.watch("inLocalWarehouse"),eS=ep.watch("inCustomsWarehouse"),ew=ep.watch("transportMode"),eI=ep.watch("operationType"),eE=ep.watch("isJointOperation"),eD=ep.watch("appliesTLC"),eM=ep.watch("appliesModexo"),eR=T.Vc[ep.watch("entryCustoms")],ek=T.Vc[ep.watch("dispatchCustoms")],[eT,eJ]=(0,n.useState)(!1),[eB,eL]=(0,n.useState)(""),[eP,eO]=(0,n.useState)(!1),[eq,e_]=(0,n.useState)(""),[eV,eU]=(0,n.useState)(""),[eW,eF]=(0,n.useState)(!1),[e$,eG]=(0,n.useState)(""),[eH,eX]=(0,n.useState)(""),[eZ,eQ]=(0,n.useState)("Pendiente"),[eY,eK]=(0,n.useState)(""),e0=ep.watch("facturaNumber"),e1=e0?e0.split(";").map(e=>e.trim()).filter(e=>e):[];(0,n.useEffect)(()=>{(null==e?void 0:e.displayName)&&!ei&&ep.setValue("executive",e.displayName)},[e,ep,ei]),(0,n.useEffect)(()=>{(async()=>{if(!e)return;if(["admin","supervisor","coordinadora","ejecutivo"].includes(e.role||"")){let e=(0,u.P)((0,u.rJ)(d.db,"users"),(0,u._M)("role","in",["ejecutivo","coordinadora"]));H((await (0,u.GG)(e)).docs.map(e=>({uid:e.id,...e.data()})))}let a=(0,u.P)((0,u.rJ)(d.db,"users"),(0,u._M)("role","in",["aforador","supervisor"]));Q((await (0,u.GG)(a)).docs.map(e=>({uid:e.id,...e.data()})))})()},[e]);let e2=()=>{eG(""),eX(""),eQ("Pendiente"),eK("")},e4=async s=>{if(!e||!e.displayName)return void a({title:"Error",description:"Debe estar autenticado.",variant:"destructive"});if(!s.ne)return void a({title:"Error",description:"El campo NE no puede estar vac\xedo.",variant:"destructive"});if(W(!0),ei){let n=(0,u.H9)(d.db,"worksheets",ei),t=(0,u.wP)(d.db);try{let{createdBy:l,createdAt:i,...o}=s,c={...o,eta:s.eta?u.Dc.fromDate(s.eta):null,lastUpdatedAt:u.Dc.now(),createdBy:(null==ec?void 0:ec.createdBy)||e.email};t.update(n,c);let m=(0,u.rJ)(d.db,"worksheets",ei,"aforo","actualizaciones"),x=(0,u.H9)(m),h={updatedAt:u.Dc.now(),updatedBy:e.displayName,field:"document_update",oldValue:"worksheet",newValue:"worksheet_updated",comment:"Hoja de trabajo modificada por ".concat(e.displayName,".")};t.set(x,h),await t.commit(),a({title:"Hoja de Trabajo Actualizada",description:"El registro para el NE ".concat(ei," ha sido guardado.")}),r.push("/executive")}catch(a){let e=new D.$({path:"batch update to worksheets/".concat(ei),operation:"update",requestResourceData:{worksheetData:s}},a);E.d.emit("permission-error",e)}finally{W(!1)}}else{if("PSMT NICARAGUA, SOCIEDAD ANONIMA"===s.consignee.toUpperCase().trim()&&(!s.aforador||""===s.aforador.trim())){a({title:"Campo Requerido",description:"Debe seleccionar un aforador para el consignatario PSMT.",variant:"destructive"}),W(!1);return}let n=s.ne.trim().toUpperCase(),t=(0,u.H9)(d.db,"worksheets",n),l=(0,u.H9)(d.db,"no existes",n);try{let[i,o]=await Promise.all([(0,u.x7)(t),(0,u.x7)(l)]);if(i.exists()||o.exists()){a({title:"Registro Duplicado",description:"Ya existe un registro con el NE ".concat(n,"."),variant:"destructive"}),W(!1);return}let c=(0,u.wP)(d.db),m=u.Dc.now(),x={by:e.displayName,at:m},h={...s,id:n,ne:n,eta:s.eta?u.Dc.fromDate(s.eta):null,createdAt:m,createdBy:e.email,requiredPermits:s.requiredPermits||[],lastUpdatedAt:m};c.set(t,h);let p={ne:n,executive:s.executive,consignee:s.consignee,facturaNumber:s.facturaNumber,declarationPattern:s.patternRegime,merchandise:s.description,createdBy:e.uid,createdAt:m,aforador:s.aforador||"",assignmentDate:s.aforador&&"-"!==s.aforador?m:null,aforadorStatus:"Pendiente ",aforadorStatusLastUpdate:x,revisorStatus:"Pendiente",revisorStatusLastUpdate:x,preliquidationStatus:"Pendiente",preliquidationStatusLastUpdate:x,digitacionStatus:"Pendiente",digitacionStatusLastUpdate:x,incidentStatus:"Pendiente",incidentStatusLastUpdate:x,revisorAsignado:"",revisorAsignadoLastUpdate:x,digitadorAsignado:"",digitadorAsignadoLastUpdate:x,worksheetId:n,entregadoAforoAt:m};c.set(l,p);let j=(0,u.H9)((0,u.rJ)(d.db,"worksheets",n,"aforo","actualizaciones")),g={updatedAt:u.Dc.now(),updatedBy:e.displayName,field:"creation",oldValue:null,newValue:"case_created_from_worksheet",comment:"Hoja de Trabajo ingresada por ".concat(e.displayName,".")};c.set(j,g),"PSMT NICARAGUA, SOCIEDAD ANONIMA"!==s.consignee.toUpperCase().trim()||s.aforador&&"-"!==s.aforador||er(p),await c.commit(),a({title:"Registro Creado",description:"El registro para el NE ".concat(n," ha sido guardado.")}),r.push("/executive"),ep.reset()}catch(a){console.error("Error creating record:",a);let e=new D.$({path:"batch write to worksheets/".concat(n," and no existes/").concat(n),operation:"create",requestResourceData:{worksheetData:s,worksheetData:{ne:n}}},a);E.d.emit("permission-error",e)}finally{W(!1)}}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(U.Zp,{className:"w-full max-w-6xl mx-auto",children:[(0,s.jsxs)(U.aR,{children:[(0,s.jsxs)(U.ZB,{className:"text-2xl",children:[ei?"Editar":"Nueva"," Hoja de Trabajo"]}),(0,s.jsx)(U.BT,{children:ei?"Modificando la hoja de trabajo para el NE: ".concat(ei):"Complete la informaci\xf3n para generar el registro."})]}),(0,s.jsx)(U.Wu,{children:(0,s.jsx)(j.lV,{...ep,children:(0,s.jsxs)("form",{onSubmit:ep.handleSubmit(e4),className:"space-y-6 mt-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"ne",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"NE"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a,disabled:!!ei})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)(j.zB,{control:ep.control,name:"reference",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Referencia"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a,maxLength:12})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)(j.zB,{control:ep.control,name:"executive",render:a=>{let{field:r}=a;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Ejecutivo"}),["admin","supervisor","coordinadora"].includes((null==e?void 0:e.role)||"")?(0,s.jsxs)(k.l6,{onValueChange:r.onChange,defaultValue:r.value,children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(k.bq,{children:(0,s.jsx)(k.yv,{placeholder:"Seleccionar ejecutivo..."})})}),(0,s.jsx)(k.gC,{children:G.map(e=>(0,s.jsx)(k.eb,{value:e.displayName||e.email,children:e.displayName||e.email},e.uid))})]}):(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...r,disabled:!0})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsxs)("div",{className:"lg:col-span-3 grid grid-cols-1 lg:grid-cols-2 gap-4 items-start",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"consignee",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Consignatario"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(P.d,{value:a.value,onChange:a.onChange})}),(0,s.jsx)(j.C5,{})]})}}),"PSMT NICARAGUA, SOCIEDAD ANONIMA"===eA.toUpperCase().trim()&&(0,s.jsx)(j.zB,{control:ep.control,name:"aforador",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Asignar Aforador (para PSMT)"}),(0,s.jsxs)(k.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(k.bq,{children:(0,s.jsx)(k.yv,{placeholder:"Seleccionar aforador..."})})}),(0,s.jsx)(k.gC,{children:Z.map(e=>(0,s.jsx)(k.eb,{value:e.displayName||e.email,children:e.displayName||e.email},e.uid))})]}),(0,s.jsx)(j.C5,{})]})}})]}),(0,s.jsx)("div",{className:"lg:col-span-3",children:(0,s.jsx)(j.zB,{control:ep.control,name:"eta",render:e=>{var a;let{field:r}=e;return(0,s.jsxs)(j.eI,{className:"flex flex-col",children:[(0,s.jsx)(j.lR,{children:"ETA (Fecha Estimada de Arribo)"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(q.l,{date:null!=(a=r.value)?a:void 0,onDateChange:e=>r.onChange(e)})}),(0,s.jsx)(j.C5,{})]})}})}),(0,s.jsxs)("div",{className:"lg:col-span-3 grid grid-cols-1 md:grid-cols-2 gap-4 items-start border-t pt-4",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"appliesTLC",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{className:"flex flex-row items-center space-x-3",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(g.d,{checked:a.value,onCheckedChange:a.onChange})}),(0,s.jsx)(j.lR,{children:"Aplica TLC"})]})}}),eD&&(0,s.jsxs)("div",{className:"space-y-2 pl-4",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"tlcName",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Nombre TLC"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{placeholder:"Nombre del Tratado",...a})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.p,{value:eu,onChange:e=>em(e.target.value),placeholder:"N\xfamero de TLC",className:"flex-grow"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 pt-5",children:[(0,s.jsx)(g.d,{checked:eW,onCheckedChange:eF}),(0,s.jsx)(N.J,{children:"Es Original"})]}),(0,s.jsx)(x.$,{type:"button",size:"sm",onClick:()=>{let e=ep.getValues("tlcName");e&&eu?(eg({id:(0,o.A)(),type:"TLC: ".concat(e),number:eu,isCopy:!eW,status:"Entregado"}),a({title:"TLC a\xf1adido a documentos"}),ep.setValue("tlcName",""),em("")):a({title:"Datos incompletos",description:"Ingrese el nombre y n\xfamero del TLC.",variant:"destructive"})},className:"shrink-0",children:"A\xf1adir Doc."})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"appliesModexo",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{className:"flex flex-row items-center space-x-3",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(g.d,{checked:a.value,onCheckedChange:a.onChange})}),(0,s.jsx)(j.lR,{children:"Aplica Modexo"})]})}}),eM&&(0,s.jsxs)("div",{className:"space-y-2 pl-4",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"modexoCode",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"C\xf3digo Modexo"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{placeholder:"C\xf3digo Modexo",...a})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 pt-5",children:[(0,s.jsx)(g.d,{checked:eW,onCheckedChange:eF}),(0,s.jsx)(N.J,{children:"Es Original"})]}),(0,s.jsx)(x.$,{type:"button",size:"sm",variant:"outline",onClick:()=>{let e=ep.getValues("modexoCode");e?(eg({id:(0,o.A)(),type:"MODEXO",number:e,isCopy:!eW,status:"Entregado"}),a({title:"MODEXO a\xf1adido a documentos"}),ep.setValue("modexoCode","")):a({title:"C\xf3digo requerido",description:"Ingrese el c\xf3digo Modexo.",variant:"destructive"})},className:"w-full",children:"A\xf1adir Modexo como Documento"})]})]})]})]}),(0,s.jsx)("div",{className:"lg:col-span-3",children:(0,s.jsx)(j.zB,{control:ep.control,name:"facturaNumber",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Factura"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a,readOnly:!0,placeholder:"A\xf1ada facturas con el bot\xf3n dedicado. Separe con ; si son varias.",className:"bg-muted/50 cursor-not-allowed"})}),(0,s.jsx)(j.C5,{})]})}})}),(0,s.jsx)(j.zB,{control:ep.control,name:"grossWeight",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Peso Bruto"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)(j.zB,{control:ep.control,name:"netWeight",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Peso Neto"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)(j.zB,{control:ep.control,name:"packageNumber",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"N\xfamero de Bultos"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)("div",{className:"lg:col-span-3",children:(0,s.jsx)(j.zB,{control:ep.control,name:"entryCustoms",render:e=>{var a;let{field:r}=e;return(0,s.jsxs)(j.eI,{className:"flex flex-col",children:[(0,s.jsx)(j.lR,{children:"Aduana Entrada"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(R.AM,{open:Y,onOpenChange:K,children:[(0,s.jsx)(R.Wv,{asChild:!0,children:(0,s.jsx)(j.MJ,{children:(0,s.jsxs)(x.$,{variant:"outline",role:"combobox",className:(0,L.cn)("w-full justify-between truncate",!r.value&&"text-muted-foreground"),children:[r.value?null==(a=T.gb.find(e=>e.value===r.value))?void 0:a.label:"Seleccionar aduana...",(0,s.jsx)(C.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),(0,s.jsx)(R.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:(0,s.jsxs)(B.uB,{children:[(0,s.jsx)(B.G7,{placeholder:"Buscar aduana..."}),(0,s.jsxs)(B.oI,{children:[(0,s.jsx)(B.xL,{children:"No se encontr\xf3 aduana."}),(0,s.jsx)(B.L$,{children:T.gb.map(e=>(0,s.jsxs)(B.h_,{value:e.label,onSelect:()=>{ep.setValue("entryCustoms",e.value),K(!1)},children:[(0,s.jsx)(b.A,{className:(0,L.cn)("mr-2 h-4 w-4",e.value===r.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})]})})]}),eR&&(0,s.jsx)(J.E,{variant:"secondary",children:eR})]}),(0,s.jsx)(j.C5,{})]})}})}),(0,s.jsx)("div",{className:"lg:col-span-3",children:(0,s.jsx)(j.zB,{control:ep.control,name:"dispatchCustoms",render:e=>{var a;let{field:r}=e;return(0,s.jsxs)(j.eI,{className:"flex flex-col",children:[(0,s.jsx)(j.lR,{children:"Aduana Despacho"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(R.AM,{open:ee,onOpenChange:ea,children:[(0,s.jsx)(R.Wv,{asChild:!0,children:(0,s.jsx)(j.MJ,{children:(0,s.jsxs)(x.$,{variant:"outline",role:"combobox",className:(0,L.cn)("w-full justify-between truncate",!r.value&&"text-muted-foreground"),children:[r.value?null==(a=T.gb.find(e=>e.value===r.value))?void 0:a.label:"Seleccionar aduana...",(0,s.jsx)(C.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),(0,s.jsx)(R.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:(0,s.jsxs)(B.uB,{children:[(0,s.jsx)(B.G7,{placeholder:"Buscar aduana..."}),(0,s.jsxs)(B.oI,{children:[(0,s.jsx)(B.xL,{children:"No se encontr\xf3 aduana."}),(0,s.jsx)(B.L$,{children:T.gb.map(e=>(0,s.jsxs)(B.h_,{value:e.label,onSelect:()=>{ep.setValue("dispatchCustoms",e.value),ea(!1)},children:[(0,s.jsx)(b.A,{className:(0,L.cn)("mr-2 h-4 w-4",e.value===r.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})]})})]}),ek&&(0,s.jsx)(J.E,{variant:"secondary",children:ek})]}),(0,s.jsx)(j.C5,{})]})}})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"transportMode",render:e=>{var a;let{field:r}=e;return(0,s.jsxs)(j.eI,{className:"space-y-3",children:[(0,s.jsx)(j.lR,{children:"Modo de Transporte"}),(0,s.jsx)(j.MJ,{children:(0,s.jsxs)(v.z,{onValueChange:r.onChange,defaultValue:null!=(a=r.value)?a:"",className:"flex flex-wrap gap-4",children:[(0,s.jsxs)(j.eI,{className:"flex items-center space-x-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(v.C,{value:"aereo"})}),(0,s.jsx)(j.lR,{className:"font-normal",children:"A\xe9reo"})]}),(0,s.jsxs)(j.eI,{className:"flex items-center space-x-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(v.C,{value:"maritimo"})}),(0,s.jsx)(j.lR,{className:"font-normal",children:"Mar\xedtimo"})]}),(0,s.jsxs)(j.eI,{className:"flex items-center space-x-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(v.C,{value:"frontera"})}),(0,s.jsx)(j.lR,{className:"font-normal",children:"Frontera"})]}),(0,s.jsxs)(j.eI,{className:"flex items-center space-x-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(v.C,{value:"terrestre"})}),(0,s.jsx)(j.lR,{className:"font-normal",children:"Terrestre"})]})]})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"inLocalWarehouse",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{className:"flex flex-row items-center gap-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(g.d,{checked:a.value,onCheckedChange:a.onChange})}),(0,s.jsx)(j.lR,{children:"En Almac\xe9n Local"})]})}}),(0,s.jsx)(j.zB,{control:ep.control,name:"inCustomsWarehouse",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{className:"flex flex-row items-center gap-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(g.d,{checked:a.value,onCheckedChange:a.onChange})}),(0,s.jsx)(j.lR,{children:"En Aduana A\xe9rea"})]})}})]}),(ez||eS)&&(0,s.jsx)(j.zB,{control:ep.control,name:"location",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{placeholder:"Especifique localizaci\xf3n...",...a})}),(0,s.jsx)(j.C5,{})]})}})]})]}),(ez||eS||"aereo"===ew)&&(0,s.jsx)(j.zB,{control:ep.control,name:"resa",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"RESA"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a,placeholder:"N\xfamero de RESA"})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)("div",{className:"lg:col-span-3 pt-4 border-t",children:(0,s.jsx)(j.zB,{control:ep.control,name:"description",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Descripci\xf3n de la Mercanc\xeda *"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(p.T,{rows:3,placeholder:"Breve descripci\xf3n de la mercanc\xeda",...a})}),(0,s.jsx)(j.C5,{})]})}})}),(0,s.jsxs)("div",{className:"pt-4 border-t",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Documentos Entregados"}),(0,s.jsxs)(R.AM,{open:eT,onOpenChange:eJ,children:[(0,s.jsx)(R.Wv,{asChild:!0,children:(0,s.jsxs)(x.$,{type:"button",variant:"outline",size:"sm",children:[(0,s.jsx)(y.A,{className:"mr-2 h-4 w-4"})," A\xf1adir Factura"]})}),(0,s.jsx)(R.hl,{className:"w-80",children:(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium leading-none",children:"A\xf1adir Factura(s)"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Separe m\xfaltiples n\xfameros con coma o punto y coma."})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(N.J,{htmlFor:"factura-number",children:"N\xfamero(s) de Factura"}),(0,s.jsx)(h.p,{id:"factura-number",value:eB,onChange:e=>eL(e.target.value)}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(g.d,{id:"factura-original",checked:eP,onCheckedChange:eO}),(0,s.jsx)(N.J,{htmlFor:"factura-original",children:"Es Original"})]}),(0,s.jsx)(x.$,{onClick:()=>{let e=eB.split(/[,;]/).map(e=>e.trim()).filter(e=>e);if(e.length>0){let r=ep.getValues("facturaNumber")||"",s=r?r.split(";").map(e=>e.trim()):[],n=0;e.forEach(e=>{!s.includes(e)&&(s.push(e),eg({id:(0,o.A)(),type:"FACTURA",number:e,isCopy:!eP,status:"Entregado"}),n++)}),ep.setValue("facturaNumber",s.join("; ")),n>0?a({title:"Factura(s) A\xf1adida(s)",description:"".concat(n," nueva(s) factura(s) registrada(s).")}):a({title:"Sin cambios",description:"Las facturas ingresadas ya exist\xedan en la lista.",variant:"default"}),eJ(!1),eL("")}else a({title:"N\xfamero de factura requerido",description:"Ingrese uno o m\xe1s n\xfameros de factura.",variant:"destructive"})},children:"Guardar Factura(s)"})]})]})})]})]}),(0,s.jsxs)("div",{className:"p-3 border rounded-md mb-4",children:[(0,s.jsx)("h4",{className:"text-md font-medium text-primary mb-2",children:"Documento de Transporte"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"transportDocumentType",render:e=>{var a;let{field:r}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Tipo de Documento"}),(0,s.jsxs)(k.l6,{onValueChange:r.onChange,value:null!=(a=r.value)?a:void 0,children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(k.bq,{children:(0,s.jsx)(k.yv,{placeholder:"Seleccionar tipo..."})})}),(0,s.jsxs)(k.gC,{children:[(0,s.jsx)(k.eb,{value:"guia_aerea",children:"Gu\xeda A\xe9rea"}),(0,s.jsx)(k.eb,{value:"bl",children:"BL (Conocimiento de Embarque)"}),(0,s.jsx)(k.eb,{value:"carta_porte",children:"Carta de Porte"})]})]}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)(j.zB,{control:ep.control,name:"transportCompany",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Compa\xf1\xeda"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a,placeholder:"Nombre de la compa\xf1\xeda"})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)(j.zB,{control:ep.control,name:"transportDocumentNumber",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"N\xfamero"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a,placeholder:"N\xfamero del documento"})}),(0,s.jsx)(j.C5,{})]})}})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(g.d,{id:"transport-original",checked:ex,onCheckedChange:eh}),(0,s.jsx)(N.J,{htmlFor:"transport-original",children:"Es Original"})]}),(0,s.jsx)(x.$,{type:"button",size:"sm",variant:"outline",onClick:()=>{let{transportDocumentType:e,transportDocumentNumber:r,transportCompany:s}=ep.getValues();e&&r?(eg({id:(0,o.A)(),type:"guia_aerea"===e?"Gu\xeda A\xe9rea":"bl"===e?"BL":"Carta de Porte",number:"".concat(r," (").concat(s||"N/A",")"),isCopy:!ex,status:"Entregado"}),a({title:"Documento de transporte a\xf1adido"})):a({title:"Datos incompletos",description:"Seleccione el tipo e ingrese el n\xfamero.",variant:"destructive"})},children:"A\xf1adir a Documentos"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_auto_auto] gap-3 items-end mb-4 p-3 border rounded-md",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(N.J,{children:"Tipo de Documento"}),(0,s.jsx)(h.p,{value:eq,onChange:e=>e_(e.target.value),placeholder:"Ej: BL, Packing List"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(N.J,{children:"N\xfamero"}),(0,s.jsx)(h.p,{value:eV,onChange:e=>eU(e.target.value),placeholder:"Ej: 12345"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 pt-5",children:[(0,s.jsx)(g.d,{checked:eW,onCheckedChange:eF}),(0,s.jsx)(N.J,{children:"Es Original"})]}),(0,s.jsxs)(x.$,{type:"button",onClick:()=>{eq.trim()&&eV.trim()?(eg({id:(0,o.A)(),type:eq,number:eV,isCopy:!eW,status:"Entregado"}),e_(""),eU(""),eF(!1)):a({title:"Datos incompletos",variant:"destructive"})},children:[(0,s.jsx)(A.A,{className:"mr-2 h-4 w-4"}),"A\xf1adir"]})]}),ej.length>0&&(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(f.XI,{children:[(0,s.jsx)(f.A0,{children:(0,s.jsxs)(f.Hj,{children:[(0,s.jsx)(f.nd,{children:"Tipo"}),(0,s.jsx)(f.nd,{children:"N\xfamero"}),(0,s.jsx)(f.nd,{children:"Formato"}),(0,s.jsx)(f.nd,{className:"text-right",children:"Acci\xf3n"})]})}),(0,s.jsx)(f.BF,{children:ej.map((e,a)=>(0,s.jsxs)(f.Hj,{children:[(0,s.jsx)(f.nA,{children:e.type}),(0,s.jsx)(f.nA,{children:e.number}),(0,s.jsx)(f.nA,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(g.d,{id:"isCopy-".concat(e.id),checked:!e.isCopy,onCheckedChange:r=>{ef(a,{...e,isCopy:!r})}}),(0,s.jsx)(N.J,{htmlFor:"isCopy-".concat(e.id),children:e.isCopy?"Copia":"Original"})]})}),(0,s.jsx)(f.nA,{className:"text-right",children:(0,s.jsx)(x.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>(e=>{let a=ej[e];if(a&&"FACTURA"===a.type){let e=(ep.getValues("facturaNumber")||"").split(";").map(e=>e.trim()).filter(e=>e).filter(e=>e!==a.number);ep.setValue("facturaNumber",e.join("; "))}ev(e)})(a),children:(0,s.jsx)(z.A,{className:"h-4 w-4 text-destructive"})})})]},e.id))})]})})]}),(0,s.jsxs)("div",{className:"pt-4 border-t",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Permisos Requeridos"}),(0,s.jsxs)("div",{className:"space-y-4 p-3 border rounded-md",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_1fr_auto] gap-3 items-end",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(N.J,{children:"Nombre del Permiso"}),(0,s.jsxs)(k.l6,{value:e$,onValueChange:eG,children:[(0,s.jsx)(k.bq,{children:(0,s.jsx)(k.yv,{placeholder:"Seleccionar permiso..."})}),(0,s.jsx)(k.gC,{children:T.QL.map(e=>(0,s.jsx)(k.eb,{value:e,children:e},e))})]}),"OTROS"===e$&&(0,s.jsx)(h.p,{value:eH,onChange:e=>eX(e.target.value),placeholder:"Indique cu\xe1l"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(N.J,{children:"Factura Asociada"}),(0,s.jsxs)(k.l6,{value:eY,onValueChange:eK,disabled:0===e1.length,children:[(0,s.jsx)(k.bq,{children:(0,s.jsx)(k.yv,{placeholder:"Seleccionar factura..."})}),(0,s.jsx)(k.gC,{children:e1.map(e=>(0,s.jsx)(k.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(N.J,{children:"Estado"}),(0,s.jsxs)(v.z,{value:eZ,onValueChange:e=>eQ(e),className:"flex gap-4 pt-2",children:[(0,s.jsxs)(j.eI,{className:"flex items-center space-x-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(v.C,{value:"Pendiente"})}),(0,s.jsx)(j.lR,{className:"font-normal",children:"Pendiente"})]}),(0,s.jsxs)(j.eI,{className:"flex items-center space-x-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(v.C,{value:"En Tr\xe1mite"})}),(0,s.jsx)(j.lR,{className:"font-normal",children:"En Tr\xe1mite"})]}),(0,s.jsxs)(j.eI,{className:"flex items-center space-x-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(v.C,{value:"Entregado"})}),(0,s.jsx)(j.lR,{className:"font-normal",children:"Entregado"})]})]})]})]}),(0,s.jsxs)(x.$,{type:"button",onClick:()=>{let r="OTROS"===e$?eH.trim():e$.trim();if(!r)return void a({title:"Nombre requerido",description:"Por favor, ingrese el nombre del permiso.",variant:"destructive"});let s=eY;s||1!==e1.length||(s=e1[0]);let n={id:(0,o.A)(),name:r,status:eZ,facturaNumber:s,assignedExecutive:(null==e?void 0:e.displayName)||"",comments:[]};if(["Dictamen Tecnico INE","IPSA","MINSA","TELCOR"].includes(r))el(n),en({permit:n,index:-1});else{let e={...n,tipoTramite:"Autorizaci\xf3n"};"Entregado"===eZ?eg({id:(0,o.A)(),type:r,number:"VER BITACORA",isCopy:!1,status:"Entregado"}):eC(e),e2()}},className:"w-full md:w-auto",children:[(0,s.jsx)(A.A,{className:"mr-2 h-4 w-4"}),"A\xf1adir Permiso a la Lista"]})]}),eN.length>0&&(0,s.jsx)("div",{className:"rounded-md border mt-4",children:(0,s.jsxs)(f.XI,{children:[(0,s.jsx)(f.A0,{children:(0,s.jsxs)(f.Hj,{children:[(0,s.jsx)(f.nd,{children:"Permiso"}),(0,s.jsx)(f.nd,{children:"Factura"}),(0,s.jsx)(f.nd,{children:"Asignado A"}),(0,s.jsx)(f.nd,{children:"Estado"}),(0,s.jsx)(f.nd,{className:"text-right",children:"Acci\xf3n"})]})}),(0,s.jsx)(f.BF,{children:eN.map((a,r)=>{let n=["Dictamen Tecnico INE","IPSA","MINSA","TELCOR"].includes(a.name);return(0,s.jsxs)(f.Hj,{children:[(0,s.jsx)(f.nA,{children:a.name}),(0,s.jsx)(f.nA,{children:a.facturaNumber||"N/A"}),(0,s.jsx)(f.nA,{children:(0,s.jsx)(t.xI,{control:ep.control,name:"requiredPermits.".concat(r,".assignedExecutive"),render:a=>{let{field:r}=a;return(0,s.jsxs)(k.l6,{onValueChange:r.onChange,value:r.value||(null==e?void 0:e.displayName)||"",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(k.bq,{className:"w-[180px] text-xs h-8",children:(0,s.jsx)(k.yv,{placeholder:"Asignar..."})})}),(0,s.jsx)(k.gC,{children:G.map(e=>(0,s.jsx)(k.eb,{value:e.displayName||"",children:e.displayName},e.uid))})]})}})}),(0,s.jsx)(f.nA,{children:(0,s.jsx)(t.xI,{control:ep.control,name:"requiredPermits.".concat(r,".status"),render:e=>{let{field:a}=e;return(0,s.jsxs)(k.l6,{onValueChange:a.onChange,value:a.value,children:[(0,s.jsx)(k.bq,{className:"w-[150px]",children:(0,s.jsx)(k.yv,{})}),(0,s.jsxs)(k.gC,{children:[(0,s.jsx)(k.eb,{value:"Pendiente",children:"Pendiente"}),(0,s.jsx)(k.eb,{value:"En Tr\xe1mite",children:"En Tr\xe1mite"}),(0,s.jsx)(k.eb,{value:"Entregado",children:"Entregado"}),(0,s.jsx)(k.eb,{value:"Rechazado",children:"Rechazado"}),(0,s.jsx)(k.eb,{value:"Sometido de Nuevo",children:"Sometido de Nuevo"})]})]})}})}),(0,s.jsx)(f.nA,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[n&&(0,s.jsx)(x.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>en({permit:a,index:r}),children:(0,s.jsx)(S.A,{className:"h-4 w-4 text-blue-600"})}),(0,s.jsx)(x.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>eb(r),children:(0,s.jsx)(z.A,{className:"h-4 w-4 text-destructive"})})]})})]},a.id)})})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"operationType",render:e=>{var a;let{field:r}=e;return(0,s.jsxs)(j.eI,{className:"space-y-3",children:[(0,s.jsx)(j.lR,{children:"Tipo de Operaci\xf3n"}),(0,s.jsx)(j.MJ,{children:(0,s.jsxs)(v.z,{onValueChange:r.onChange,defaultValue:null!=(a=r.value)?a:"",className:"flex gap-4",children:[(0,s.jsxs)(j.eI,{className:"flex items-center space-x-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(v.C,{value:"importacion"})}),(0,s.jsx)(j.lR,{className:"font-normal",children:"Importaci\xf3n"})]}),(0,s.jsxs)(j.eI,{className:"flex items-center space-x-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(v.C,{value:"exportacion"})}),(0,s.jsx)(j.lR,{className:"font-normal",children:"Exportaci\xf3n"})]})]})}),(0,s.jsx)(j.C5,{})]})}}),eI&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"patternRegime",render:e=>{var a;let{field:r}=e;return(0,s.jsxs)(j.eI,{className:"flex flex-col",children:[(0,s.jsx)(j.lR,{children:"Modelo (Patr\xf3n)"}),(0,s.jsxs)(R.AM,{children:[(0,s.jsx)(R.Wv,{asChild:!0,children:(0,s.jsx)(j.MJ,{children:(0,s.jsxs)(x.$,{variant:"outline",role:"combobox",className:(0,L.cn)("w-full justify-between",!r.value&&"text-muted-foreground"),children:[r.value?null==(a=T.h7.find(e=>e.value===r.value))?void 0:a.value:"Seleccionar...",(0,s.jsx)(C.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),(0,s.jsx)(R.hl,{className:"w-[--radix-popover-trigger-width] p-0",children:(0,s.jsxs)(B.uB,{children:[(0,s.jsx)(B.G7,{placeholder:"Buscar por c\xf3digo..."}),(0,s.jsxs)(B.oI,{children:[(0,s.jsx)(B.xL,{children:"No se encontr\xf3 el modelo."}),(0,s.jsx)(B.L$,{children:T.h7.map(e=>(0,s.jsxs)(B.h_,{value:e.value,onSelect:()=>{ep.setValue("patternRegime",e.value)},children:[(0,s.jsx)(b.A,{className:(0,L.cn)("mr-2 h-4 w-4",e.value===r.value?"opacity-100":"opacity-0")}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-bold",children:e.value}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:e.label})]})]},e.value))})]})]})})]}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)(j.zB,{control:ep.control,name:"subRegime",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Sub-R\xe9gimen"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a})}),(0,s.jsx)(j.C5,{})]})}})]})]}),(0,s.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"isJointOperation",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{className:"flex flex-row items-center space-x-3",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(g.d,{checked:a.value,onCheckedChange:a.onChange})}),(0,s.jsx)(j.lR,{children:"Operaci\xf3n Mancomunada"})]})}}),eE&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"jointNe",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"NE Mancomunado"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)(j.zB,{control:ep.control,name:"jointReference",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Referencia Mancomunada"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{...a})}),(0,s.jsx)(j.C5,{})]})}})]})]}),(0,s.jsxs)("div",{className:"flex items-end gap-6 pt-4",children:[(0,s.jsx)(j.zB,{control:ep.control,name:"dcCorrespondiente",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{className:"flex-1",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(h.p,{placeholder:"Ingresar DC Correspondiente",...a})}),(0,s.jsx)(j.C5,{})]})}}),(0,s.jsx)(j.zB,{control:ep.control,name:"isSplit",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{className:"flex flex-row items-center space-x-3 pb-2",children:[(0,s.jsx)(j.MJ,{children:(0,s.jsx)(M.S,{checked:a.value,onCheckedChange:a.onChange,id:"is-split"})}),(0,s.jsx)(j.lR,{htmlFor:"is-split",className:"text-sm font-normal",children:"Es Split"})]})}})]}),(0,s.jsx)("div",{className:"pt-4 border-t",children:(0,s.jsx)(j.zB,{control:ep.control,name:"observations",render:e=>{let{field:a}=e;return(0,s.jsxs)(j.eI,{children:[(0,s.jsx)(j.lR,{children:"Observaciones"}),(0,s.jsx)(j.MJ,{children:(0,s.jsx)(p.T,{...a,placeholder:"A\xf1ada cualquier observaci\xf3n adicional aqu\xed..."})}),(0,s.jsx)(j.C5,{})]})}})}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-6",children:[(0,s.jsx)(x.$,{type:"button",variant:"outline",asChild:!0,children:(0,s.jsxs)(F(),{href:"/executive",children:[(0,s.jsx)(w.A,{className:"mr-2 h-4 w-4"})," Volver"]})}),(0,s.jsxs)(x.$,{type:"submit",disabled:_,children:[_&&(0,s.jsx)(I.A,{className:"mr-2 h-4 w-4 animate-spin"}),ei?"Guardar Cambios":"Guardar Hoja de Trabajo"]})]})]})})})]}),es&&(0,s.jsx)($.p,{isOpen:!!es,onClose:()=>en(null),permit:es.permit,onSave:e=>((e,r)=>{let s=e>-1?{...eN[e],...r}:{...et,...r};e>-1?ey(e,s):eC(s),en(null),el(null),e2(),a({title:"Permiso Guardado",description:"La informaci\xf3n para ".concat(s.name," ha sido guardada.")})})(es.index,e)})]})}function Q(){return(0,s.jsx)(_.G,{children:(0,s.jsx)("div",{className:"py-2 md:py-5",children:(0,s.jsx)(n.Suspense,{fallback:(0,s.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,s.jsx)(I.A,{className:"h-12 w-12 animate-spin text-primary"})}),children:(0,s.jsx)(Z,{})})})})}},73457:(e,a,r)=>{"use strict";r.d(a,{S:()=>o});var s=r(95155),n=r(12115),t=r(38162),l=r(72251),i=r(64269);let o=n.forwardRef((e,a)=>{let{className:r,...n}=e;return(0,s.jsx)(t.bL,{ref:a,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...n,children:(0,s.jsx)(t.C1,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})})});o.displayName=t.bL.displayName},77177:(e,a,r)=>{Promise.resolve().then(r.bind(r,35725))}},e=>{e.O(0,[2992,7138,4865,2130,2619,3326,5282,9351,3504,6505,3545,6352,5479,5171,9817,4728,4896,8441,1255,7358],()=>e(e.s=77177)),_N_E=e.O()}]);