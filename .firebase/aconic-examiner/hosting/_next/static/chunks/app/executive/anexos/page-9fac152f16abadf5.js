(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1512],{21636:(e,r,n)=>{"use strict";n.r(r),n.d(r,{anexoDocumentSchema:()=>P,default:()=>U});var s=n(95155),a=n(12115),t=n(22544),l=n(66942),o=n(15653),i=n(54901),c=n(14585),d=n(19708),x=n(15894),u=n(3998),j=n(65142),h=n(31120),m=n(41052),p=n(87270),g=n(76444),v=n(88964),b=n(13630),N=n(22452),f=n(36204),C=n(92033),z=n(9891),y=n(86501),A=n(11186),D=n(34238),M=n(79505),B=n(35434),R=n(20063),I=n(86948),w=n(52619),J=n.n(w),V=n(51834),S=n(17037),_=n(11929);function E(e){let{isOpen:r,onClose:n,onSave:o,documentData:i,worksheetType:c}=e,d=(0,t.mN)({resolver:(0,l.u)(P),defaultValues:{id:"",cantidad:void 0,origen:"",um:"",sac:"",peso:void 0,descripcion:"",linea:"",guia:"",bulto:void 0,total:void 0}});(0,a.useEffect)(()=>{r&&(i?d.reset(i):d.reset({id:(0,_.A)(),cantidad:void 0,origen:"",um:"",sac:"",peso:void 0,descripcion:"",linea:"",guia:"",bulto:void 0,total:void 0}))},[r,i,d]);let x=d.handleSubmit(e=>{o(e)});return r?(0,s.jsx)(V.lG,{open:r,onOpenChange:n,children:(0,s.jsxs)(V.Cf,{className:"max-w-2xl",children:[(0,s.jsxs)(V.c7,{children:[(0,s.jsxs)(V.L3,{children:[i?"Editar":"A\xf1adir"," Descripci\xf3n de Mercanc\xeda"]}),(0,s.jsx)(V.rr,{className:"sr-only",children:"Formulario para a\xf1adir o editar los detalles de un producto para el anexo."})]}),(0,s.jsx)(m.lV,{...d,children:(0,s.jsxs)("form",{onSubmit:x,children:[(0,s.jsx)(S.F,{className:"max-h-[60vh] p-1",children:(0,s.jsx)("div",{className:"space-y-4 px-4 py-2",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(m.zB,{control:d.control,name:"cantidad",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Cantidad"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{type:"number",...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:d.control,name:"origen",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Origen"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:d.control,name:"um",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"UM"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:d.control,name:"sac",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"SAC"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:d.control,name:"peso",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Peso"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{type:"number",...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:d.control,name:"bulto",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Bulto"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{type:"number",...r})}),(0,s.jsx)(m.C5,{})]})}}),"anexo_7"!==c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.zB,{control:d.control,name:"linea",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Linea Aerea"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:d.control,name:"guia",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"N\xb0 Guia Aerea"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}})]}),(0,s.jsx)(m.zB,{control:d.control,name:"total",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{className:"md:col-span-2",children:[(0,s.jsx)(m.lR,{children:"Total (US$)"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{type:"number",step:"0.01",...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:d.control,name:"descripcion",render:e=>{var r;let{field:n}=e;return(0,s.jsxs)(m.eI,{className:"md:col-span-2",children:[(0,s.jsx)(m.lR,{children:"Descripci\xf3n"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(h.T,{rows:4,...n,value:null!=(r=n.value)?r:""})}),(0,s.jsx)(m.C5,{})]})}})]})})}),(0,s.jsxs)(V.Es,{className:"pt-4 mt-4 border-t",children:[(0,s.jsx)(u.$,{type:"button",variant:"outline",onClick:n,children:"Cancelar"}),(0,s.jsx)(u.$,{type:"submit",children:"Guardar"})]})]})})]})}):null}var T=n(27339),k=n(83012);let P=o.z.object({id:o.z.string(),cantidad:o.z.coerce.number().optional(),origen:o.z.string().optional(),um:o.z.string().optional(),sac:o.z.string().optional(),peso:o.z.coerce.number().optional(),descripcion:o.z.string().min(1,"Descripci\xf3n es requerida."),linea:o.z.string().optional(),guia:o.z.string().optional(),bulto:o.z.coerce.number().optional(),total:o.z.coerce.number().optional()}),L=o.z.object({worksheetType:o.z.enum(["hoja_de_trabajo","anexo_5","anexo_7","corporate_report"]).default("anexo_5"),ne:o.z.string().min(1,"El campo NE es requerido."),executive:o.z.string().min(1,"Ejecutivo es requerido."),consignee:o.z.string().min(1,"Empresa que solicita es requerida."),ruc:o.z.string().optional(),almacenSalida:o.z.string().optional(),codigoAlmacen:o.z.string().optional(),resa:o.z.string().optional(),resaNotificationDate:o.z.date().optional().nullable(),resaDueDate:o.z.date().optional().nullable(),facturaNumber:o.z.string().min(1,"Factura No es requerida."),dispatchCustoms:o.z.string().min(1,"Aduana de destino es requerida."),documents:o.z.array(P),observations:o.z.string().optional(),valor:o.z.coerce.number().optional(),flete:o.z.coerce.number().optional(),seguro:o.z.coerce.number().optional(),otrosGastos:o.z.coerce.number().optional(),packageNumber:o.z.string().optional(),grossWeight:o.z.string().optional(),precinto:o.z.string().optional(),precintoLateral:o.z.string().optional(),codigoAduanero:o.z.string().optional(),marcaVehiculo:o.z.string().optional(),placaVehiculo:o.z.string().optional(),motorVehiculo:o.z.string().optional(),chasisVehiculo:o.z.string().optional(),vin:o.z.string().optional(),nombreConductor:o.z.string().optional(),licenciaConductor:o.z.string().optional(),cedulaConductor:o.z.string().optional(),tipoMedio:o.z.string().optional(),pesoVacioVehiculo:o.z.string().optional(),aforador:o.z.string().optional(),cantidadTotal:o.z.coerce.number().optional(),unidadMedidaTotal:o.z.string().optional(),transportDocumentType:o.z.enum(["guia_aerea","bl","carta_porte"]).optional().nullable(),transportCompany:o.z.string().optional(),transportDocumentNumber:o.z.string().optional(),revisorAsignado:o.z.string().optional()});function q(){var e;let{user:r}=(0,i.A)(),{toast:n}=(0,x.dj)(),o=(0,R.useRouter)(),B=(0,R.useSearchParams)(),[w,V]=(0,a.useState)(!1),[S,_]=(0,a.useState)([]),[P,q]=(0,a.useState)(!1),[U,$]=(0,a.useState)(null),[F,O]=(0,a.useState)(null),G=B.get("type")||"anexo_5",H=(0,t.mN)({resolver:(0,l.u)(L),defaultValues:{worksheetType:G,ne:"",executive:"",consignee:"",ruc:"",resa:"",facturaNumber:"",dispatchCustoms:"",almacenSalida:"",codigoAlmacen:"",documents:[],observations:"",valor:0,flete:0,seguro:0,otrosGastos:0,packageNumber:"",grossWeight:"",precinto:"",precintoLateral:"",codigoAduanero:"",marcaVehiculo:"",placaVehiculo:"",motorVehiculo:"",chasisVehiculo:"",vin:"",nombreConductor:"",licenciaConductor:"",cedulaConductor:"",tipoMedio:"",pesoVacioVehiculo:"",aforador:"-",cantidadTotal:0,unidadMedidaTotal:"",transportDocumentType:null,transportCompany:"",transportDocumentNumber:"",revisorAsignado:"",resaNotificationDate:null,resaDueDate:null}}),W=H.watch("resaNotificationDate");(0,a.useEffect)(()=>{if(W){let e=(0,k.f)(W,15);H.setValue("resaDueDate",e)}else H.setValue("resaDueDate",null)},[W,H]),(0,a.useEffect)(()=>{let e=B.get("id");e&&(O(e),(async()=>{let r=(0,d.H9)(c.db,"worksheets",e),s=await (0,d.x7)(r);if(s.exists()){var a,t;let e=s.data(),r={...e,resaNotificationDate:(null==(a=e.resaNotificationDate)?void 0:a.toDate())||null,resaDueDate:(null==(t=e.resaDueDate)?void 0:t.toDate())||null};H.reset(r)}else n({title:"Error",description:"No se encontr\xf3 el anexo para editar.",variant:"destructive"})})())},[B,H,n]);let{fields:Z,append:X,remove:Y,update:K}=(0,t.jz)({control:H.control,name:"documents"}),Q=H.watch("documents"),ee=a.useMemo(()=>Q.reduce((e,r)=>e+(Number(r.total)||0),0),[Q]),er=a.useMemo(()=>Q.reduce((e,r)=>e+(Number(r.cantidad)||0),0),[Q]),en=a.useMemo(()=>Q.reduce((e,r)=>e+(Number(r.bulto)||0),0),[Q]),es=a.useMemo(()=>Q.reduce((e,r)=>e+(Number(r.peso)||0),0),[Q]);(0,a.useEffect)(()=>{H.setValue("valor",ee)},[ee,H]),(0,a.useEffect)(()=>{H.setValue("cantidadTotal",er)},[er,H]),(0,a.useEffect)(()=>{H.setValue("packageNumber",String(en))},[en,H]),(0,a.useEffect)(()=>{H.setValue("grossWeight",String(es))},[es,H]),(0,a.useEffect)(()=>{(null==r?void 0:r.displayName)&&!F&&H.setValue("executive",r.displayName),H.setValue("worksheetType",G)},[r,H,G,F]),(0,a.useEffect)(()=>{(async()=>{let e=(0,d.P)((0,d.rJ)(c.db,"users"),(0,d._M)("roleTitle","==","agente aduanero"));_((await (0,d.GG)(e)).docs.map(e=>({uid:e.id,...e.data()})).filter(e=>e.displayName&&e.agentLicense&&e.cedula))})()},[]);let ea=e=>{$(e||null),q(!0)},et=e=>{if(null==e)return e;if(Array.isArray(e))return e.map(e=>et(e));if("object"==typeof e){let r={};for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let s=e[n];r[n]=void 0===s?null:et(s)}return r}return e},el=async e=>{if(!r||!r.displayName)return void n({title:"Error",description:"Debe estar autenticado.",variant:"destructive"});if(!e.ne)return void n({title:"Error",description:"El campo NE no puede estar vac\xedo.",variant:"destructive"});V(!0);let s={...e,resaNotificationDate:e.resaNotificationDate?d.Dc.fromDate(e.resaNotificationDate):null,resaDueDate:e.resaDueDate?d.Dc.fromDate(e.resaDueDate):null};if(F){let a=(0,d.H9)(c.db,"worksheets",F),t=(0,d.H9)(c.db,"AforoCases",F),l=(0,d.wP)(c.db);try{let i={...s,lastUpdatedAt:d.Dc.now()};l.update(a,i),l.update(t,{executive:e.executive,consignee:e.consignee,facturaNumber:e.facturaNumber,merchandise:e.observations,aforador:e.aforador||"",revisorAsignado:e.revisorAsignado||"",worksheetType:e.worksheetType});let c=(0,d.H9)((0,d.rJ)(t,"actualizaciones")),x={updatedAt:d.Dc.now(),updatedBy:r.displayName,field:"document_update",oldValue:et("Anexo ".concat("anexo_5"===G?"5":"7")),newValue:et("Anexo ".concat("anexo_5"===G?"5":"7"," actualizado")),comment:"Anexo fue modificado por ".concat(r.displayName,".")};l.set(c,x),await l.commit(),n({title:"Anexo Actualizado",description:"El anexo ".concat(F," ha sido actualizado.")}),o.push("/executive")}catch(r){let e=new y.$({path:"batch update to worksheets/".concat(F," and AforoCases/").concat(F),operation:"update",requestResourceData:{worksheetData:s}});z.d.emit("permission-error",e)}finally{V(!1)}}else{let a=e.ne.trim().toUpperCase(),t=(0,d.H9)(c.db,"worksheets",a),l=(0,d.H9)(c.db,"AforoCases",a),i=(0,d.wP)(c.db);try{let[c,x]=await Promise.all([(0,d.x7)(t),(0,d.x7)(l)]);if(c.exists()||x.exists()){n({title:"Registro Duplicado",description:"Ya existe un registro con el NE ".concat(a,"."),variant:"destructive"}),V(!1);return}let u=d.Dc.now(),j={by:r.displayName,at:u},h={...s,id:a,ne:a,createdAt:u,createdBy:r.email,lastUpdatedAt:u};i.set(t,h);let m={ne:a,executive:e.executive,consignee:e.consignee,facturaNumber:e.facturaNumber,declarationPattern:"",merchandise:e.observations,createdBy:r.uid,createdAt:u,aforador:e.aforador||"",assignmentDate:e.aforador?u:null,aforadorStatus:"Pendiente ",aforadorStatusLastUpdate:j,revisorStatus:"Pendiente",revisorStatusLastUpdate:j,preliquidationStatus:"Pendiente",preliquidationStatusLastUpdate:j,digitacionStatus:"Pendiente",digitacionStatusLastUpdate:j,incidentStatus:"Pendiente",incidentStatusLastUpdate:j,revisorAsignado:e.revisorAsignado||"",revisorAsignadoLastUpdate:j,digitadorAsignado:"",digitadorAsignadoLastUpdate:j,worksheetId:a,worksheetType:e.worksheetType,entregadoAforoAt:u};i.set(l,m);let p=(0,d.H9)((0,d.rJ)(l,"actualizaciones")),g={updatedAt:d.Dc.now(),updatedBy:r.displayName,field:"creation",oldValue:null,newValue:et("case_created_from_".concat(G)),comment:"".concat("hoja_de_trabajo"===G?"Hoja de Trabajo":"anexo_5"===G?"Anexo 5":"Anexo 7"," ingresado por ").concat(r.displayName,".")};i.set(p,g),await i.commit(),n({title:"Registro Creado",description:"El registro para el ".concat(G.replace("_"," ")," ").concat(a," ha sido guardado.")}),o.push("/executive"),H.reset()}catch(r){console.error("Error creating record:",r);let e=new y.$({path:"batch write to worksheets/".concat(a," and AforoCases/").concat(a),operation:"create",requestResourceData:{worksheetData:s,aforoCaseData:{ne:a}}});z.d.emit("permission-error",e)}finally{V(!1)}}},eo="anexo_5"===G?"Anexo 5":"Anexo 7";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(I.Zp,{className:"w-full max-w-screen-2xl mx-auto",children:[(0,s.jsxs)(I.aR,{children:[(0,s.jsxs)(I.ZB,{className:"text-2xl",children:[F?"Editar":"Nuevo"," ",eo]}),(0,s.jsx)(I.BT,{children:F?"Modificando el documento ".concat(F,"."):"Complete la informaci\xf3n para generar el nuevo documento."})]}),(0,s.jsx)(I.Wu,{children:(0,s.jsx)(m.lV,{...H,children:(0,s.jsxs)("form",{onSubmit:H.handleSubmit(el),className:"space-y-6 mt-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,s.jsx)(m.zB,{control:H.control,name:"ne",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"NE"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r,disabled:!!F})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"consignee",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Empresa que solicita (Consignatario)"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(M.d,{value:r.value,onChange:r.onChange})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"ruc",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"RUC"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"almacenSalida",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Almac\xe9n de Salida"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"codigoAlmacen",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"C\xf3digo de Almac\xe9n"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 items-end",children:[(0,s.jsx)(m.zB,{control:H.control,name:"resa",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{className:"col-span-1",children:[(0,s.jsx)(m.lR,{children:"RESA No"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"resaNotificationDate",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{className:"flex flex-col col-span-1",children:[(0,s.jsx)(m.lR,{children:"Fecha Notificaci\xf3n"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(T.l,{date:r.value,onDateChange:r.onChange})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsxs)(m.eI,{className:"col-span-1",children:[(0,s.jsx)(m.lR,{children:"Fecha Vencimiento"}),(0,s.jsx)(j.p,{value:(null==(e=H.getValues("resaDueDate"))?void 0:e.toLocaleDateString("es-NI"))||"N/A",readOnly:!0,className:"bg-muted/50"})]})]}),(0,s.jsx)(m.zB,{control:H.control,name:"facturaNumber",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Factura No"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"dispatchCustoms",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{className:"flex flex-col",children:[(0,s.jsx)(m.lR,{children:"Delegaci\xf3n de Aduana Destino"}),(0,s.jsxs)(A.l6,{onValueChange:r.onChange,value:r.value,children:[(0,s.jsx)(m.MJ,{children:(0,s.jsx)(A.bq,{children:(0,s.jsx)(A.yv,{placeholder:"Seleccionar aduana..."})})}),(0,s.jsx)(A.gC,{children:D.gb.map(e=>(0,s.jsx)(A.eb,{value:e.value,children:e.label},e.value))})]}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"revisorAsignado",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Asignar Revisor (Agente Aduanero)"}),(0,s.jsxs)(A.l6,{onValueChange:r.onChange,value:r.value,children:[(0,s.jsx)(m.MJ,{children:(0,s.jsx)(A.bq,{children:(0,s.jsx)(A.yv,{placeholder:"Seleccionar agente..."})})}),(0,s.jsx)(A.gC,{children:S.map(e=>(0,s.jsx)(A.eb,{value:e.displayName||"",children:e.displayName},e.uid))})]}),(0,s.jsx)(m.C5,{})]})}})]}),"anexo_7"===G&&(0,s.jsxs)("div",{className:"p-3 border rounded-md mt-4",children:[(0,s.jsx)("h4",{className:"text-md font-medium text-primary mb-2",children:"Documento de Transporte"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[(0,s.jsx)(m.zB,{control:H.control,name:"transportDocumentType",render:e=>{var r;let{field:n}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Tipo de Documento"}),(0,s.jsxs)(A.l6,{onValueChange:n.onChange,value:null!=(r=n.value)?r:void 0,children:[(0,s.jsx)(m.MJ,{children:(0,s.jsx)(A.bq,{children:(0,s.jsx)(A.yv,{placeholder:"Seleccionar tipo..."})})}),(0,s.jsxs)(A.gC,{children:[(0,s.jsx)(A.eb,{value:"guia_aerea",children:"Gu\xeda A\xe9rea"}),(0,s.jsx)(A.eb,{value:"bl",children:"BL (Conocimiento de Embarque)"}),(0,s.jsx)(A.eb,{value:"carta_porte",children:"Carta de Porte"})]})]}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"transportCompany",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Compa\xf1\xeda"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r,placeholder:"Nombre de la compa\xf1\xeda"})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"transportDocumentNumber",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"N\xfamero"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r,placeholder:"N\xfamero del documento"})}),(0,s.jsx)(m.C5,{})]})}})]})]}),(0,s.jsxs)("div",{className:"pt-4 border-t",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Descripci\xf3n de las mercanc\xedas"}),(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(p.XI,{children:[(0,s.jsx)(p.A0,{children:(0,s.jsxs)(p.Hj,{children:[(0,s.jsx)(p.nd,{children:"Cantidad"}),(0,s.jsx)(p.nd,{children:"Origen"}),(0,s.jsx)(p.nd,{children:"UM"}),(0,s.jsx)(p.nd,{children:"SAC"}),(0,s.jsx)(p.nd,{children:"Peso"}),(0,s.jsx)(p.nd,{children:"Descripci\xf3n"}),"anexo_7"!==G&&(0,s.jsx)(p.nd,{children:"Linea Aerea"}),"anexo_7"!==G&&(0,s.jsx)(p.nd,{children:"N\xb0 Guia Aerea"}),(0,s.jsx)(p.nd,{children:"Bulto"}),(0,s.jsx)(p.nd,{children:"Total (US$)"}),(0,s.jsx)(p.nd,{className:"text-right",children:"Acciones"})]})}),(0,s.jsx)(p.BF,{children:Z.map((e,r)=>{var n;return(0,s.jsxs)(p.Hj,{children:[(0,s.jsx)(p.nA,{children:e.cantidad}),(0,s.jsx)(p.nA,{children:e.origen}),(0,s.jsx)(p.nA,{children:e.um}),(0,s.jsx)(p.nA,{children:e.sac}),(0,s.jsx)(p.nA,{children:e.peso}),(0,s.jsx)(p.nA,{className:"max-w-xs truncate",children:e.descripcion}),"anexo_7"!==G&&(0,s.jsx)(p.nA,{children:e.linea}),"anexo_7"!==G&&(0,s.jsx)(p.nA,{children:e.guia}),(0,s.jsx)(p.nA,{children:e.bulto}),(0,s.jsx)(p.nA,{children:null==(n=e.total)?void 0:n.toFixed(2)}),(0,s.jsx)(p.nA,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex gap-1 justify-end",children:[(0,s.jsx)(u.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>ea(e),children:(0,s.jsx)(v.A,{className:"h-4 w-4 text-blue-600"})}),(0,s.jsx)(u.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>Y(r),children:(0,s.jsx)(b.A,{className:"h-4 w-4 text-destructive"})})]})})]},e.id)})})]})}),(0,s.jsxs)(u.$,{type:"button",onClick:()=>ea(),size:"sm",variant:"outline",className:"mt-2",children:[(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"A\xf1adir Fila"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(m.zB,{control:H.control,name:"cantidadTotal",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Cantidad Total"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{placeholder:"Cantidad",...r,readOnly:!0,className:"bg-muted/50"})})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"unidadMedidaTotal",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Unidad"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{placeholder:"Unidad",...r})})]})}})]}),(0,s.jsx)(m.zB,{control:H.control,name:"observations",render:e=>{var r;let{field:n}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Nota"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(h.T,{rows:8,...n,value:null!=(r=n.value)?r:""})}),(0,s.jsx)(m.C5,{})]})}})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.J,{children:"Valor Total (USD)"}),(0,s.jsxs)("p",{className:"text-2xl font-bold p-2 bg-muted rounded-md",children:["$",ee.toFixed(2)]})]}),(0,s.jsx)(m.zB,{control:H.control,name:"packageNumber",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Bultos Totales"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r,readOnly:!0,className:"bg-muted/50"})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"grossWeight",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Peso Total"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r,readOnly:!0,className:"bg-muted/50"})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"precinto",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Precinto"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"precintoLateral",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Precinto Lateral"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium text-sm",children:"Conformaci\xf3n de Valor"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 p-3 border rounded-md",children:[(0,s.jsx)(m.zB,{control:H.control,name:"valor",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Valor $"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{type:"number",step:"0.01",...r,readOnly:!0,className:"bg-muted/50"})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"flete",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Flete $"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{type:"number",step:"0.01",...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"seguro",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Seguro $"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{type:"number",step:"0.01",...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"otrosGastos",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"O. Gast\xf3 $"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{type:"number",step:"0.01",...r})}),(0,s.jsx)(m.C5,{})]})}})]})]})]})]}),(0,s.jsxs)("div",{className:"pt-4 border-t",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Datos de Transporte"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,s.jsx)(m.zB,{control:H.control,name:"codigoAduanero",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"C\xf3digo de Aduanero"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"marcaVehiculo",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Marca"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"placaVehiculo",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Placa"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"motorVehiculo",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Motor"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"chasisVehiculo",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Chasis"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"vin",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"VIN"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"nombreConductor",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Nombre Conductor"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"licenciaConductor",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Licencia"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"cedulaConductor",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"C\xe9dula"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"tipoMedio",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Tipo de medio"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"pesoVacioVehiculo",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Peso Vac\xedo"}),(0,s.jsx)(m.MJ,{children:(0,s.jsx)(j.p,{...r})}),(0,s.jsx)(m.C5,{})]})}}),(0,s.jsx)(m.zB,{control:H.control,name:"aforador",render:e=>{let{field:r}=e;return(0,s.jsxs)(m.eI,{children:[(0,s.jsx)(m.lR,{children:"Agente Aduanero (Firma)"}),(0,s.jsxs)(A.l6,{onValueChange:r.onChange,value:r.value,children:[(0,s.jsx)(m.MJ,{children:(0,s.jsx)(A.bq,{children:(0,s.jsx)(A.yv,{placeholder:"Seleccionar agente..."})})}),(0,s.jsxs)(A.gC,{children:[(0,s.jsx)(A.eb,{value:"-",children:"- Ninguno -"}),S.map(e=>(0,s.jsxs)(A.eb,{value:e.displayName||"",children:[e.displayName," (",e.agentLicense,")"]},e.uid))]})]}),(0,s.jsx)(m.C5,{})]})}})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-6",children:[(0,s.jsx)(u.$,{type:"button",variant:"outline",asChild:!0,children:(0,s.jsxs)(J(),{href:"/executive",children:[(0,s.jsx)(f.A,{className:"mr-2 h-4 w-4"})," Volver"]})}),(0,s.jsxs)(u.$,{type:"submit",disabled:w,children:[w&&(0,s.jsx)(C.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Guardar ",eo]})]})]})})})]}),(0,s.jsx)(E,{isOpen:P,onClose:()=>q(!1),onSave:e=>{let r=Z.findIndex(r=>r.id===e.id);r>-1?K(r,e):X(e),q(!1),$(null)},documentData:U,worksheetType:G})]})}function U(){return(0,s.jsx)(B.G,{children:(0,s.jsx)("div",{className:"py-2 md:py-5",children:(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,s.jsx)(C.A,{className:"h-12 w-12 animate-spin text-primary"})}),children:(0,s.jsx)(q,{})})})})}},83012:(e,r,n)=>{"use strict";function s(e,r){let n=new Date(e),s=0;for(;s<r;)n.setDate(n.getDate()+1),0!==n.getDay()&&s++;return n}n.d(r,{f:()=>s})},88964:(e,r,n)=>{"use strict";n.d(r,{A:()=>s});let s=(0,n(14294).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},91935:(e,r,n)=>{Promise.resolve().then(n.bind(n,21636))}},e=>{e.O(0,[2992,7138,4865,2130,2619,3326,5282,9351,3504,6505,3545,5479,5171,9817,4728,8441,1255,7358],()=>e(e.s=91935)),_N_E=e.O()}]);